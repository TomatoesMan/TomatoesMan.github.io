{"meta":{"title":"Tomato's blog","subtitle":"","description":"","author":"TomatoMan","url":"https://TomatoesMan.github.io","root":"/"},"pages":[{"title":"about","date":"2020-06-25T06:51:50.000Z","updated":"2020-06-25T06:52:47.681Z","comments":false,"path":"about/index.html","permalink":"https://tomatoesman.github.io/about/index.html","excerpt":"","text":""},{"title":"archives","date":"2020-06-25T09:40:18.000Z","updated":"2020-06-25T09:48:17.124Z","comments":true,"path":"all-archives/index.html","permalink":"https://tomatoesman.github.io/all-archives/index.html","excerpt":"","text":""},{"title":"æ–‡ç« åˆ†ç±»","date":"2020-06-25T05:28:40.000Z","updated":"2020-06-25T09:24:50.032Z","comments":false,"path":"categories/index.html","permalink":"https://tomatoesman.github.io/categories/index.html","excerpt":"","text":""},{"title":"æ–‡ç« æ ‡ç­¾","date":"2020-06-25T05:41:02.000Z","updated":"2020-06-25T09:25:05.795Z","comments":false,"path":"tags/index.html","permalink":"https://tomatoesman.github.io/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"export","slug":"export","date":"2020-07-27T14:53:43.000Z","updated":"2020-07-27T14:56:10.085Z","comments":true,"path":"2020/07/27/export/","link":"","permalink":"https://tomatoesman.github.io/2020/07/27/export/","excerpt":"åœ¨åŸå§‹çš„ JS æ—¶ä»£ï¼Œæ˜¯æ²¡æœ‰æ¨¡å—åŒ–çš„æ¦‚å¿µçš„ï¼Œéšç€å‰ç«¯é¡¹ç›®çš„è¶Šæ¥è¶Šå¤§ï¼Œå¹¶ä¸”å‰ç«¯çš„åœ°ä½è¶Šæ¥è¶Šä¸»è¦ï¼Œæ€¥éœ€æ¨¡å—åŒ–çš„æ¦‚å¿µå¼•å…¥è¿›æ¥ã€‚åœ¨ ES6 ä¹‹å‰ï¼Œç¤¾åŒºåˆ¶å®šäº†ä¸€äº›æ¨¡å—åŒ–çš„æ–¹æ¡ˆï¼Œå¦‚ï¼šCommonJS å’Œ AMDã€‚ES6 ä¹‹åè¿™ä¸¤ä¸ªæ­£åœ¨æ…¢æ…¢çš„è¢« import å’Œ export æ‰€å–ä»£ã€‚ è¿™è®©æˆ‘æƒ³èµ·äº†ä¹‹å‰é¢è¯•çš„æ—¶å€™ä¸€ä¸ªé¢è¯•å®˜é—®æˆ‘ ES6 ä¸ºä»€ä¹ˆè¦å¼•å…¥ import å’Œ exportï¼Œæˆ‘çš„å›ç­”æ˜¯ä¸ºäº†æ¨¡å—åŒ–çš„åŠ è½½ï¼Œé¿å…å…¨å±€æ±¡æŸ“ï¼Œç„¶åä»–é—®äº†ä¸€ä¸ªè®©æˆ‘è‡³ä»Šéš¾å¿˜çš„é—®é¢˜ï¼Œä¸ºä»€ä¹ˆæ˜¯ import å’Œ export è¿™ä¸¤ä¸ªå•è¯ï¼Ÿï¼Ÿï¼Ÿï¼ŸğŸ˜“ğŸ˜“ğŸ˜“ å½“æ—¶çš„æˆ‘é¡¿æ—¶è¯­å¡ï¼Œåªèƒ½å¼±å¼±çš„å›ç­”ä¸€å¥ï¼ŒJS è§„èŒƒçš„â€¦.","text":"åœ¨åŸå§‹çš„ JS æ—¶ä»£ï¼Œæ˜¯æ²¡æœ‰æ¨¡å—åŒ–çš„æ¦‚å¿µçš„ï¼Œéšç€å‰ç«¯é¡¹ç›®çš„è¶Šæ¥è¶Šå¤§ï¼Œå¹¶ä¸”å‰ç«¯çš„åœ°ä½è¶Šæ¥è¶Šä¸»è¦ï¼Œæ€¥éœ€æ¨¡å—åŒ–çš„æ¦‚å¿µå¼•å…¥è¿›æ¥ã€‚åœ¨ ES6 ä¹‹å‰ï¼Œç¤¾åŒºåˆ¶å®šäº†ä¸€äº›æ¨¡å—åŒ–çš„æ–¹æ¡ˆï¼Œå¦‚ï¼šCommonJS å’Œ AMDã€‚ES6 ä¹‹åè¿™ä¸¤ä¸ªæ­£åœ¨æ…¢æ…¢çš„è¢« import å’Œ export æ‰€å–ä»£ã€‚ è¿™è®©æˆ‘æƒ³èµ·äº†ä¹‹å‰é¢è¯•çš„æ—¶å€™ä¸€ä¸ªé¢è¯•å®˜é—®æˆ‘ ES6 ä¸ºä»€ä¹ˆè¦å¼•å…¥ import å’Œ exportï¼Œæˆ‘çš„å›ç­”æ˜¯ä¸ºäº†æ¨¡å—åŒ–çš„åŠ è½½ï¼Œé¿å…å…¨å±€æ±¡æŸ“ï¼Œç„¶åä»–é—®äº†ä¸€ä¸ªè®©æˆ‘è‡³ä»Šéš¾å¿˜çš„é—®é¢˜ï¼Œä¸ºä»€ä¹ˆæ˜¯ import å’Œ export è¿™ä¸¤ä¸ªå•è¯ï¼Ÿï¼Ÿï¼Ÿï¼ŸğŸ˜“ğŸ˜“ğŸ˜“ å½“æ—¶çš„æˆ‘é¡¿æ—¶è¯­å¡ï¼Œåªèƒ½å¼±å¼±çš„å›ç­”ä¸€å¥ï¼ŒJS è§„èŒƒçš„â€¦. 1ã€exportexport ç”¨äºè§„å®šæ¨¡å—å¯¹å¤–çš„æ¥å£ï¼Œä¸ç®¡ä½ æ˜¯å¦å®šä¹‰ï¼Œexport å¯¼å‡ºçš„æ¨¡å—éƒ½æ˜¯å¤„äºä¸¥æ ¼æ¨¡å¼ï¼Œä¸èƒ½ç”¨åœ¨åµŒå…¥å¼è„šæœ¬ä¸­ã€‚ export å¯¼å‡ºçš„è¯­æ³•æœ‰ä¸¤ç§ï¼š å‘½åå¯¼å‡ºï¼ˆæ¯ä¸ªæ¨¡å—åŒ…å«ä»»æ„æ•°é‡ï¼‰ é»˜è®¤å¯¼å‡ºï¼ˆæ¯ä¸ªæ¨¡å—åªåŒ…å«ä¸€ä¸ªï¼‰ 1.1ã€å‘½åå¯¼å‡ºå¦‚åœ¨ a.js æ–‡ä»¶ä¸­ï¼Œæƒ³è¦å¯¼å‡ºå‡ ä¸ªå˜é‡ï¼Œæˆ‘ä»¬å¯ä»¥å†™æˆå¦‚ä¸‹ä¸¤ç§å½¢å¼ã€‚ 12345678910// a.js// ç¬¬ä¸€ç§export var a = 1;export var b = 2;export var c = 3;// ç¬¬äºŒç§var a = 1;var b = 2;var c = 3;export &#123; a, b, c &#125;; ä»¥ä¸Šä¸¤ç§å½¢å¼æ˜¯ç­‰ä»·çš„ï¼Œä½†æ˜¯å€¾å‘äºç¬¬äºŒç§å†™æ³•ï¼Œå› ä¸ºç¬¬äºŒç§å†™æ³•ä¾¿äºé˜…è¯»ï¼Œèƒ½ä¸€çœ¼çœ‹å‡ºè¦å¯¼å‡ºçš„å˜é‡æ˜¯ä»€ä¹ˆã€‚ é™¤äº†èƒ½å¯¼å‡ºå˜é‡ï¼Œæˆ‘ä»¬åœ¨å¼€å‘ä¸­åº”ç”¨æœ€å¤šçš„å°±æ˜¯å¯¼å‡ºå‡½æ•°å’Œç±»ã€‚ 1234567891011export function foo(a, b) &#123; return a + b;&#125;// ç­‰ä»·äºfunction foo(a, b) &#123; return a + b;&#125;export &#123; foo &#125;;// åº”ç”¨åˆ°ç®­å¤´å‡½æ•°const foo = (a, b) =&gt; a + b;export &#123; foo &#125;; å¯¼å‡ºçš„åç§°é™¤äº†å¯ä»¥æ˜¯è¯¥å˜é‡åŸæœ¬çš„åç§°å¤–ï¼Œè¿˜å¯ä»¥é€šè¿‡ as å…³é”®è¯å¯¹å…¶é‡å‘½åã€‚ 12var a = 1;export &#123; a as b, a as c &#125;; ä¸Šè¿°é€šè¿‡ as å…³é”®è¯å¯¹ a å˜é‡è¿›è¡Œäº†é‡å‘½åï¼Œå¹¶ä¸”åŒä¸€ä¸ªå˜é‡å¯ä»¥é‡å‘½åå¤šæ¬¡ã€‚ æœ‰ä¸€ç‚¹å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œexport è¾“å‡ºçš„ä¸€å®šæ˜¯ä¸€ä¸ªå˜é‡ï¼Œå˜é‡ï¼Œå˜é‡ï¼Œé‡è¦çš„äº‹æƒ…è¯´ä¸‰éã€‚ 12345// ç¬¬ä¸€ç§export 1; // æŠ¥é”™// ç¬¬äºŒç§var a = 1;export a; // æŠ¥é”™ ä¸Šè¿°ä¸¤ç§å¯¼å‡ºæ¥å£çš„æ–¹å¼å‡æŠ¥é”™ï¼Œå› ä¸ºè¾“å‡ºå‡ä¸æ˜¯å˜é‡ï¼Œç¬¬äºŒç§è™½ç„¶ a æ˜¯å˜é‡ï¼Œä½†æ˜¯å®é™…ä¸Šè·Ÿç¬¬ä¸€ç§æ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯å˜æ¢äº†ä¸€ä¸‹å†™æ³•ï¼Œå‡½æ•°å’Œç±»ä¹Ÿæ˜¯å¦‚æ­¤ã€‚ 1.2ã€é»˜è®¤å¯¼å‡ºæˆ‘ä»¬å¯ä»¥é€šè¿‡ export default å‘½åå¯¹æ¨¡å—è¿›è¡Œé»˜è®¤å¯¼å‡ºï¼Œå¹¶ä¸”ä¸€ä¸ªæ¨¡å—ä¸­åªèƒ½æœ‰ä¸€ä¸ªé»˜è®¤å¯¼å‡ºã€‚ 123456789101112export default function (a, b) &#123; return a + b;&#125;export default function foo(a, b) &#123; return a + b;&#125;export default 1;var a = 1;export default a; ä¸Šä¸€èŠ‚æˆ‘ä»¬è¯´ export æœ€é‡è¦çš„æ˜¯å¯¼å‡ºçš„æ¥å£æ˜¯å˜é‡ï¼Œåœ¨é»˜è®¤å¯¼å‡ºä¸­å‘ç°å¦‚æœå¯¼å‡ºçš„ä¸æ˜¯å˜é‡çš„è¯ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œè¿™æ˜¯å› ä¸º default å…¶å®å°±æ˜¯ä¸€ä¸ªå˜é‡ï¼Œæ‰€ä»¥å¯ä»¥å¯¼å‡ºçš„ä¸æ˜¯ä¸€ä¸ªå˜é‡ï¼Œä½†æ˜¯ default åé¢è·Ÿç€çš„æ˜¯ä¸€ä¸ªå˜é‡è¯ï¼Œä¼šæŠ¥é”™ã€‚ 1export default var a = 1; // æŠ¥é”™ 2ã€importimport å‘½ä»¤ç”¨äºè¾“å…¥å…¶ä»–æ¨¡å—æä¾›çš„åŠŸèƒ½ã€‚export æœ‰ä¸¤ç§è¯­æ³•å½¢å¼ï¼Œå¯¹åº”çš„ import ä¹Ÿæœ‰ä¸¤ç§è¯­æ³•å½¢å¼ 2.1ã€å½“è¾“å‡ºæ˜¯ç”¨çš„ export è¯­æ³•æ—¶123456// a.jsvar a = 1;var b = 2;export &#123; a, b &#125;;import &#123; a, b &#125; from \"a.js\"; å½“ export è¾“å‡ºæ¨¡å—æ¥å£æ—¶ï¼Œimport è¦ç”¨å¤§æ‹¬å·æ¥è¿›è¡Œå¯¼å…¥ï¼Œé»˜è®¤æƒ…å†µä¸‹å¯¼å…¥çš„åç§°è¦å’Œè¾“å‡ºçš„åç§°ä¸€è‡´ã€‚å¦‚æœæƒ³è¦æ›´æ”¹å¯¼å…¥çš„åç§°ï¼Œæˆ‘ä»¬åŒæ ·å¯ä»¥ç”¨ as å…³é”®è¯è¿›è¡Œé‡å‘½åã€‚ 123456// a.jsvar a = 1;var b = 2;export &#123; a, b &#125;;import &#123; a as a1, b as b1 &#125; from \"a.js\"; 2.2ã€å½“è¾“å‡ºæ˜¯ç”¨çš„ export default è¯­æ³•æ—¶12345// a.jsvar a = 1;export default a;import a from \"a.js\"; ä¹Ÿå¯ä»¥å’Œä¸Šä¸€èŠ‚ä¸€å—ä½¿ç”¨ï¼š 12345678// a.jsvar a = 1;var b = 2;var c = 3;export default c;export &#123; a, b &#125;;import c, &#123; a, b &#125; from \"a.js\"; 2.3ã€import çš„å…¶ä»–ç‰¹æ€§import è¡¨è¾¾å¼å¼•å…¥è¿›æ¥çš„æ‰€æœ‰æ¨¡å—éƒ½æ˜¯åªè¯»å½¢å¼ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸å…è®¸åœ¨åŠ è½½æ¨¡å—çš„è„šæœ¬é‡Œé¢ï¼Œæ”¹å†™æ¨¡å—ã€‚ 123import &#123; a &#125; from \"a.js\";a = &#123;&#125;; // Syntax Error : 'a' is read-only; ä½†æ˜¯å¦‚æœå¼•å…¥çš„æ¨¡å—æ˜¯ä¸€ä¸ªå¯¹è±¡ç±»å‹çš„è¯ï¼Œå®ƒçš„å±æ€§æ˜¯å¯ä»¥æ›´æ”¹ã€‚ 12import &#123; a &#125; from \"a.js\";a.name = \"Jack\"; // åˆæ³• è™½è¯´æ­¤åŠŸèƒ½åˆæ³•ï¼Œä½†æ˜¯åœ¨å®é™…å¼€å‘ä¸­è¿˜æ˜¯è¦æ…ç”¨ã€‚ import åé¢çš„ from æŒ‡å®šæ¨¡å—æ–‡ä»¶çš„ä½ç½®ï¼Œå¯ä»¥æ˜¯ç›¸å¯¹è·¯å¾„ï¼Œä¹Ÿå¯ä»¥æ˜¯ç»å¯¹è·¯å¾„ï¼Œ.js åç¼€å¯ä»¥çœç•¥ã€‚å¦‚æœåªæ˜¯æ¨¡å—åï¼Œä¸å¸¦æœ‰è·¯å¾„ï¼Œé‚£ä¹ˆå¿…é¡»æœ‰é…ç½®æ–‡ä»¶ï¼Œå‘Šè¯‰ JavaScript å¼•æ“è¯¥æ¨¡å—çš„ä½ç½®ã€‚ 1import &#123; myMethod &#125; from \"util\"; ä¸Šé¢ä»£ç ä¸­ï¼Œutil æ˜¯æ¨¡å—æ–‡ä»¶åï¼Œç”±äºä¸å¸¦æœ‰è·¯å¾„ï¼Œå¿…é¡»é€šè¿‡é…ç½®ï¼Œå‘Šè¯‰å¼•æ“æ€ä¹ˆå–åˆ°è¿™ä¸ªæ¨¡å—ã€‚ import è¿˜æœ‰ä¸€ä¸ªç‰¹æ€§æ—¶ï¼Œimport å…·æœ‰æå‡ï¼Œä¼šæå‡åˆ°æ•´ä¸ªæ–‡ä»¶çš„æœ€é¡¶ç«¯ï¼Œé¦–å…ˆæ‰§è¡Œã€‚ 12foo(); // ä¸ä¼šæŠ¥é”™import &#123; foo &#125; from \"a.js\"; ä¸Šè¿°ä¾‹å­ä¸ä¼šæŠ¥é”™çš„åŸå› å°±æ˜¯å› ä¸º import å…·æœ‰æå‡ï¼Œæå‡åˆ°äº† foo()ä¹‹å‰ï¼Œé¦–å…ˆæ‰§è¡Œã€‚ é™¤æ­¤ä¹‹å¤–ï¼Œimport ä¸èƒ½å½“åšè¡¨è¾¾å¼å’Œå˜é‡ï¼Œä¸èƒ½å‚ä¸è¿ç®—ã€‚ 1234567import &#123;'1' + foo&#125; from 'a.js' // æŠ¥é”™// æŠ¥é”™if (x === 1) &#123; import &#123; foo &#125; from 'module1';&#125; else &#123; import &#123; foo &#125; from 'module2';&#125; import è¿˜å¯ä»¥ä»…ä»…å¯¼å…¥æ¨¡å—ï¼Œä½†ä¸åšä»»ä½•çš„è¾“å…¥ã€‚ 1import \"a.js\"; è¿™å°†è¿è¡Œæ¨¡å—ä¸­çš„å…¨å±€ä»£ç , ä½†å®é™…ä¸Šä¸å¯¼å…¥ä»»ä½•å€¼ã€‚ ä¸ä¸Šè¿°ç›¸åçš„æ˜¯ï¼Œå°†æ¨¡å—å…¨éƒ¨å¯¼å…¥ï¼Œæ•´ä½“åŠ è½½ï¼Œå¹¶ä¸”åŒæ ·æ”¯æŒé€šè¿‡ as å…³é”®è¯é‡å‘½åã€‚ 123import * from 'a.js'import * as b from 'a.js' 2.4ã€export å’Œ import å¤åˆå†™æ³•å¦‚æœåœ¨ä¸€ä¸ªæ¨¡å—ä¸­å…ˆè¾“å…¥åè¾“å‡ºåŒä¸€ä¸ªæ¨¡å—ï¼Œé‚£å¯ä»¥è¿ç”¨ export å’Œ import å¤åˆå†™æ³•ï¼Œå³ exportâ€¦fromâ€¦ 1234export &#123; foo, bar &#125; from \"a.js\";// å¯ä»¥ç®€å•çš„ç†è§£ä¸ºimport &#123; foo, bar &#125; from \"a.js\";export &#123; foo, bar &#125;; å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œä¸Šè¿°çš„ foo å’Œ bar å¹¶æ²¡æœ‰å¼•å…¥åˆ°å½“å‰æ¨¡å—ï¼Œå½“å‰æ¨¡å—ç›¸å½“äºä¸€ä¸ªä¸­è½¬ç«™ï¼Œåªæ˜¯å¯¹ foo å’Œ bar è¿›è¡Œè½¬å‘ã€‚ åŒæ ·æˆ‘ä»¬ä¾ç„¶å¯ä»¥å¯¹è½¬å‘çš„æ¨¡å—è¿›è¡Œé‡å‘½åï¼Œè€Œä¸”å¯ä»¥é€šè¿‡*å¯¹å…¶å…¨éƒ¨è½¬å‘ã€‚ 12export &#123; foo as foo1 &#125; from \"a.js\";export * from \"a.js\"; åœ¨ ES2020 ä¸­è¿˜å¯ä»¥å¯¹*é€šè¿‡ as å…³é”®è¯è¿›è¡Œé‡å‘½åã€‚ 1234export * as a from \"a.js\";// ç­‰ä»·äºimport * as a from \"a.js\";export &#123; a &#125;; é™¤æ­¤ä¹‹å¤–ï¼Œåœ¨ export å’Œ import å¤åˆå†™æ³•ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹é»˜è®¤æ¨¡å—è¿›è¡Œè½¬å‘ã€‚ 1export &#123; default &#125; from \"a.js\"; æ˜¯ä¸æ˜¯æ„Ÿè§‰å¾ˆå¥‡æ€ªï¼Œæ²¡é”™ï¼Œæˆ‘ç¬¬ä¸€æ¬¡è§åˆ°çš„æ—¶å€™ä¹Ÿå¾ˆå¥‡æ€ªï¼Œä½†æ˜¯åæœŸæƒ³äº†ä¸€ä¸‹ï¼Œexportâ€¦fromâ€¦å¯¼å…¥å˜é‡ï¼Œdefault ä¹Ÿæ˜¯å˜é‡çš„ä¸€ç§ï¼Œæ‰€ä»¥è¿™ç§ä¹Ÿå°±ä¸å¥‡æ€ªäº†ã€‚ ä¾æ—§å¯ä»¥é€šè¿‡ as è¿›è¡Œé‡å‘½åã€‚ 1export &#123; default as foo &#125; from \"a.js\"; å¹¶ä¸”è¿˜å¯ä»¥å°†å…·åæ¥å£æ”¹ä¸ºé»˜è®¤æ¥å£ã€‚ 1234export &#123; foo as default &#125; from \"a.js\";// ç­‰ä»·äºimport &#123; foo &#125; from \"a.js\";export default foo; 2.5ã€import()ES2020 ä¸­æ–°å¢äº† import()ï¼Œä¸»è¦æ˜¯ä¸ºäº†è§£å†³æ— æ³•åŠ¨æ€å¯¼å…¥çš„é—®é¢˜ï¼Œå› ä¸ºä¹‹å‰ä¹Ÿè¯´è¿‡ï¼ŒJS ä¸ºäº†é™æ€åˆ†æä¼˜åŒ–ï¼Œæ‰€ä»¥ import å¿…é¡»æ”¾åœ¨æ•´ä¸ªæ¨¡å—çš„é¡¶éƒ¨ï¼Œå¹¶ä¸”ä¸èƒ½å’Œè¡¨è¾¾å¼æ··åˆä½¿ç”¨ï¼Œè¿™åœ¨æœ‰äº›åœºæ™¯ï¼Œå°¤å…¶æ˜¯ Node ä¸­å¾ˆæ˜¯éº»çƒ¦ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆ Node è¿˜æ˜¯åå‘ç”¨ require å¯¼å…¥æ¥å£çš„åŸå› ä¹‹ä¸€ã€‚ ä½¿ç”¨ import()åŠ¨æ€åŠ è½½æ¥å£çš„ç”¨æ³•å¾ˆç®€å•ï¼Œæ‹¬å·å†…å¡«å†™è¦åŠ¨æ€å¯¼å…¥æ¥å£å°±å¯ä»¥ã€‚ 1import(\"a.js\"); import()ä¼šè¿”å›ä¸€ä¸ª Promise å¯¹è±¡ã€‚ 1import(\"a.js\").then((value) =&gt; console.log(value)); import()çš„åº”ç”¨ï¼Œæœ€ç›´è§‚çš„å°±æ˜¯åº”ç”¨åœ¨åŠ¨æ€åŠ è½½ç»„ä»¶ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° dva ä¸­dva/dynamicå…¶å†…éƒ¨ä¸»è¦å°±æ˜¯è¿ç”¨äº† import()ï¼Œå¯¹ç»„ä»¶å’Œè·¯ç”±è¿›è¡ŒåŠ¨æ€åŠ è½½ï¼Œè¾¾åˆ°ä¼˜åŒ–ç›®çš„ã€‚ 1234567import dynamic from \"dva/dynamic\";const UserPageComponent = dynamic(&#123; app, models: () =&gt; [import(\"./models/users\")], component: () =&gt; import(\"./routes/UserPage\"),&#125;);","categories":[{"name":"ES6","slug":"ES6","permalink":"https://tomatoesman.github.io/categories/ES6/"}],"tags":[{"name":"ES6","slug":"ES6","permalink":"https://tomatoesman.github.io/tags/ES6/"}]},{"title":"Symbol","slug":"Symbol","date":"2020-07-18T06:42:08.000Z","updated":"2020-07-18T07:01:09.967Z","comments":true,"path":"2020/07/18/Symbol/","link":"","permalink":"https://tomatoesman.github.io/2020/07/18/Symbol/","excerpt":"å‰è¨€è¿™ç¯‡æ–‡ç« è¯´å®è¯ï¼Œåœ¨å†™å®Œçš„é‚£ä¸€åˆ»çœŸçš„å¯¹ Symbol è¿™ä¸ªç±»å‹è‚ƒç„¶èµ·æ•¬ï¼Œå¹³æ—¶çœŸçš„ä¸ç”¨è¿™ä¸ªæ•°æ®ç±»å‹ï¼Œä¹Ÿæ²¡æœ‰æƒ³è¿‡ä¼šç”¨å®ƒï¼Œä¹‹å‰è¿˜æ˜¯åœç•™åœ¨åªæ˜¯çŸ¥é“è¿™ä¸ªå•è¯çš„é˜¶æ®µï¼Œåœ¨å†™å®Œåæ‰å‘è§‰å®ƒçš„å¼ºå¤§ã€‚","text":"å‰è¨€è¿™ç¯‡æ–‡ç« è¯´å®è¯ï¼Œåœ¨å†™å®Œçš„é‚£ä¸€åˆ»çœŸçš„å¯¹ Symbol è¿™ä¸ªç±»å‹è‚ƒç„¶èµ·æ•¬ï¼Œå¹³æ—¶çœŸçš„ä¸ç”¨è¿™ä¸ªæ•°æ®ç±»å‹ï¼Œä¹Ÿæ²¡æœ‰æƒ³è¿‡ä¼šç”¨å®ƒï¼Œä¹‹å‰è¿˜æ˜¯åœç•™åœ¨åªæ˜¯çŸ¥é“è¿™ä¸ªå•è¯çš„é˜¶æ®µï¼Œåœ¨å†™å®Œåæ‰å‘è§‰å®ƒçš„å¼ºå¤§ã€‚ Symbolï¼ŒES6 ä¸­æ–°å¢çš„æ•°æ®ç±»å‹ï¼Œä¸ºä»€ä¹ˆè¦å¢åŠ è¿™ä¹ˆä¸€ä¸ªæ•°æ®ç±»å‹ï¼Ÿå½“åˆä¸€ä¸ªé¢è¯•å®˜è¿™ä¹ˆé—®çš„æˆ‘ï¼Œå½“æ—¶å¹´å°‘è½»ç‹‚çš„æˆ‘ï¼Œå†…å¿ƒçš„ os æ˜¯ï¼Œæˆ‘å“ªçŸ¥é“ ğŸ¤£ï¼å…¶å®è¿˜æ˜¯å¯¹ Symbol è¿™ä¸ªæ•°æ®ç±»å‹ä¸ç†Ÿæ‚‰ã€‚ åœ¨ ES6 ä¹‹å‰ï¼Œå¯¹è±¡çš„é”®åªèƒ½æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œä½†æ˜¯è¿™æ ·æœ‰ä¸ªé—®é¢˜ï¼Œå°±æ˜¯ä¼šé€ æˆé”®åå‘½åå†²çªï¼Œåè€…è¦†ç›–å‰è€…ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦ä¸€ä¸ªå”¯ä¸€å€¼æ¥å……å½“é”®åï¼ŒSymbol æ¨ªç©ºå‡ºä¸–ã€‚ 1ã€æ¦‚å¿µsymbol æ˜¯ä¸€ç§åŸºæœ¬æ•°æ®ç±»å‹ï¼ŒSymbol()å‡½æ•°ä¼šè¿”å› symbol ç±»å‹çš„å€¼ï¼Œè¯¥ç±»å‹å…·æœ‰é™æ€å±æ€§å’Œé™æ€æ–¹æ³•ã€‚ä½†æ˜¯å®ƒä¸æ˜¯æ„é€ å‡½æ•°ï¼Œä¸èƒ½ç”¨ new Symbol()æ¥åˆ›å»ºã€‚ 12let symbol = Symbol();typeof symbol; // \"symbol\" Symbol ä½œä¸ºå¯¹è±¡å±æ€§æ—¶ï¼Œå½“åœ¨å¯¹è±¡å†…éƒ¨æ—¶ï¼Œå¿…é¡»è¦ç”¨æ–¹æ‹¬å·æ‹¬èµ·æ¥ï¼Œä¸ç”¨æ–¹æ‹¬å·æ‹¬èµ·æ¥ä»£è¡¨çš„æ˜¯å­—ç¬¦ä¸²ã€‚ 123456let s = Symbol();let obj = &#123; [s]: \"Jack\",&#125;;obj[s]; // \"Jack\"obj.s; // undefined è€Œä¸”å½“è¦å–è¯¥å±æ€§çš„å€¼æ—¶ï¼Œä¸èƒ½ç”¨ç‚¹è¿ç®—ç¬¦ï¼Œå› ä¸ºç‚¹è¿ç®—ç¬¦åé¢åŒæ ·æ˜¯å­—ç¬¦ä¸²ç±»å‹ã€‚ åˆ›å»º Symbol æ•°æ®ç±»å‹æ—¶ï¼Œéƒ½æ˜¯ Symbol()è¿™ä¹ˆåˆ›å»ºçš„ï¼Œå½“æ‰“å°å‡ºæ¥æ—¶ï¼Œéƒ½ä¸º Symbol()ï¼Œè¿™æ ·å¾ˆéš¾åŒºåˆ«å„ä¸ª Symbol ç±»å‹çš„å˜é‡æ˜¯ä»€ä¹ˆæ„æ€ã€‚æ‰€ä»¥åœ¨ Symbol å‡½æ•°å†…å¯ä»¥æ¥æ”¶ä¸€ä¸ªå­—ç¬¦ä¸²çš„å‚æ•°ï¼Œè¡¨ç¤ºè¯¥å®šä¹‰ Symbol ç±»å‹å˜é‡çš„æè¿°ã€‚ 123let s1 = Symbol(\"a\");console.log(s1); // Symbol(a)s1.toString(); // \"Symbol(a)\" å¦‚æœ Symbol ç±»å‹æ¥æ”¶çš„ä¸€ä¸ªå¯¹è±¡ç±»å‹çš„è¯ï¼Œé‚£å°±ä¼šå…ˆè°ƒç”¨å…¶å†…éƒ¨çš„ toString æ–¹æ³•ï¼Œå°†å…¶å˜ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç„¶åæ‰ç”Ÿæˆä¸€ä¸ª Symbol å€¼ã€‚ 12345678let arr = [1, 2, 3];let s1 = Symbol(arr);console.log(s1); // Symbol(1,2,3)let obj = &#123; toString: () =&gt; \"abc\",&#125;;let s2 = Symbol(obj);console.log(s2); // Symbol(abc) Symbol ç±»å‹çš„å˜é‡æ˜¯ä¸èƒ½å’Œå…¶ä»–å˜é‡å‚ä¸è¿ç®—çš„ï¼Œè€Œä¸”å…¶åªèƒ½è½¬ä¸º String ç±»å‹å’Œ Boolean ç±»å‹ã€‚ 12345let s = Symbol();console.log(\"1\" + s); // TypeError: Cannot convert a Symbol value to a strings.toString(); // \"Symbol()\"Boolean(s); // trueNumber(s); // TypeError: Cannot convert a Symbol value to a number 2ã€Symbol.prototype.descriptionå½“ç»™ Symbol æ·»åŠ æè¿°æ—¶ï¼Œå¯ä»¥é€šè¿‡ Symbol.prototype.description æ¥è·å–è¯¥æè¿°ã€‚ 12let s = Symbol(\"Jack\");s.description; // 'Jack' 3ã€Symbol.for(key)å’Œ Symbol.keyFor(sym)æœ€å¼€å§‹çœ‹åˆ°è¿™ä¸¤ä¸ªæ–¹æ³•æ—¶ï¼Œæˆ‘ä»¥ä¸ºæ˜¯ä¸¤ä¸ªéå†çš„æ–¹æ³• ğŸ˜…ã€‚ Symbol.for(key)ï¼šä½¿ç”¨ç»™å®šçš„ key æœç´¢ç°æœ‰çš„ symbolï¼Œå¦‚æœæ‰¾åˆ°åˆ™è¿”å›è¯¥ symbolã€‚å¦åˆ™å°†ä½¿ç”¨ç»™å®šçš„ key åœ¨å…¨å±€ symbol æ³¨å†Œè¡¨ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„ symbolã€‚ Symbol.keyFor(sym)ï¼šä»å…¨å±€ symbol æ³¨å†Œè¡¨ä¸­ï¼Œä¸ºç»™å®šçš„ symbol æ£€ç´¢ä¸€ä¸ª keyã€‚ 123let s1 = Symbol.for(\"foo\");let s2 = Symbol.for(\"foo\");s1 === s2; // true Symbol.for ä¼šæœç´¢æœ‰æ²¡æœ‰ä»¥è¯¥å‚æ•°ä½œä¸ºåç§°çš„ Symbol å€¼ã€‚å¦‚æœæœ‰ï¼Œå°±è¿”å›è¿™ä¸ª Symbol å€¼ï¼Œå¦åˆ™å°±æ–°å»ºä¸€ä¸ªä»¥è¯¥å­—ç¬¦ä¸²ä¸ºåç§°çš„ Symbol å€¼ï¼Œå¹¶å°†å…¶æ³¨å†Œåˆ°å…¨å±€ã€‚æ‰€ä»¥ç”±å…¶åˆ›å»ºçš„ä¸¤ä¸ªç›¸åŒæè¿°çš„å€¼ä¼šç›¸ç­‰ã€‚è¿™ç§åˆ›å»ºå°±å’Œæ™®é€šçš„ Symbol()æœ‰ç€æˆªç„¶ä¸åŒçš„ç»“æœäº†ï¼š 123let s1 = Symbol(\"foo\");let s2 = Symbol(\"foo\");s1 === s2; // false å› ä¸ºä¸ç®¡æ€æ · Symbol()è¿”å›çš„éƒ½æ˜¯ä¸€ä¸ªå…¨æ–°çš„å€¼ï¼Œæ¢å¥è¯è¯´ Symbol()ç”Ÿæˆçš„å€¼æ²¡æœ‰æ³¨å†Œåœ¨å…¨å±€ä¸­ï¼Œæ‰€ä»¥è¿”å›çš„å€¼éƒ½æ˜¯å…¨æ–°çš„ï¼Œè€Œ Symbol.for()ä¼šåœ¨å…ˆåœ¨å…¨å±€ä¸­æŸ¥æ‰¾ï¼Œæœ‰å°±è¿”å›è¿™ä¸ªå€¼ï¼Œæ²¡æœ‰åˆ™åˆ›å»ºæ–°çš„å€¼ï¼Œä½†æ–°çš„å€¼ä¹Ÿæ˜¯æŒ‚è½½åœ¨å…¨å±€ä¸­çš„ã€‚ Symbol.keyFor(sym)æ˜¯åœ¨å…¨å±€ä¸­æŸ¥æ‰¾æ˜¯å¦æœ‰è¯¥ Symbol å€¼ï¼Œæœ‰åˆ™è¿”å›è¯¥æè¿°ã€‚ 1234let s1 = Symbol.for(\"Jack\");Symbol.keyFor(s1); // 'Jack'let s2 = Symbol(\"Rose\");Symbol.keyFor(s2); // undefined å› ä¸º s2 æ²¡æœ‰æŒ‚è½½åœ¨å…¨å±€ä¸­ï¼Œæ‰€ä»¥ Symbol.keyFor()æ‰¾ä¸åˆ°å®ƒï¼Œæ•…è¿”å› undefinedã€‚ 4ã€å†…ç½®çš„ Symbol å±æ€§é™¤äº†å®šä¹‰è‡ªå·±ä½¿ç”¨çš„ Symbol å€¼ä»¥å¤–ï¼ŒES6 è¿˜æä¾›äº† 13ï¼ˆæœ‰å¯èƒ½ä»Šåä¼šæ›´å¤š ğŸ˜›ï¼‰ ä¸ªå†…ç½®çš„ Symbol å€¼ï¼ŒæŒ‡å‘è¯­è¨€å†…éƒ¨ä½¿ç”¨çš„æ–¹æ³•ã€‚ 4.1 Symbol.asyncIteratorSymbol.asyncIterator ç¬¦å·æŒ‡å®šäº†ä¸€ä¸ªå¯¹è±¡çš„é»˜è®¤å¼‚æ­¥è¿­ä»£å™¨ã€‚å¦‚æœä¸€ä¸ªå¯¹è±¡è®¾ç½®äº†è¿™ä¸ªå±æ€§ï¼Œå®ƒå°±æ˜¯å¼‚æ­¥å¯è¿­ä»£å¯¹è±¡ï¼Œå¯ç”¨äº for awaitâ€¦of å¾ªç¯ã€‚æ¢å¥è¯è¯´ä¸€ä¸ªå¼‚æ­¥å¯è¿­ä»£å¯¹è±¡å†…éƒ¨å¿…é¡»æœ‰ Symbol.asyncIterator å±æ€§ã€‚ 12345678910111213141516const myAsyncIterable = new Object();myAsyncIterable[Symbol.asyncIterator] = async function* () &#123; yield \"hello\"; yield \"async\"; yield \"iteration!\";&#125;;(async () =&gt; &#123; for await (const x of myAsyncIterable) &#123; console.log(x); // expected output: // \"hello\" // \"async\" // \"iteration!\" &#125;&#125;)(); å½“æ‰§è¡Œ for awaitâ€¦of æ—¶ï¼Œå°±ä¼šæ‰§è¡Œè¯¥å˜é‡ä¸­ Symbol.asyncIterator å±æ€§å€¼ã€‚ 4.2ã€Symbol.hasInstanceSymbol.hasInstance ç”¨äºåˆ¤æ–­æŸå¯¹è±¡æ˜¯å¦ä¸ºæŸæ„é€ å™¨çš„å®ä¾‹ã€‚å› æ­¤ä½ å¯ä»¥ç”¨å®ƒè‡ªå®šä¹‰ instanceof æ“ä½œç¬¦åœ¨æŸä¸ªç±»ä¸Šçš„è¡Œä¸ºã€‚æ¢å¥è¯è¯´å½“åˆ¤æ–­ä¸€ä¸ªå®ä¾‹æ˜¯å¦ä¸ºä¸€ä¸ªç±»çš„å®ä¾‹æ—¶ï¼Œå…¶å®å°±æ˜¯æ‰§è¡Œè¯¥ç±»é‡Œé¢çš„ Symbol.hasInstance å±æ€§ã€‚ 1234567class Fu &#123; [Symbol.hasInstance](num) &#123; return num === 1; &#125;&#125;1 instanceof new Fu(); // true2 instanceof new Fu(); // false 4.3ã€Symbol.isConcatSpreadableå†…ç½®çš„ Symbol.isConcatSpreadable ç¬¦å·ç”¨äºé…ç½®æŸå¯¹è±¡ä½œä¸º Array.prototype.concat()æ–¹æ³•çš„å‚æ•°æ—¶æ˜¯å¦å±•å¼€å…¶æ•°ç»„å…ƒç´ ã€‚ 123456789// é»˜è®¤æƒ…å†µä¸‹let arr = [1, 2, 3];let brr = [4, 5, 6];arr.concat(brr); // [1, 2, 3, 4, 5, 6]// è®¾ç½®äº†Symbol.isConcatSpreadableålet arr = [1, 2, 3];let brr = [4, 5, 6];brr[Symbol.isConcatSpreadable] = false;arr.concat(brr); // [1, 2, 3, [4, 5, 6]] å°†æ•°ç»„çš„ Symbol.isConcatSpreadable å±æ€§è®¾ç½®ä¸º false åï¼Œä½¿ç”¨ concat æ–¹æ³•æ—¶è¯¥æ•°æ®å°±ä¸ä¼šå±•å¼€ã€‚ å¯¹äºç±»æ•°ç»„è€Œè¨€ï¼Œé»˜è®¤æ•°ç»„ä½¿ç”¨ concat æ–¹æ³•è¯¥ç±»æ•°ç»„æ˜¯ä¸å±•å¼€çš„ï¼Œæˆ‘ä»¬å¯ä»¥ç»™ç±»æ•°ç»„çš„ Symbol.isConcatSpreadable è®¾ç½®ä¸º trueï¼Œè¿™æ ·å°±å¯ä»¥å±•å¼€äº†ï¼Œå¹¶ä¸”å®Œæˆäº†ç±»æ•°ç»„è½¬æ¢ä¸ºæ•°ç»„ï¼Œè¿™æ ·ç±»æ•°ç»„è½¬æ•°ç»„åˆå¤šäº†ä¸€ä¸ªæ–¹æ³•ã€‚ 12345678910111213// é»˜è®¤æƒ…å†µä¸‹function foo(x, y) &#123; let arr = [].concat(arguments); console.log(arr); //[Arguments(2)]&#125;foo(1, 2);// è®¾ç½®äº†Symbol.isConcatSpreadableä¸ºtrueåfunction foo(x, y) &#123; arguments[Symbol.isConcatSpreadable] = true; let arr = [].concat(arguments); console.log(arr); //[1, 2]&#125;foo(1, 2); 4.4ã€Symbol.iteratorSymbol.iterator ä¸ºæ¯ä¸€ä¸ªå¯¹è±¡å®šä¹‰äº†é»˜è®¤çš„è¿­ä»£å™¨ã€‚è¯¥è¿­ä»£å™¨å¯ä»¥è¢« forâ€¦of å¾ªç¯ä½¿ç”¨ã€‚ 12345678const myIterable = &#123;&#125;;myIterable[Symbol.iterator] = function* () &#123; yield 1; yield 2; yield 3;&#125;;[...myIterable]; // [1, 2, 3] å¯¹è±¡è¿›è¡Œ forâ€¦of å¾ªç¯æ—¶ï¼Œä¼šè°ƒç”¨ Symbol.iterator æ–¹æ³•ï¼Œ 4.5ã€Symbol.matchSymbol.match æŒ‡å®šäº†åŒ¹é…çš„æ˜¯æ­£åˆ™è¡¨è¾¾å¼è€Œä¸æ˜¯å­—ç¬¦ä¸²ã€‚String.prototype.match() æ–¹æ³•ä¼šè°ƒç”¨æ­¤å‡½æ•°ã€‚æ¢å¥è¯è¯´å°±æ˜¯å½“ str.match()æ‰§è¡Œæ—¶å¦‚æœè¯¥å±æ€§å­˜åœ¨ï¼Œå°±ä¼šè¿”å›è¯¥æ–¹æ³•çš„è¿”å›å€¼ã€‚ 123456class foo &#123; [Symbol.match](string) &#123; return string; &#125;&#125;\"Jack\".match(new foo()); // 'Jack' é™¤ä¸Šè¿°ä¹‹å¤–ï¼ŒMDN è¿˜æå‡ºäº†è¯¥å±æ€§å¦å¤–ä¸€ä¸ªåŠŸèƒ½ï¼šæ­¤å‡½æ•°è¿˜ç”¨äºæ ‡è¯†å¯¹è±¡æ˜¯å¦å…·æœ‰æ­£åˆ™è¡¨è¾¾å¼çš„è¡Œä¸ºã€‚æ¯”å¦‚ï¼Œ String.prototype.startsWith()ï¼ŒString.prototype.endsWith() å’Œ String.prototype.includes() è¿™äº›æ–¹æ³•ä¼šæ£€æŸ¥å…¶ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å¦æ˜¯æ­£åˆ™è¡¨è¾¾å¼ï¼Œæ˜¯æ­£åˆ™è¡¨è¾¾å¼å°±æŠ›å‡ºä¸€ä¸ª TypeErrorã€‚ç°åœ¨ï¼Œå¦‚æœ match symbol è®¾ç½®ä¸º falseï¼ˆæˆ–è€…ä¸€ä¸ª å‡å€¼ï¼‰ï¼Œå°±è¡¨ç¤ºè¯¥å¯¹è±¡ä¸æ‰“ç®—ç”¨ä½œæ­£åˆ™è¡¨è¾¾å¼å¯¹è±¡ã€‚ 123456\"/bar/\".startsWith(/bar/); // TypeError: First argument to String.prototype.startsWith must not be a regular expression// å½“è®¾ç½®ä¸ºfalseä¹‹åvar re = /foo/;re[Symbol.match] = false;\"/foo/\".startsWith(re); // true\"/baz/\".endsWith(re); // false 4.6ã€Symbol.matchAllSymbol.matchAll è¿”å›ä¸€ä¸ªè¿­ä»£å™¨ï¼Œè¯¥è¿­ä»£å™¨æ ¹æ®å­—ç¬¦ä¸²ç”Ÿæˆæ­£åˆ™è¡¨è¾¾å¼çš„åŒ¹é…é¡¹ã€‚æ­¤å‡½æ•°å¯ä»¥è¢« String.prototype.matchAll() æ–¹æ³•è°ƒç”¨ã€‚ 123\"abc\".matchAll(/a/);// ç­‰ä»·äº/a/[Symbol.matchAll](\"abc\"); 4.7ã€Symbol.replaceSymbol.replace è¿™ä¸ªå±æ€§æŒ‡å®šäº†å½“ä¸€ä¸ªå­—ç¬¦ä¸²æ›¿æ¢æ‰€åŒ¹é…å­—ç¬¦ä¸²æ—¶æ‰€è°ƒç”¨çš„æ–¹æ³•ã€‚String.prototype.replace() æ–¹æ³•ä¼šè°ƒç”¨æ­¤æ–¹æ³•ã€‚ 1234567891011121314String.prototype.replace(searchValue, replaceValue);// ç­‰åŒäºsearchValue[Symbol.replace](this, replaceValue);// ä¾‹å­class Replace1 &#123; constructor(value) &#123; this.value = value; &#125; [Symbol.replace](string) &#123; return `s/$&#123;string&#125;/$&#123;this.value&#125;/g`; &#125;&#125;console.log(\"foo\".replace(new Replace1(\"bar\"))); // \"s/foo/bar/g\" 4.8ã€Symbol.searchSymbol.search æŒ‡å®šäº†ä¸€ä¸ªæœç´¢æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•æ¥å—ç”¨æˆ·è¾“å…¥çš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œè¿”å›è¯¥æ­£åˆ™è¡¨è¾¾å¼åœ¨å­—ç¬¦ä¸²ä¸­åŒ¹é…åˆ°çš„ä¸‹æ ‡ï¼Œè¿™ä¸ªæ–¹æ³•ç”±ä»¥ä¸‹çš„æ–¹æ³•æ¥è°ƒç”¨ String.prototype.search()ã€‚ 12345678910String.prototype.search(regexp);// ç­‰ä»·äºregexp[Symbol.search](this);// ä¾‹å­class Search1 &#123; [Symbol.search](str) &#123; return `$&#123;str&#125; Word`; &#125;&#125;\"Hello\".search(new Search1()); // Hello Word 4.9ã€Symbol.speciesSymbol.species æ˜¯ä¸ªå‡½æ•°å€¼å±æ€§ï¼Œå…¶è¢«æ„é€ å‡½æ•°ç”¨ä»¥åˆ›å»ºæ´¾ç”Ÿå¯¹è±¡ï¼Œæ¢å¥è¯è¯´ species è®¿é—®å™¨å±æ€§å…è®¸å­ç±»è¦†ç›–å¯¹è±¡çš„é»˜è®¤æ„é€ å‡½æ•°ã€‚ æˆ‘ä»¬ä¸¾ä¸ªä¾‹å­ï¼š 123456// é»˜è®¤æƒ…å†µä¸‹class MyArray extends Array &#123;&#125;let arr = new MyArray(1, 2, 3);let brr = arr.map((item) =&gt; item);brr instanceof MyArray; // truebrr instanceof Array; // true ç±» MyArray ç»§æ‰¿äº Arrayï¼Œarr ä¸º MyArray çš„å®ä¾‹ï¼Œbrr ä¸º arr çš„è¡ç”Ÿç‰©ï¼Œæ‰€ä»¥ brr æ˜¯ MyArray çš„å®ä¾‹ï¼Œå¹¶ä¸”ç”±äºåŸå‹é“¾çš„ç¼˜æ•…ï¼Œbrr ä¹Ÿæ˜¯ Array çš„å®ä¾‹ã€‚å¦‚æœæ­¤æ—¶ï¼Œæˆ‘ä»¬åªæƒ³è®© brr ä¸º Array çš„å®ä¾‹ï¼Œé‚£ Symbol.species å±æ€§å€¼å°±æ´¾ä¸Šç”¨åœºäº†ã€‚ 123456789101112131415class MyArray extends Array &#123; static get [Symbol.species]() &#123; return Array; &#125;&#125;let arr = new MyArray(1, 2, 3);let brr = arr.map((item) =&gt; item);brr instanceof MyArray; // falsebrr instanceof Array; // true// é»˜è®¤æƒ…å†µä¸‹class MyArray extends Array &#123; static get [Symbol.species]() &#123; return this; &#125;&#125; å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå®šä¹‰ Symbol.species å±æ€§æ—¶ï¼Œå‰é¢å¿…é¡»å£°æ˜æ˜¯é™æ€çš„ static å¹¶ä¸”è¦è¿ç”¨ get å–å€¼å™¨ã€‚ 4.10ã€Symbol.splitSymbol.split æŒ‡å‘ ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼çš„ç´¢å¼•å¤„åˆ†å‰²å­—ç¬¦ä¸²çš„æ–¹æ³•ã€‚ è¿™ä¸ªæ–¹æ³•é€šè¿‡ String.prototype.split() è°ƒç”¨ã€‚ 12345678910String.prototype.split(separator, limit);// ç­‰ä»·äºseparator[Symbol.split](this, limit);// ä¾‹å­class Split1 &#123; [Symbol.split](str) &#123; return `$&#123;str&#125; Word`; &#125;&#125;\"Hello\".split(new Split1()); // Hello Word 4.11ã€Symbol.toPrimitiveSymbol.toPrimitive æ˜¯ä¸€ä¸ªå†…ç½®çš„ Symbol å€¼ï¼Œå®ƒæ˜¯ä½œä¸ºå¯¹è±¡çš„å‡½æ•°å€¼å±æ€§å­˜åœ¨çš„ï¼Œå½“ä¸€ä¸ªå¯¹è±¡è½¬æ¢ä¸ºå¯¹åº”çš„åŸå§‹å€¼æ—¶ï¼Œä¼šè°ƒç”¨æ­¤å‡½æ•°ã€‚è¯¥å‡½æ•°åœ¨è°ƒç”¨æ—¶ï¼Œä¼šä¼ é€’ä¸€ä¸ªå­—ç¬¦ä¸²å‚æ•° hintï¼Œè¡¨ç¤ºè¦è½¬æ¢åˆ°çš„åŸå§‹å€¼çš„é¢„æœŸç±»å‹ã€‚å­—ç¬¦ä¸² hint çš„ç±»å‹æœ‰ä¸‰ç§ï¼šâ€™numberâ€™, â€˜stringâ€™, â€˜defaultâ€™ã€‚ 1234567891011121314151617let obj = &#123; [Symbol.toPrimitive](hint) &#123; switch (hint) &#123; case \"number\": return 123; case \"string\": return \"123\"; case \"default\": return \"default\"; default: throw new Error(); &#125; &#125;, &#125; + obj; // 123`$&#123;obj&#125;`; // '123'obj + \"\"; // \"default\" 4.12ã€Symbol.toStringTagSymbol.toStringTag æ˜¯ä¸€ä¸ªå†…ç½® symbolï¼Œå®ƒé€šå¸¸ä½œä¸ºå¯¹è±¡çš„å±æ€§é”®ä½¿ç”¨ï¼Œå¯¹åº”çš„å±æ€§å€¼åº”è¯¥ä¸ºå­—ç¬¦ä¸²ç±»å‹ï¼Œè¿™ä¸ªå­—ç¬¦ä¸²ç”¨æ¥è¡¨ç¤ºè¯¥å¯¹è±¡çš„è‡ªå®šä¹‰ç±»å‹æ ‡ç­¾ï¼Œé€šå¸¸åªæœ‰å†…ç½®çš„ Object.prototype.toString() æ–¹æ³•ä¼šå»è¯»å–è¿™ä¸ªæ ‡ç­¾å¹¶æŠŠå®ƒåŒ…å«åœ¨è‡ªå·±çš„è¿”å›å€¼é‡Œã€‚é€šä¿—ç‚¹è®²å°±æ˜¯åœ¨ Object.prototype.toString()å»åˆ¤æ–­è‡ªå®šä¹‰å¯¹è±¡çš„æ•°æ®ç±»å‹æ—¶ï¼Œè¿”å›çš„éƒ½æ˜¯ objectï¼Œå¯ä»¥é€šè¿‡è¿™ä¸ªå±æ€§æ¥ç»™è‡ªå®šä¹‰å¯¹è±¡æ·»åŠ ç±»å‹æ ‡ç­¾ã€‚åœ¨æˆ‘ä¹‹å‰å†™çš„ã€é‡å­¦ JS ä¹‹è·¯ã€‘js åŸºç¡€ç±»å‹å’Œå¼•ç”¨ç±»å‹å†™åˆ°æœ€ç²¾ç¡®åˆ¤æ–­æ•°æ®ç±»å‹çš„æ–¹æ³•å°±æ˜¯ Object.prototype.toString()ï¼Œè‡³äºæ˜¯ä¸ºä»€ä¹ˆï¼Œåœ¨è¿™å°±ä¸è¿‡å¤šé˜è¿°äº†ï¼Œå¯ä»¥çœ‹è¿™ç¯‡æ–‡ç« ã€‚ 12Object.prototype.toString.call('123'); // [object String]...more å¦å¤–ä¸€äº›å¯¹è±¡ç±»å‹åˆ™ä¸ç„¶ï¼ŒtoString() æ–¹æ³•èƒ½è¯†åˆ«å®ƒä»¬æ˜¯å› ä¸ºå¼•æ“ä¸ºå®ƒä»¬è®¾ç½®å¥½äº† toStringTag æ ‡ç­¾ï¼š 1234Object.prototype.toString.call(new Map()); // \"[object Map]\"Object.prototype.toString.call(function* () &#123;&#125;); // \"[object GeneratorFunction]\"Object.prototype.toString.call(Promise.resolve()); // \"[object Promise]\"...more å½“æˆ‘ä»¬è‡ªå·±å®šä¹‰ä¸€ä¸ªç±»æ—¶ï¼Œè°ƒç”¨ Object.prototype.toString()æ—¶ï¼Œç”±äºæ²¡æœ‰å†…éƒ¨å®šä¹‰ toStringTag æ ‡ç­¾ï¼Œæ‰€ä»¥åªèƒ½è¿”å›â€[object Object]â€ 123456789class Foo &#123;&#125;Object.prototype.toString.call(new Foo()); // \"[object Object]\"// è®¾ç½®Symbol.toStringTagclass Foo &#123; get [Symbol.toStringTag]() &#123; return \"Foo\"; &#125;&#125;Object.prototype.toString.call(new Foo()); // \"[object Foo]\" 4.13ã€Symbol.unscopablessSymbol.unscopables æŒ‡ç”¨äºæŒ‡å®šå¯¹è±¡å€¼ï¼Œå…¶å¯¹è±¡è‡ªèº«å’Œç»§æ‰¿çš„ä»å…³è”å¯¹è±¡çš„ with ç¯å¢ƒç»‘å®šä¸­æ’é™¤çš„å±æ€§åç§°ã€‚è¯´ç™½äº†å…¶å±æ€§å°±æ˜¯æ§åˆ¶ï¼Œåœ¨ with è¯æ³•ç¯å¢ƒä¸­å“ªäº›å±æ€§ä¼šè¢« with åˆ é™¤ã€‚ 12345678910Array.prototype[Symbol.unscopabless];// &#123;// copyWithin: true,// entries: true,// fill: true,// find: true,// findIndex: true,// includes: true,// keys: true// &#125; è¿™é‡Œç®€å•çš„è®²è§£ä¸€ä¸‹ with å‡½æ•°ï¼Œwith ä¸»è¦æ˜¯ç”¨æ¥å¯¹å¯¹è±¡å–å€¼çš„ï¼Œä¸¾ä¸ªç®€å•çš„ä¾‹å­ï¼š 12345678910let obj = &#123;&#125;;with (obj) &#123; let newa = a; let newb = b; console.log(newa + newb);&#125;// ç­‰ä»·äºlet newa = obj.a;let newb = obj.b;console.log(newa + newb); with çš„ ä¼˜ç‚¹ï¼šå½“ with ä¼ å…¥çš„å€¼éå¸¸å¤æ‚æ—¶ï¼Œå³å½“ object ä¸ºéå¸¸å¤æ‚çš„åµŒå¥—ç»“æ„æ—¶ï¼Œwith å°±ä½¿å¾—ä»£ç æ˜¾å¾—éå¸¸ç®€æ´ã€‚with çš„ç¼ºç‚¹ï¼šjs çš„ç¼–è¯‘å™¨ä¼šæ£€æµ‹ with å—ä¸­çš„å˜é‡æ˜¯å¦å±äº with ä¼ å…¥çš„å¯¹è±¡ï¼Œ ä¸Šè¿°ä¾‹å­ä¸ºä¾‹ï¼Œjs ä¼šæ£€æµ‹ a å’Œ b æ˜¯å¦å±äº obj å¯¹è±¡ï¼Œè¿™æ ·å°±ä¼šçš„å¯¼è‡´ with è¯­å¥çš„æ‰§è¡Œé€Ÿåº¦å¤§å¤§ä¸‹é™ï¼Œæ€§èƒ½æ¯”è¾ƒå·®ã€‚ å›å½’æ­£é¢˜ï¼Œæˆ‘ä»¬ä¸¾ä¸ªä¾‹å­çœ‹ä¸€ä¸‹ Symbol.unscopables å±æ€§çš„ä½œç”¨ã€‚ 12345678910111213141516171819202122let obj = &#123; foo() &#123; return 1; &#125;,&#125;;with (obj) &#123; foo(); // 1&#125;// è®¾ç½®äº†Symbol.unscopableslet obj = &#123; foo() &#123; return 1; &#125;, get [Symbol.unscopables]() &#123; return &#123; foo: true, &#125;; &#125;,&#125;;with (obj) &#123; foo(); // Uncaught ReferenceError: foo is not defined&#125; è®¾ç½®åæŠ¥é”™çš„åŸå› æ˜¯å› ä¸º with å·²ç»å°† obj ä¸­çš„ foo æ–¹æ³•åˆ é™¤äº†ã€‚ æ­¤æ¬¡ä¹Ÿæ˜¯å¯¹ Symbol æœ‰äº†ä¸ªé‡æ–°çš„è®¤è¯†ï¼Œä¹Ÿå¸Œæœ›å¯¹ä½ æœ‰æ‰€å¸®åŠ©ã€‚ç‚¹ä¸ªèµå§ï¼ğŸ’¥ğŸ§¡ğŸ’–","categories":[{"name":"ES6","slug":"ES6","permalink":"https://tomatoesman.github.io/categories/ES6/"}],"tags":[{"name":"ES6","slug":"ES6","permalink":"https://tomatoesman.github.io/tags/ES6/"}]},{"title":"Setå’ŒMap","slug":"Setå’ŒMap","date":"2020-07-09T14:09:11.000Z","updated":"2020-07-09T14:11:41.461Z","comments":true,"path":"2020/07/09/Setå’ŒMap/","link":"","permalink":"https://tomatoesman.github.io/2020/07/09/Set%E5%92%8CMap/","excerpt":"ES6 æ–°å¢äº†ä¸¤ä¸ªæ•°æ®ç»“æ„ï¼Œä¸€ä¸ªæ˜¯ setï¼Œå¦å¤–ä¸€ä¸ªæ˜¯ mapã€‚ 1ã€setåœ¨ã€Šä½ ä¸çŸ¥é“çš„ JavaScript(ä¸‹å·)ã€‹ä¸­æ˜¯è¿™ä¹ˆå®šä¹‰çš„ï¼šset æ˜¯ä¸€ä¸ªå€¼çš„é›†åˆï¼Œå…¶ä¸­çš„å€¼å”¯ä¸€ï¼ˆé‡å¤ä¼šè¢«å¿½ç•¥ï¼‰ã€‚å®ƒç±»ä¼¼äºæ•°ç»„ï¼Œä½†æ˜¯æ¯ä¸ªæˆå‘˜çš„å€¼æ˜¯å”¯ä¸€çš„ã€‚","text":"ES6 æ–°å¢äº†ä¸¤ä¸ªæ•°æ®ç»“æ„ï¼Œä¸€ä¸ªæ˜¯ setï¼Œå¦å¤–ä¸€ä¸ªæ˜¯ mapã€‚ 1ã€setåœ¨ã€Šä½ ä¸çŸ¥é“çš„ JavaScript(ä¸‹å·)ã€‹ä¸­æ˜¯è¿™ä¹ˆå®šä¹‰çš„ï¼šset æ˜¯ä¸€ä¸ªå€¼çš„é›†åˆï¼Œå…¶ä¸­çš„å€¼å”¯ä¸€ï¼ˆé‡å¤ä¼šè¢«å¿½ç•¥ï¼‰ã€‚å®ƒç±»ä¼¼äºæ•°ç»„ï¼Œä½†æ˜¯æ¯ä¸ªæˆå‘˜çš„å€¼æ˜¯å”¯ä¸€çš„ã€‚ set æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œå¯ä»¥é€šè¿‡ new æ¥åˆ›å»ºä¸€ä¸ª set å®ä¾‹ã€‚ 12let set = new Set([1, 2, 3, 1, 4]);console.log(set); // &#123;1, 2, 3, 4&#125; ä¸Šè¿°å¯ä»¥çœ‹å‡ºï¼Œnew Set ä¼šè‡ªåŠ¨è¿‡æ»¤æ‰é‡å¤å€¼ï¼Œå¹¶è¿”å›ä¸€ä¸ªé›†åˆï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªç‰¹æ€§ï¼Œæ¥å†™å‡ºç®€å•çš„æ•°ç»„å»é‡ã€‚ 123let set = new Set([1, 2, 3, 1, 4]);let arr = [...set];console.log(arr); // [1, 2, 3, 4] set é€šè¿‡ add()æ¥å¢åŠ æˆå‘˜ï¼Œå°†æ–°å€¼æ”¾åœ¨é›†åˆå°¾éƒ¨ï¼Œå¦‚æœæ–°å€¼è·ŸåŸé›†åˆä¸­çš„æˆå‘˜é‡å¤çš„è¯ï¼Œä¼šè¢«è‡ªåŠ¨è¿‡æ»¤æ‰ã€‚ 123456let set = new Set([1, 2, 3, 1, 4]);set.add(1);console.log(set); // &#123;1, 2, 3, 4&#125;let set = new Set([1, 2, 3, 1, 4]);set.add(0);console.log(set); // &#123;1, 2, 3, 4, 0&#125; Set çš„æ„é€ å‡½æ•°å¯ä»¥æ¥å—ä¸€ä¸ªå…·æœ‰ Iterable æ¥å£çš„å…¶ä»–æ•°æ®ç»“æ„ä½œä¸ºå‚æ•°ã€‚ 123456789// ä¾‹1let set = new Set(\"string\");console.log(set); // &#123;\"s\", \"t\", \"r\", \"i\", \"n\", \"g\"&#125;// ä¾‹2function foo(a, b) &#123; let set = new Set(arguments); console.log(set); // &#123;1, 2&#125;&#125;foo(1, 2); 2ã€set çš„ APIset çš„å®ä¾‹å±æ€§æœ‰ä¸¤ä¸ªï¼š Set.prototype.constructorï¼šæ„é€ å‡½æ•°ï¼Œé»˜è®¤å°±æ˜¯ Set å‡½æ•°ã€‚ Set.prototype.sizeï¼š è¿”å› Set å¯¹è±¡ä¸­çš„å€¼çš„ä¸ªæ•°ã€‚ å®ä¾‹æ–¹æ³•åˆ†ä¸ºä¸¤ç±»ï¼Œä¸€ä¸ªæ˜¯æ“ä½œç±»ï¼Œä¸€ä¸ªæ˜¯éå†ç±»ã€‚æ“ä½œç±»ï¼š Set.prototype.add(value)ï¼šåœ¨ Set å¯¹è±¡å°¾éƒ¨æ·»åŠ ä¸€ä¸ªå…ƒç´ ã€‚è¿”å›è¯¥ Set å¯¹è±¡ã€‚ Set.prototype.clear()ï¼šç§»é™¤ Set å¯¹è±¡å†…çš„æ‰€æœ‰å…ƒç´ ã€‚ Set.prototype.delete(value)ï¼šç§»é™¤ Set çš„ä¸­ä¸è¿™ä¸ªå€¼ç›¸ç­‰çš„å…ƒç´ ï¼Œè¿”å› Set.prototype.has(value)åœ¨è¿™ä¸ªæ“ä½œå‰ä¼šè¿”å›çš„å€¼ï¼ˆå³å¦‚æœè¯¥å…ƒç´ å­˜åœ¨ï¼Œè¿”å› trueï¼Œå¦åˆ™è¿”å› falseï¼‰ã€‚Set.prototype.has(value)åœ¨æ­¤åä¼šè¿”å› falseã€‚ Set.prototype.has(value)ï¼šè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºè¯¥å€¼åœ¨ Set ä¸­å­˜åœ¨ä¸å¦ã€‚ 12345678910111213// ä¾‹1let set = new Set([1, 2, 3]);set.clear();console.log(set); // &#123;&#125;// ä¾‹2let set = new Set([1, 2, 3]);let result = set.delete(1);console.log(result); // trueconsole.log(set); // &#123;2, 3&#125;// ä¾‹3let set = new Set([1, 2, 3]);let result = set.has(1);console.log(result); // true éå†ç±»ï¼š Set.prototype.values()ï¼šè¿”å›ä¸€ä¸ªæ–°çš„è¿­ä»£å™¨å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åŒ…å« Set å¯¹è±¡ä¸­çš„æŒ‰æ’å…¥é¡ºåºæ’åˆ—çš„æ‰€æœ‰å…ƒç´ çš„å€¼ã€‚ Set.prototype.keys()ï¼šä¸ values()æ–¹æ³•ç›¸åŒï¼Œè¿”å›ä¸€ä¸ªæ–°çš„è¿­ä»£å™¨å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åŒ…å« Set å¯¹è±¡ä¸­çš„æŒ‰æ’å…¥é¡ºåºæ’åˆ—çš„æ‰€æœ‰å…ƒç´ çš„å€¼ã€‚ Set.prototype.forEach(callbackFn[, thisArg])ï¼šæŒ‰ç…§æ’å…¥é¡ºåºï¼Œä¸º Set å¯¹è±¡ä¸­çš„æ¯ä¸€ä¸ªå€¼è°ƒç”¨ä¸€æ¬¡ callBackFnã€‚å¦‚æœæä¾›äº† thisArg å‚æ•°ï¼Œå›è°ƒä¸­çš„ this ä¼šæ˜¯è¿™ä¸ªå‚æ•°ã€‚ Set.prototype.entries()ï¼šè¿”å›ä¸€ä¸ªæ–°çš„è¿­ä»£å™¨å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åŒ…å« Set å¯¹è±¡ä¸­çš„æŒ‰æ’å…¥é¡ºåºæ’åˆ—çš„æ‰€æœ‰å…ƒç´ çš„å€¼çš„[value, value]æ•°ç»„ã€‚ä¸ºäº†ä½¿è¿™ä¸ªæ–¹æ³•å’Œ Map å¯¹è±¡ä¿æŒç›¸ä¼¼ï¼Œæ¯ä¸ªå€¼çš„é”®å’Œå€¼ç›¸ç­‰ã€‚ 12345678// ä¾‹1let set = new Set([1, 2, 3]);let keys = set.keys();console.log(keys); // &#123;1, 2, 3&#125;// ä¾‹2let set = new Set([1, 2, 3]);let values = set.values();console.log(values); // &#123;1, 2, 3&#125; ä¸Šè¿°ä¸¤ä¸ªä¾‹å­ï¼Œå› ä¸º Sset æ²¡æœ‰é”®åï¼Œåªæœ‰å€¼ï¼Œæ‰€ä»¥ keys å’Œ values çš„ç»“æœæ˜¯ä¸€æ ·çš„ã€‚Set åŒæ ·æ‹¥æœ‰ forEach æ–¹æ³•ï¼š 1234567let set = new Set([1, 2, 3]);set.forEach((key, value) =&gt; &#123; console.log(`$&#123;key&#125;:$&#123;value&#125;`);&#125;);// 1:1// 2:2// 3:3 è·Ÿæ•°ç»„çš„ forEach æ–¹æ³•ä¸åŒçš„æ˜¯ï¼Œå®ƒçš„å›è°ƒå‡½æ•°çš„å‚æ•°æ˜¯å…¶ key å€¼å’Œ value å€¼ï¼Œä½†æ˜¯ Set æ²¡æœ‰ key å€¼ï¼Œæ‰€ä»¥å…¶ key å’Œ value ç›¸ç­‰ã€‚forEach çš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯ this å€¼ï¼Œå…¶ç»‘å®šçš„æ˜¯å›è°ƒå‡½æ•°ä¸­çš„ this å€¼ã€‚æœ€åä¸€ä¸ªå®ä¾‹æ–¹æ³•æ˜¯ entriesï¼š 12345678let set = new Set([1, 2, 3]);let entries = set.entries();console.log(entries);// &#123;// [1, 1],// [2, 2],// [3, 3]// &#125; enteries()è¿”å›ä¸€ä¸ªéå†å™¨ï¼Œè¿”å›ä¸€ä¸ªé”®å€¼å¯¹ï¼Œä½†å…¶é”®å€¼å¯¹å‡ç›¸ç­‰ã€‚ 3ã€WeakSetWeakSet ä¹Ÿæ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œä¸ Set ä¸€ç›´ï¼ŒWeakSet å’Œ Set ä¸¤è€…ç›¸ä¼¼ä½†ä¸åŒï¼Œä¸åŒç‚¹ä¸»è¦æœ‰ä¸¤ä¸ªï¼š WeakSet çš„æˆå‘˜å€¼å¿…é¡»æ˜¯å¯¹è±¡ï¼ˆå¯è¿­ä»£çš„å¯¹è±¡ï¼‰ï¼Œè€Œå¹¶ä¸åƒ set ä¸€æ ·å¯ä»¥æ˜¯åŸç”Ÿç±»å‹å€¼ã€‚ WeakSet æŒå¼±å¼•ç”¨ï¼šé›†åˆä¸­å¯¹è±¡çš„å¼•ç”¨ä¸ºå¼±å¼•ç”¨ã€‚å¦‚æœæ²¡æœ‰å…¶ä»–çš„å¯¹ WeakSet ä¸­å¯¹è±¡çš„å¼•ç”¨ï¼Œé‚£ä¹ˆè¿™äº›å¯¹è±¡ä¼šè¢«å½“æˆåƒåœ¾å›æ”¶æ‰ã€‚è¿™ä¹Ÿæ„å‘³ç€ WeakSet ä¸­æ²¡æœ‰å­˜å‚¨å½“å‰å¯¹è±¡çš„åˆ—è¡¨ã€‚æ­£å› ä¸ºè¿™æ ·ï¼ŒWeakSet æ˜¯ä¸å¯æšä¸¾çš„ã€‚ 12345let weakSet = new WeakSet([1, 2]); // Uncaught TypeError: Invalid value used in weak setlet weakSet = new WeakSet([ [1, 2], [3, 4],]); // &#123;[1, 2], [3, 4]&#125; WeakSet æœ‰ä¸‰ä¸ªå®ä¾‹æ–¹æ³•ï¼š WeakSet.prototype.add(value)ï¼šè¿”å›æ„é€ å‡½æ•°å³ WeakSet æœ¬èº«ã€‚ WeakSet.prototype.delete(value)ï¼šä»è¯¥ WeakSet å¯¹è±¡ä¸­åˆ é™¤ value è¿™ä¸ªå…ƒç´ , ä¹‹å WeakSet.prototype.has(value) æ–¹æ³•ä¾¿ä¼šè¿”å› falseã€‚ WeakSet.prototype.has(value)ï¼šè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼, è¡¨ç¤ºç»™å®šçš„å€¼ value æ˜¯å¦å­˜åœ¨äºè¿™ä¸ª WeakSet ä¸­ã€‚ 12345678910111213var ws = new WeakSet();var foo = &#123;&#125;;var bar = &#123;&#125;;ws.add(foo);ws.add(bar);ws.has(foo); // truews.has(bar); // truews.delete(foo); // ä»setä¸­åˆ é™¤ foo å¯¹è±¡ws.has(foo); // false, foo å¯¹è±¡å·²ç»è¢«åˆ é™¤äº†ws.has(bar); // true, bar ä¾ç„¶å­˜åœ¨ 4ã€Mapåœ¨ JS ä¸­å¯¹è±¡æ˜¯åˆ›å»ºæ— åºé”® / å€¼å¯¹æ•°æ®ç»“æ„ [ ä¹Ÿç§°ä¸º æ˜ å°„ï¼ˆmapï¼‰] çš„ä¸»è¦æœºåˆ¶ã€‚ä½†æ˜¯ï¼Œå¯¹è±¡ä½œä¸ºæ˜ å°„çš„ä¸»è¦ç¼ºç‚¹æ˜¯ä¸èƒ½ä½¿ç”¨éå­—ç¬¦ä¸²å€¼ä½œä¸ºé”®ã€‚æ‰€ä»¥åœ¨ ES6 æå‡ºä¸€ä¸ªæ–°çš„æ•°æ®ç»“æ„ï¼ŒMapã€‚Map å’Œå¯¹è±¡å¾ˆç±»ä¼¼ï¼Œéƒ½æ˜¯é”®å€¼å¯¹çš„å½¢å¼ï¼Œä½†æ˜¯ Map çš„é”®å¯ä»¥æ˜¯ä»»æ„ç±»å‹(å¯¹è±¡æˆ–è€…åŸå§‹å€¼)ï¼ŒNaN ä¹Ÿå¯ä»¥ä½œä¸ºé”®ï¼Œä¸å†åªå±€é™äºå­—ç¬¦ä¸²ã€‚ä»»ä½•å…·æœ‰ Iterator æ¥å£ã€ä¸”æ¯ä¸ªæˆå‘˜éƒ½æ˜¯ä¸€ä¸ªåŒå…ƒç´ çš„æ•°ç»„çš„æ•°æ®ç»“æ„éƒ½å¯ä»¥å½“ä½œ Map æ„é€ å‡½æ•°çš„å‚æ•°ã€‚ 12let map = new Map([[&#123; a: 1 &#125;, 3]]);console.log(map); // &#123;&#123;a:1&#125;: 3&#125; åœ¨ MDN ä¸­æ¸…æ™°çš„åˆ—å‡ºäº† Map å’Œ Object é—´çš„ä¸åŒï¼š Map Object æ„å¤–çš„é”® Map é»˜è®¤æƒ…å†µä¸åŒ…å«ä»»ä½•é”®ã€‚åªåŒ…å«æ˜¾å¼æ’å…¥çš„é”®ã€‚ ä¸€ä¸ª Object æœ‰ä¸€ä¸ªåŸå‹, åŸå‹é“¾ä¸Šçš„é”®åæœ‰å¯èƒ½å’Œä½ è‡ªå·±åœ¨å¯¹è±¡ä¸Šçš„è®¾ç½®çš„é”®åäº§ç”Ÿå†²çªã€‚æ³¨æ„: è™½ç„¶ ES5 å¼€å§‹å¯ä»¥ç”¨ Object.create(null) æ¥åˆ›å»ºä¸€ä¸ªæ²¡æœ‰åŸå‹çš„å¯¹è±¡ï¼Œä½†æ˜¯è¿™ç§ç”¨æ³•ä¸å¤ªå¸¸è§ã€‚ é”®çš„ç±»å‹ ä¸€ä¸ª Map çš„é”®å¯ä»¥æ˜¯ä»»æ„å€¼ï¼ŒåŒ…æ‹¬å‡½æ•°ã€å¯¹è±¡æˆ–ä»»æ„åŸºæœ¬ç±»å‹ã€‚ ä¸€ä¸ª Object çš„é”®å¿…é¡»æ˜¯ä¸€ä¸ª String æˆ–æ˜¯ Symbolã€‚ é”®çš„é¡ºåº Map ä¸­çš„ key æ˜¯æœ‰åºçš„ã€‚å› æ­¤ï¼Œå½“è¿­ä»£çš„æ—¶å€™ï¼Œä¸€ä¸ª Map å¯¹è±¡ä»¥æ’å…¥çš„é¡ºåºè¿”å›é”®å€¼ã€‚ ä¸€ä¸ª Object çš„é”®æ˜¯æ— åºçš„ã€‚æ³¨æ„ï¼šè‡ª ECMAScript 2015 è§„èŒƒä»¥æ¥ï¼Œå¯¹è±¡ç¡®å®ä¿ç•™äº†å­—ç¬¦ä¸²å’Œ Symbol é”®çš„åˆ›å»ºé¡ºåºï¼› å› æ­¤ï¼Œåœ¨åªæœ‰å­—ç¬¦ä¸²é”®çš„å¯¹è±¡ä¸Šè¿›è¡Œè¿­ä»£å°†æŒ‰æ’å…¥é¡ºåºäº§ç”Ÿé”®ã€‚ Size Map çš„é”®å€¼å¯¹ä¸ªæ•°å¯ä»¥è½»æ˜“åœ°é€šè¿‡ size å±æ€§è·å– Object çš„é”®å€¼å¯¹ä¸ªæ•°åªèƒ½æ‰‹åŠ¨è®¡ç®— è¿­ä»£ Map æ˜¯ iterable çš„ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥è¢«è¿­ä»£ã€‚ è¿­ä»£ä¸€ä¸ª Object éœ€è¦ä»¥æŸç§æ–¹å¼è·å–å®ƒçš„é”®ç„¶åæ‰èƒ½è¿­ä»£ã€‚ æ€§èƒ½ åœ¨é¢‘ç¹å¢åˆ é”®å€¼å¯¹çš„åœºæ™¯ä¸‹è¡¨ç°æ›´å¥½ã€‚ åœ¨é¢‘ç¹æ·»åŠ å’Œåˆ é™¤é”®å€¼å¯¹çš„åœºæ™¯ä¸‹æœªä½œå‡ºä¼˜åŒ–ã€‚ 5ã€Map çš„ APIMap çš„å®ä¾‹å±æ€§æœ‰ä¸¤ä¸ªï¼š Map.prototype.constructorï¼šè¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒåˆ›å»ºäº†å®ä¾‹çš„åŸå‹ã€‚é»˜è®¤æ˜¯ Map å‡½æ•°ã€‚ Map.prototype.sizeï¼š è¿”å› Map å¯¹è±¡çš„é”®/å€¼å¯¹çš„æ•°é‡ã€‚ å®ä¾‹æ–¹æ³•åˆ†ä¸ºä¸¤ç±»ï¼Œä¸€ä¸ªæ˜¯æ“ä½œç±»ï¼Œä¸€ä¸ªæ˜¯éå†ç±»ã€‚æ“ä½œç±»ï¼š Map.prototype.set(key, value)ï¼šè®¾ç½® Map å¯¹è±¡ä¸­é”®çš„å€¼ã€‚è¿”å›è¯¥ Map å¯¹è±¡ã€‚ Map.prototype.get(key)ï¼šè¿”å›é”®å¯¹åº”çš„å€¼ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™è¿”å› undefinedã€‚ Map.prototype.has(key)ï¼šè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤º Map å®ä¾‹æ˜¯å¦åŒ…å«é”®å¯¹åº”çš„å€¼ã€‚ Map.prototype.delete(key)ï¼šå¦‚æœ Map å¯¹è±¡ä¸­å­˜åœ¨è¯¥å…ƒç´ ï¼Œåˆ™ç§»é™¤å®ƒå¹¶è¿”å› trueï¼›å¦åˆ™å¦‚æœè¯¥å…ƒç´ ä¸å­˜åœ¨åˆ™è¿”å› falseã€‚éšåè°ƒç”¨ Map.prototype.has(key) å°†è¿”å› false ã€‚ Map.prototype.clear()ï¼šç§»é™¤ Map å¯¹è±¡çš„æ‰€æœ‰é”®/å€¼å¯¹ã€‚ 123456789let map = new Map();let key = &#123; name: \"Jack\" &#125;;let value = \"å•¥\";map.set(key, value); // &#123;&#123;name: 'Jack'&#125;: 'å•¥'&#125;map.get(key); // 'å•¥'map.get(a); // undefinedmap.has(key); // truemap.delete(key); // truemap.clear(); // &#123;&#125; éå†ç±»ï¼š Map.prototype.entries()ï¼šè¿”å›ä¸€ä¸ªæ–°çš„ Iterator å¯¹è±¡ï¼Œå®ƒæŒ‰æ’å…¥é¡ºåºåŒ…å«äº† Map å¯¹è±¡ä¸­æ¯ä¸ªå…ƒç´ çš„ [key, value] æ•°ç»„ã€‚ Map.prototype.forEach(callbackFn[, thisArg])ï¼šæŒ‰æ’å…¥é¡ºåºï¼Œä¸º Map å¯¹è±¡é‡Œçš„æ¯ä¸€é”®å€¼å¯¹è°ƒç”¨ä¸€æ¬¡ callbackFn å‡½æ•°ã€‚å¦‚æœä¸º forEach æä¾›äº† thisArgï¼Œå®ƒå°†åœ¨æ¯æ¬¡å›è°ƒä¸­ä½œä¸º this å€¼ã€‚ Map.prototype.keys()ï¼šè¿”å›ä¸€ä¸ªæ–°çš„ Iterator å¯¹è±¡ï¼Œ å®ƒæŒ‰æ’å…¥é¡ºåºåŒ…å«äº† Map å¯¹è±¡ä¸­æ¯ä¸ªå…ƒç´ çš„é”® ã€‚ Map.prototype.values()ï¼šè¿”å›ä¸€ä¸ªæ–°çš„ Iterator å¯¹è±¡ï¼Œå®ƒæŒ‰æ’å…¥é¡ºåºåŒ…å«äº† Map å¯¹è±¡ä¸­æ¯ä¸ªå…ƒç´ çš„å€¼ ã€‚ 1234567891011121314151617181920let map = new Map([ [\"name\", \"Jack\"], [&#123; age: 25 &#125;, \"å•¥\"],]);map.entries(); // MapIterator &#123;\"name\" =&gt; \"Jack\", &#123;age: 25&#125; =&gt; \"å•¥\"&#125;for (let item of map.entries()) &#123; console.log(item); // [\"name\", \"Jack\"] [&#123;age: 25&#125;, \"å•¥\"]&#125;map.forEach((value, key, map) =&gt; &#123; console.log(value, key, map); // Jack name Map(2) &#123;\"name\" =&gt; \"Jack\", &#123;age: 25&#125; =&gt; \"å•¥\"&#125; //\"å•¥\"&#123;age: 25&#125; Map(2) &#123;\"name\" =&gt; \"Jack\", &#123;age: 25&#125; =&gt; \"å•¥\"&#125;&#125;);map.keys(); // MapIterator &#123;\"name\", &#123;age: 25&#125;&#125;for (let item of map.keys()) &#123; console.log(item); // \"name\" &#123;age: 25&#125;&#125;map.values(); // MapIterator &#123;\"Jack\", \"å•¥\"&#125;for (let item of map.values()) &#123; console.log(item); // \"Jack\" \"å•¥\"&#125; 6ã€Map å’Œå…¶ä»–æ•°æ®ç»“æ„çš„è½¬æ¢6.1ã€Map è½¬æ•°ç»„ES6 ç»™å‡ºä¸€ä¸ªæœ€ç®€å•çš„æ–¹å¼ï¼Œæ‰©å±•è¿ç®—ç¬¦ã€‚ 12345let map = new Map([ [\"name\", \"Jack\"], [&#123; age: 25 &#125;, \"å•¥\"],]);console.log([...map]); // [['name', 'Jack'], [&#123;age: 25&#125;, 'å•¥']] é™¤æ­¤ä¹‹å¤–è¿˜å¯ä»¥ç”¨ Array.from()ã€‚ 12345let map = new Map([ [\"name\", \"Jack\"], [&#123; age: 25 &#125;, \"å•¥\"],]);console.log(Array.from(map)); // [['name', 'Jack'], [&#123;age: 25&#125;, 'å•¥']] 6.2ã€Map è½¬å¯¹è±¡å¦‚æœæ‰€æœ‰ Map çš„é”®éƒ½æ˜¯å­—ç¬¦ä¸²ï¼Œå®ƒå¯ä»¥æ— æŸåœ°è½¬ä¸ºå¯¹è±¡ã€‚ 1234567891011function strMapToObj(strMap) &#123; let obj = Object.create(null); for (let [k, v] of strMap) &#123; obj[k] = v; &#125; return obj;&#125;const myMap = new Map().set(\"yes\", true).set(\"no\", false);strMapToObj(myMap);// &#123; yes: true, no: false &#125; 6.3 Map è½¬ JSONMap è½¬ JSON æœ‰ä¸¤ä¸ªå½¢å¼ï¼Œç¬¬ä¸€ç§æ˜¯é”®åéƒ½æ˜¯å­—ç¬¦ä¸²çš„ç±»å‹çš„ï¼Œç¬¬äºŒç§æ˜¯é”®åä¸­åŒ…å«éå­—ç¬¦ä¸²ç±»å‹ã€‚ç¬¬ä¸€ç§çš„è¯ç›´æ¥å°† map è½¬ä¸ºå¯¹è±¡ï¼Œç„¶åå†ç”¨ JSON.Stringfy()è¿›è¡Œè½¬æ¢ã€‚ç¬¬äºŒç§çš„è¯å¯ä»¥è½¬æˆæ•°ç»„ JSONã€‚ 1234567function mapToArrayJson(map) &#123; return JSON.stringify([...map]);&#125;let myMap = new Map().set(true, 7).set(&#123; foo: 3 &#125;, [\"abc\"]);mapToArrayJson(myMap);// '[[true,7],[&#123;\"foo\":3&#125;,[\"abc\"]]]' 7ã€WeakMapWeakMap å’Œ WeakSet æœ‰äº›ç±»ä¼¼ï¼Œéƒ½æ˜¯å¼±å¼•ç”¨ï¼Œå¹¶ä¸”æˆå‘˜å€¼çš„é”®å¿…é¡»æ˜¯å¯¹è±¡ã€‚ 12let weakMap = new WeakMap([[1, 3]]); // Uncaught TypeError: Invalid value used as weak map keylet weakMap = new WeakMap([[&#123; name: \"Jack\" &#125;, 3]]); // &#123;&#123;name: 'Jack'&#125;: 3&#125; WeakMap æœ‰å››ä¸ªå®ä¾‹æ–¹æ³•ï¼š WeakMap.prototype.delete(key)ï¼šç§»é™¤ key çš„å…³è”å¯¹è±¡ã€‚æ‰§è¡Œå WeakMap.prototype.has(key)è¿”å› falseã€‚ WeakMap.prototype.get(key)ï¼šè¿”å› key å…³è”å¯¹è±¡, æˆ–è€… undefined(æ²¡æœ‰ key å…³è”å¯¹è±¡æ—¶)ã€‚ WeakMap.prototype.has(key)ï¼šæ ¹æ®æ˜¯å¦æœ‰ key å…³è”å¯¹è±¡è¿”å›ä¸€ä¸ª Boolean å€¼ã€‚ WeakMap.prototype.set(key, value)ï¼šåœ¨ WeakMap ä¸­è®¾ç½®ä¸€ç»„ key å…³è”å¯¹è±¡ï¼Œè¿”å›è¿™ä¸ª WeakMap å¯¹è±¡ã€‚ 123456let weakMap = new WeakMap();let obj = &#123; name: \"Jack\" &#125;;weakMap.set(obj, 3); // &#123;&#123;name: 'Jack': 3&#125;&#125;weakMap.get(obj); // 3weakMap.has(obj); // trueweakMap.delete(obj); // true å‚è€ƒï¼š Set å’Œ Map æ•°æ®ç»“æ„","categories":[{"name":"ES6","slug":"ES6","permalink":"https://tomatoesman.github.io/categories/ES6/"}],"tags":[{"name":"ES6","slug":"ES6","permalink":"https://tomatoesman.github.io/tags/ES6/"}]},{"title":"Asyncå’ŒAwait","slug":"Asyncå’ŒAwait","date":"2020-07-06T14:14:10.000Z","updated":"2020-07-06T14:16:04.669Z","comments":true,"path":"2020/07/06/Asyncå’ŒAwait/","link":"","permalink":"https://tomatoesman.github.io/2020/07/06/Async%E5%92%8CAwait/","excerpt":"async æ˜¯ ES7 æå‡ºçš„æ–°ç‰¹æ€§ï¼Œè¯´ç™½äº†å°±æ˜¯ Generator çš„è¯­æ³•ç³–ã€‚æ—¢ç„¶æ˜¯è¯­æ³•ç³–ï¼Œé‚£æˆ‘ä»¬é¦–å…ˆè¯´ä¸€ä¸‹å®ƒçš„æ”¹è¿›ä¹‹å¤„ã€‚ 1ã€async å¯¹ Generator çš„æ”¹è¿›","text":"async æ˜¯ ES7 æå‡ºçš„æ–°ç‰¹æ€§ï¼Œè¯´ç™½äº†å°±æ˜¯ Generator çš„è¯­æ³•ç³–ã€‚æ—¢ç„¶æ˜¯è¯­æ³•ç³–ï¼Œé‚£æˆ‘ä»¬é¦–å…ˆè¯´ä¸€ä¸‹å®ƒçš„æ”¹è¿›ä¹‹å¤„ã€‚ 1ã€async å¯¹ Generator çš„æ”¹è¿› 1.1ã€å†™æ³•æ”¹è¿›12345678Generatorå‡½æ•°;function* foo() &#123; yield \"b\";&#125;Asyncå‡½æ•°;async function foo() &#123; await \"b\";&#125; å¯¹æ¯”å‘ç°ï¼Œasync å‡½æ•°åœ¨å†™æ³•ä¸Šï¼Œæ˜¯å°† Generator å‡½æ•°çš„æ˜Ÿå·æ¢æˆäº† async å…³é”®è¯ï¼Œyield å…³é”®è¯æ¢æˆäº† awaitã€‚ 1.2ã€ å†…ç½®æ‰§è¡Œå™¨Generator å‡½æ•°çš„æ‰§è¡Œå¿…é¡»ä¾é æ‰§è¡Œå™¨ï¼Œè€Œ async å‡½æ•°è‡ªå¸¦æ‰§è¡Œå™¨ã€‚æ‰€ä»¥ async å‡½æ•°ä¸ç”¨åƒ Generator å‡½æ•°ä¸€æ ·è¦ç”¨ next æ–¹æ³•æ‰ä¼šæ‰§è¡Œï¼Œå®Œå…¨å¯ä»¥è·Ÿæ™®é€šå‡½æ•°ä¸€æ ·ã€‚ 1.3ã€ æ›´å¥½çš„å®ç”¨æ€§co æ¨¡å—çº¦å®šï¼Œyield å‘½ä»¤åé¢åªèƒ½æ˜¯ Thunk å‡½æ•°æˆ– Promise å¯¹è±¡ï¼Œè€Œ async å‡½æ•°çš„ await å‘½ä»¤åé¢ï¼Œå¯ä»¥æ˜¯ Promise å¯¹è±¡å’ŒåŸå§‹ç±»å‹çš„å€¼ï¼ˆæ•°å€¼ã€å­—ç¬¦ä¸²å’Œå¸ƒå°”å€¼ï¼Œä½†è¿™æ—¶ä¼šè‡ªåŠ¨è½¬æˆç«‹å³ resolved çš„ Promise å¯¹è±¡ï¼‰ã€‚ 1.4ã€ è¿”å›å€¼ä¸º Promiseasync å‡½æ•°è¿”å›çš„æ˜¯ä¸€ä¸ª Promise å¯¹è±¡ï¼Œå¯ä»¥è¯•ç”¨ then æ–¹æ³•ï¼Œä¸åƒ Generator å‡½æ•°è¿”å›çš„æ˜¯ä¸€ä¸ª Iterator å¯¹è±¡ã€‚ 2ã€async åŸºæœ¬ç”¨æ³•async å‡½æ•°è¿”å›ä¸€ä¸ª Promise å¯¹è±¡ï¼Œå¯ä»¥ä½¿ç”¨ then æ–¹æ³•æ·»åŠ å›è°ƒå‡½æ•°ã€‚å½“å‡½æ•°æ‰§è¡Œçš„æ—¶å€™ï¼Œä¸€æ—¦é‡åˆ° await å°±ä¼šå…ˆè¿”å›ï¼Œç­‰åˆ°å¼‚æ­¥æ“ä½œå®Œæˆï¼Œå†æ¥ç€æ‰§è¡Œå‡½æ•°ä½“å†…åé¢çš„è¯­å¥ï¼Œå¹¶ä¸” await å¿…é¡»è¦åœ¨ async å‡½æ•°ä¸­ï¼Œä¸ç„¶å°±ä¼šæŠ¥é”™ã€‚ 12345async function foo() &#123; let result = await \"b\"; return result;&#125;foo().then((value) =&gt; console.log(value)); // 6 ä¸Šè¿°å¯ä»¥çœ‹å‡ºï¼Œasync å‡½æ•°ä¸­ return è¯­å¥è¿”å›çš„å€¼ï¼Œä¼šæˆä¸º then å›è°ƒå‡½æ•°çš„å‚æ•°ã€‚å½“ async å‡½æ•°ä¸­æŠ›å‡ºé”™è¯¯æ—¶ï¼Œä¼šä½œä¸º catch å‡½æ•°çš„å‚æ•°ä¼ å…¥ã€‚ 1234async function foo() &#123; throw new Error(\"å‡ºé”™\");&#125;foo().catch((err) =&gt; console.log(err)); // Error: å‡ºé”™ 3ã€await è¡¨è¾¾å¼é€šå¸¸æ¥è¯´ await åè¾¹å¤§éƒ¨åˆ†éƒ½æ˜¯ Promise å¯¹è±¡ï¼Œå½“æ—¶ Promise å¯¹è±¡æ—¶ï¼Œè¿”å›çš„æ˜¯ Promise å¯¹è±¡ resolved çŠ¶æ€ä¸‹çš„ç»“æœï¼Œå¦‚æœæ˜¯åŸºæœ¬æ•°æ®ç±»å‹æ—¶ï¼Œå°±æ˜¯ç›´æ¥è¿”å›è¯¥ç»“æœã€‚ 12345async function foo() &#123; let result = await new Promise((resolve) =&gt; resolve(1)); return result;&#125;foo().then((value) =&gt; console.log(value)); // 1 å½“ await åè¾¹æ˜¯ä¸€ä¸ª thenable å¯¹è±¡æ˜¯ï¼Œä¼šè¢«å½“åšæ˜¯ Promise å¯¹è±¡ä¸€æ ·å¤„ç†ã€‚ 123456789let thenable = &#123; name: \"Jack\", then: (resolve) =&gt; resolve(\"2\"),&#125;;async function foo() &#123; let result = await thenable; return result;&#125;foo().then((value) =&gt; console.log(value)); // 2 await åé¢çš„ Promise å¯¹è±¡å‡ºç°é”™è¯¯æ—¶ï¼š 1234567async function foo() &#123; await Promise.reject(\"å‡ºé”™äº†\"); await Promise.resolve(\"1\");&#125;foo() .then((value) =&gt; console.log(value)) .catch((err) =&gt; console.log(err)); // å‡ºé”™äº† å½“æœ‰å¤šä¸ª await æ—¶ï¼Œåªè¦å…¶ä¸­ä¸€ä¸ª await åçš„ Promise æŠ¥é”™ï¼Œé‚£è¯¥è¡¨è¾¾å¼ä¹‹åçš„æ‰€æœ‰è¯­å¥å°†ä¸å†æ‰§è¡Œã€‚å¦‚æœæƒ³è¦æ‰§è¡Œä¹‹åçš„è¯­å¥çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨ tryâ€¦catchâ€¦ 1234567891011async function foo() &#123; try &#123; await Promise.reject(\"å‡ºé”™äº†\"); &#125; catch (err) &#123; console.log(err); // å‡ºé”™äº† &#125; return await Promise.resolve(\"1\");&#125;foo() .then((value) =&gt; console.log(value)) // 1 .catch((err) =&gt; console.log(err)); é™¤æ­¤ä¹‹å¤–è¿˜æœ‰ä¸€ç§æ–¹æ³•ï¼š 1234567async function foo() &#123; await Promise.reject(\"å‡ºé”™äº†\").catch((err) =&gt; console.log(err)); // å‡ºé”™äº† return await Promise.resolve(\"1\");&#125;foo() .then((value) =&gt; console.log(value)) // 1 .catch((err) =&gt; console.log(err)); å› ä¸º catch æŠ“çš„æ˜¯å®ƒä¹‹å‰çš„é”™è¯¯ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœæœ‰å¤šä¸ª await æ—¶ï¼Œè¿™å‡ ä¸ª await å¹¶ä¸æ˜¯åŒæ—¶è§¦å‘ï¼Œè€Œæ˜¯ç»§å‘ï¼Œå³ä¸Šä¸€æ¡ await åçš„ Promise æˆåŠŸåå†è§¦å‘ä¸‹ä¸€æ¡ awaitï¼Œå¦‚æœæƒ³åŒæ—¶è§¦å‘çš„è¯ï¼Œå¯é€‰ç”¨ Promise.all æ–¹æ³•ã€‚ 1234567async function foo() &#123; let [a, b] = await Promise.all([ new Promise((resolve) =&gt; resolve(1)), new Promise((resolve) =&gt; resolve(2)), ]); return [a, b];&#125;","categories":[{"name":"ES6","slug":"ES6","permalink":"https://tomatoesman.github.io/categories/ES6/"}],"tags":[{"name":"ES6","slug":"ES6","permalink":"https://tomatoesman.github.io/tags/ES6/"}]},{"title":"Generator","slug":"Generator","date":"2020-07-02T14:17:50.000Z","updated":"2020-07-02T14:24:15.601Z","comments":true,"path":"2020/07/02/Generator/","link":"","permalink":"https://tomatoesman.github.io/2020/07/02/Generator/","excerpt":"Generator æ˜¯ ES6 æå‡ºçš„ä¸€ç§å¼‚æ­¥ç¼–ç¨‹çš„è§£å†³åŠæ³•ï¼Œå®ƒä¸ä¼ ç»Ÿçš„å‡½æ•°å®Œå…¨ä¸åŒï¼Œæœ¬ç« ä»åŸºç¡€æ¦‚å¿µå’ŒåŸºæœ¬ç”¨æ³•è¿›è¡Œè®²è§£å’Œè§£æã€‚åœ¨æ­¤ä¹‹å‰ä¹Ÿæ˜¯å¯¹ Generator å‡½æ•°äº‘é‡Œé›¾é‡Œï¼Œæ‰€ä»¥é€šè¿‡æ­¤æ¬¡å­¦ä¹ ï¼Œå¸Œæœ›èƒ½å¯¹ Generator æœ‰æ›´æ·±çš„ç†è§£å’Œè®¤è¯†ã€‚ 1.æ¦‚å¿µGenerator ä¸­æ–‡çš„æ„æ€æ˜¯â€™ç”Ÿæˆå™¨â€™ï¼Œé˜®ä¸€å³°ï¼šECMAScript 6 å…¥é—¨ä¸­å¯¹ Generator è§£é‡Šæ˜¯ï¼šGenerator å‡½æ•°æœ‰å¤šç§ç†è§£è§’åº¦ã€‚è¯­æ³•ä¸Šï¼Œé¦–å…ˆå¯ä»¥æŠŠå®ƒç†è§£æˆï¼ŒGenerator å‡½æ•°æ˜¯ä¸€ä¸ªçŠ¶æ€æœºï¼Œå°è£…äº†å¤šä¸ªå†…éƒ¨çŠ¶æ€ã€‚","text":"Generator æ˜¯ ES6 æå‡ºçš„ä¸€ç§å¼‚æ­¥ç¼–ç¨‹çš„è§£å†³åŠæ³•ï¼Œå®ƒä¸ä¼ ç»Ÿçš„å‡½æ•°å®Œå…¨ä¸åŒï¼Œæœ¬ç« ä»åŸºç¡€æ¦‚å¿µå’ŒåŸºæœ¬ç”¨æ³•è¿›è¡Œè®²è§£å’Œè§£æã€‚åœ¨æ­¤ä¹‹å‰ä¹Ÿæ˜¯å¯¹ Generator å‡½æ•°äº‘é‡Œé›¾é‡Œï¼Œæ‰€ä»¥é€šè¿‡æ­¤æ¬¡å­¦ä¹ ï¼Œå¸Œæœ›èƒ½å¯¹ Generator æœ‰æ›´æ·±çš„ç†è§£å’Œè®¤è¯†ã€‚ 1.æ¦‚å¿µGenerator ä¸­æ–‡çš„æ„æ€æ˜¯â€™ç”Ÿæˆå™¨â€™ï¼Œé˜®ä¸€å³°ï¼šECMAScript 6 å…¥é—¨ä¸­å¯¹ Generator è§£é‡Šæ˜¯ï¼šGenerator å‡½æ•°æœ‰å¤šç§ç†è§£è§’åº¦ã€‚è¯­æ³•ä¸Šï¼Œé¦–å…ˆå¯ä»¥æŠŠå®ƒç†è§£æˆï¼ŒGenerator å‡½æ•°æ˜¯ä¸€ä¸ªçŠ¶æ€æœºï¼Œå°è£…äº†å¤šä¸ªå†…éƒ¨çŠ¶æ€ã€‚ æ‰§è¡Œ Generator å‡½æ•°ä¼šè¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒGenerator å‡½æ•°é™¤äº†çŠ¶æ€æœºï¼Œè¿˜æ˜¯ä¸€ä¸ªéå†å™¨å¯¹è±¡ç”Ÿæˆå‡½æ•°ã€‚è¿”å›çš„éå†å™¨å¯¹è±¡ï¼Œå¯ä»¥ä¾æ¬¡éå† Generator å‡½æ•°å†…éƒ¨çš„æ¯ä¸€ä¸ªçŠ¶æ€ã€‚Generator æœ‰ä¸¤ä¸ªç‰¹ç‚¹ï¼šç¬¬ä¸€ä¸ªæ˜¯åœ¨å®šä¹‰æ—¶ï¼Œè¦åœ¨ function å…³é”®å­—å’Œå‡½æ•°åä¸­åŠ ä¸€ä¸ªæ˜Ÿå·ï¼Œç¬¬äºŒä¸ªå°±æ˜¯åœ¨å‡½æ•°ä½“ä¸­è¿ç”¨ yeild è¡¨è¾¾å¼è¡¨ç¤ºä¸åŒçš„çŠ¶æ€ã€‚ 123456function* foo() &#123; yield \"a\"; yield \"b\";&#125;let f = foo();console.log(f); å’Œæ™®é€šå‡½æ•°ä¸åŒçš„æ˜¯ï¼Œå½“è¿è¡Œè¿™ä¸ªå‡½æ•°æ—¶ï¼Œè¿”å›ä¸æ˜¯è¿™ä¸ªå‡½æ•°çš„ç»“æœï¼Œè€Œæ˜¯ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼Œæˆ–è€…å¯ä»¥è¯´æ˜¯ä¸€ä¸ªå«æœ‰å†…éƒ¨çŠ¶æ€æŒ‡é’ˆçš„å¯¹è±¡ã€‚å¦‚æœæƒ³è¾“å‡ºå€¼å¾—è¯ï¼Œè¦ç”¨ next æ–¹æ³•æ¥è¿›è¡Œè¾“å‡ºã€‚next æ–¹æ³•å°±æ˜¯å‘ä¸‹ç§»åŠ¨æŒ‡é’ˆï¼Œå³æ¯æ¬¡è°ƒç”¨ next æ–¹æ³•ï¼Œå°±æ˜¯ä»å‡½æ•°å¤´éƒ¨æˆ–è€…ä»ä¸Šä¸€æ¬¡ yield è¡¨è¾¾å¼ç§»åŠ¨åˆ°ä¸‹ä¸€æ¬¡ yield è¡¨è¾¾å¼ï¼ˆæˆ–è€… return ä¸ºæ­¢ï¼‰ã€‚ 12345678function* foo() &#123; yield \"a\"; yield \"b\";&#125;let f = foo();f.next(); // &#123;value: \"a\", done: false&#125;f.next(); // &#123;value: \"b\", done: false&#125;f.next(); // &#123;value: undefined, done: true&#125; ä¸Šè¿°å¯ä»¥çœ‹å‡ºï¼Œè°ƒç”¨ next æ—¶è¾“å‡ºçš„æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå³ value å€¼ä»£è¡¨ yield åé¢çš„ç»“æœï¼Œdone ä»£è¡¨éå†è¿˜æ²¡æœ‰ç»“æŸï¼Œå½“éå†ç»“æŸæ—¶ï¼Œvalue å€¼éƒ½ä¸º undefinedï¼Œdone éƒ½ä¸º trueã€‚ 2.yield è¡¨è¾¾å¼yield æœ‰ä¸ªæ‡’æƒ°çš„ç‰¹æ€§ï¼Œå³ yield åé¢çš„è¡¨è¾¾å¼ï¼Œå¦‚æœä¸è°ƒç”¨ next æ–¹æ³•ï¼Œæ˜¯ä¸ä¼šæ‰§è¡Œçš„ã€‚ 1234function* foo() &#123; yield 1 + 1;&#125;foo().next(); // 2 åªæœ‰å½“ next æŒ‡é’ˆç§»åŠ¨åˆ°è¯¥ yield çš„æ—¶å€™ï¼Œæ‰ä¼šæ‰§è¡Œåé¢çš„è¡¨è¾¾å¼ã€‚yield å’Œ return æ˜¯æœ‰ä¸åŒä¹‹å¤„çš„ï¼Œåœ¨ Generator å‡½æ•°ä¸­ï¼Œå¯ä»¥å®šä¹‰å¤šä¸ª yield è¡¨è¾¾å¼ï¼Œä½†æ˜¯ return åªèƒ½å®šä¹‰ä¸€ä¸ªï¼Œå¹¶ä¸”åœ¨ yield ä¸­éå†è¿˜æ²¡æœ‰å®Œæˆï¼Œä½†åœ¨é‡åˆ° return æ—¶ï¼Œéå†å°±ç»ˆæ­¢äº†ã€‚ 12345678910function* foo() &#123; yield \"a\"; yield \"b\"; return \"c\";&#125;let f = foo();f.next(); // &#123;value: \"a\", done: false&#125;f.next(); // &#123;value: \"b\", done: false&#125;f.next(); // &#123;value: \"c\", done: true&#125;f.next(); // &#123;value: undefined, done: true&#125; å½“é‡åˆ° return æ—¶ï¼Œéå†ç»“æŸ done ä¸º trueï¼Œvalue å€¼ä¸º return åçš„ç»“æœï¼Œåœ¨æ­¤ä¹‹åçš„ next çš„ç»“æœéƒ½ä¸º{value: undefined, done: true}ã€‚å¦‚æœåœ¨ Generator å‡½æ•°ä¸­æ²¡æœ‰ yield è¡¨è¾¾å¼ï¼š 12345function* foo() &#123; console.log(\"a\");&#125;let f = foo();f.next(); foo()è¿”å›çš„ä¾æ—§æ˜¯ä¸€ä¸ªå«æœ‰å†…éƒ¨çŠ¶æ€æŒ‡é’ˆçš„å¯¹è±¡ï¼Œåªæœ‰å½“ next æ–¹æ³•æ‰§è¡Œæ—¶è¯¥å‡½æ•°æ‰ä¼šæ‰§è¡Œã€‚å½“ yield å’Œå…¶ä»–è¡¨è¾¾å¼èåˆæ—¶ï¼Œå¦‚æœ yield è¡¨è¾¾å¼åœ¨å·¦è¾¹ï¼Œè¦å°† yield è¡¨è¾¾å¼ç”¨åœ†æ‹¬å·åŒ…è£¹ï¼Œå¦åˆ™å°±ä¼šæŠ¥è¯­æ³•é”™è¯¯ã€‚ 12345678function* foo() &#123; console.log('a'+ yield 'b'); // Uncaught SyntaxError: Unexpected identifier&#125;function* foo() &#123; console.log('a'+ (yield 'b')); // &#123;value: \"b\", done: false&#125;&#125;let f = foo();f.next(); å½“ç”¨ä½œå‡½æ•°å‚æ•°æˆ–æ”¾åœ¨èµ‹å€¼è¡¨è¾¾å¼çš„å³è¾¹ï¼Œå¯ä»¥ä¸åŠ æ‹¬å·ã€‚ 1234function* demo() &#123; foo(yield \"a\", yield \"b\"); // OK let input = yield; // OK&#125; 3.next æ–¹æ³•yield æ˜¯æ²¡æœ‰è¿”å›å€¼çš„ï¼Œå®ƒçš„è¿”å›å€¼æ˜¯ undefinedï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ next æ–¹æ³•å°†å‚æ•°ä¼ é€’ç»™ yieldï¼Œæ­¤å‚æ•°å°†ä¼šä¸º yield çš„è¿”å›å€¼ã€‚ 123456789101112function* f() &#123; for (var i = 0; true; i++) &#123; var reset = yield i; if (reset) &#123; i = -1; &#125; &#125;&#125;var g = f();g.next(); // &#123; value: 0, done: false &#125;g.next(); // &#123; value: 1, done: false &#125;g.next(true); // &#123; value: 0, done: false &#125; ä¸Šé¢ä»£ç å…ˆå®šä¹‰äº†ä¸€ä¸ªå¯ä»¥æ— é™è¿è¡Œçš„ Generator å‡½æ•° fï¼Œå¦‚æœ next æ–¹æ³•æ²¡æœ‰å‚æ•°ï¼Œæ¯æ¬¡è¿è¡Œåˆ° yield è¡¨è¾¾å¼ï¼Œå˜é‡ reset çš„å€¼æ€»æ˜¯ undefinedã€‚å½“ next æ–¹æ³•å¸¦ä¸€ä¸ªå‚æ•° true æ—¶ï¼Œå˜é‡ reset å°±è¢«é‡ç½®ä¸ºè¿™ä¸ªå‚æ•°ï¼ˆå³ trueï¼‰ï¼Œå› æ­¤ i ä¼šç­‰äº-1ï¼Œä¸‹ä¸€è½®å¾ªç¯å°±ä¼šä»-1 å¼€å§‹é€’å¢ã€‚ä¸ç”¨ next æ–¹æ³•æ˜¯å¦å¯ä»¥è¾“å‡ºå€¼å‘¢ï¼Ÿç­”æ¡ˆæ˜¯å¯ä»¥çš„ï¼Œå¯ä»¥ç”¨ forâ€¦ofâ€¦æ–¹æ³•éå† Generator å‡½æ•°ã€‚ 123456789101112function* foo() &#123; yield 1; yield 2; yield 3; yield 4; yield 5; return 6;&#125;for (let v of foo()) &#123; console.log(v); // 1 2 3 4 5&#125; å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œforâ€¦ofâ€¦åœ¨ done ä¸º ture çš„æ—¶å€™å°±ä¼šç»ˆæ­¢æ‰§è¡Œï¼Œæ‰€ä»¥ return åçš„ 6 æ²¡æœ‰è¾“å‡ºã€‚ 4.yield* è¡¨è¾¾å¼yield* è¡¨è¾¾å¼æ˜¯ä¸ºäº†è§£å†³åœ¨ä¸€ä¸ª Generator å‡½æ•°ä¸­è°ƒç”¨å¦ä¸€ä¸ª Generator å‡½æ•°æ‰€æä¾›çš„æ–¹æ³•ã€‚ 123456789101112131415function* foo() &#123; yield 1; yield 2; yield 3; yield* foo1();&#125;ç­‰åŒäº;function* foo() &#123; yield 1; yield 2; yield 3; for (let v of foo1()) &#123; yield v; &#125;&#125; å½“ yield*åè¾¹çš„ Generator å‡½æ•°ä¸­æ²¡æœ‰ return æ—¶ï¼Œä½œç”¨å°±æ˜¯ forâ€¦ofâ€¦éå† Generator å‡½æ•°ï¼Œå¦‚æœ Generator å‡½æ•°ä¸­æœ‰ return æ—¶ï¼Œåˆ™è·å–çš„æ˜¯ return å€¼ã€‚ 12345678910111213141516function* foo() &#123; yield 1; yield 2; yield 3; var value = yield* foo1(); console.log(value);&#125;function* foo1() &#123; yield 4; return 5;&#125;let f = foo();f.next(); // &#123;value: 1, done: false&#125;f.next(); // &#123;value: 2, done: false&#125;f.next(); // &#123;value: 3, done: false&#125;f.next(); // 5 &#123;value: undefined, done: true&#125; å…¶å® yield*åé¢åªè¦æ˜¯å¸¦æœ‰ Iterator æ¥å£çš„éƒ½ä¼šè¢«éå†ã€‚ 12345function* foo() &#123; yield* [1, 2, 3, 4];&#125;let f = foo();f.next(); // &#123;value: 1, done: false&#125; å†ä¸¾ä¸ªä¾‹å­ï¼š 123456789101112function* foo() &#123; yield \"a\"; yield \"b\"; return \"END\";&#125;function* bar(func) &#123; let result = yield* func(); console.log(result);&#125;[...bar(foo)];// END// [\"a\", \"b\"] ä¸Šè¿°ä¸­ foo æ˜¯æ‹¥æœ‰ return è¡¨è¾¾å¼çš„å‡½æ•°ï¼Œæ‰€ä»¥ return åçš„ç»“æœä¼šâ€˜èµ‹å€¼â€™ç»™ yield*è¡¨è¾¾å¼çš„è¿”å›å€¼ï¼Œæ‰€ä»¥ result æ˜¯â€™ENDâ€™ï¼Œå¹¶ä¸”æ‹“å±•è¿ç®—ç¬¦é»˜è®¤è°ƒç”¨ Iterator æ¥å£ï¼Œæ‰€ä»¥ä¼šå…ˆæ‰“å°å‡º resultï¼Œç„¶åå†æ‰§è¡Œ yieldã€‚ å‚è€ƒï¼šé˜®ä¸€å³°ï¼šECMAScript 6 å…¥é—¨","categories":[{"name":"ES6","slug":"ES6","permalink":"https://tomatoesman.github.io/categories/ES6/"}],"tags":[{"name":"ES6","slug":"ES6","permalink":"https://tomatoesman.github.io/tags/ES6/"}]},{"title":"Promise","slug":"Promise","date":"2020-06-28T15:31:26.000Z","updated":"2020-06-28T15:33:13.296Z","comments":true,"path":"2020/06/28/Promise/","link":"","permalink":"https://tomatoesman.github.io/2020/06/28/Promise/","excerpt":"Promise è®©äººåˆæ¨åˆçˆ±çš„å­˜åœ¨ï¼Œæ¨æ˜¯å› ä¸ºé¢è¯•çš„æ—¶å€™ä¼šå›´ç»•å®ƒå‡ºå¾ˆå¤šé¢˜ï¼Œåˆç»•åˆå¤´ç–¼ï¼Œçˆ±æ˜¯çœŸé¦™ï¼Œè°éƒ½é€ƒä¸è¿‡çœŸé¦™å®šå¾‹ã€‚ 1ã€æ¦‚å¿µPromise æ˜¯å¼‚æ­¥ç¼–ç¨‹çš„ä¸€ä¸ªæ–°çš„è§£å†³æ–¹æ¡ˆï¼Œé˜®ä¸€å³°ï¼šECMAScript 6 å…¥é—¨ä¸­ç»™å‡ºå¯¹ promise çš„å«ä¹‰æ˜¯ï¼šæ‰€è°“ Promiseï¼Œç®€å•è¯´å°±æ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œé‡Œé¢ä¿å­˜ç€æŸä¸ªæœªæ¥æ‰ä¼šç»“æŸçš„äº‹ä»¶ï¼ˆé€šå¸¸æ˜¯ä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼‰çš„ç»“æœã€‚Promise æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œå®ƒæœ‰ä¸¤ä¸ªç‰¹ç‚¹ï¼š","text":"Promise è®©äººåˆæ¨åˆçˆ±çš„å­˜åœ¨ï¼Œæ¨æ˜¯å› ä¸ºé¢è¯•çš„æ—¶å€™ä¼šå›´ç»•å®ƒå‡ºå¾ˆå¤šé¢˜ï¼Œåˆç»•åˆå¤´ç–¼ï¼Œçˆ±æ˜¯çœŸé¦™ï¼Œè°éƒ½é€ƒä¸è¿‡çœŸé¦™å®šå¾‹ã€‚ 1ã€æ¦‚å¿µPromise æ˜¯å¼‚æ­¥ç¼–ç¨‹çš„ä¸€ä¸ªæ–°çš„è§£å†³æ–¹æ¡ˆï¼Œé˜®ä¸€å³°ï¼šECMAScript 6 å…¥é—¨ä¸­ç»™å‡ºå¯¹ promise çš„å«ä¹‰æ˜¯ï¼šæ‰€è°“ Promiseï¼Œç®€å•è¯´å°±æ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œé‡Œé¢ä¿å­˜ç€æŸä¸ªæœªæ¥æ‰ä¼šç»“æŸçš„äº‹ä»¶ï¼ˆé€šå¸¸æ˜¯ä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼‰çš„ç»“æœã€‚Promise æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œå®ƒæœ‰ä¸¤ä¸ªç‰¹ç‚¹ï¼š Promise æœ‰ä¸‰ä¸ªçŠ¶æ€ï¼špendingï¼ˆè¿›è¡Œä¸­ï¼‰ã€resolvedï¼ˆå·²æˆåŠŸï¼‰å’Œ rejectedï¼ˆå·²å¤±è´¥ï¼‰ã€‚å¹¶ä¸”çŠ¶æ€ä¸å—å¤–éƒ¨çš„å½±å“ã€‚ çŠ¶æ€ä¸€æ—¦æ”¹å˜å°±æ— æ³•ä¿®æ”¹ã€‚åªèƒ½æœ‰ä¸¤ä¸ªè¿‡ç¨‹ï¼šä¸€ä¸ªæ˜¯ä» pending åˆ° resolved è¿˜æœ‰ä¸€ä¸ªå°±æ˜¯ä» pending åˆ° rejectedï¼Œä¸å¯èƒ½ä» resolved åˆ° rejectedï¼Œä¸€æ—¦æˆåŠŸå°±ä¸å¯èƒ½å†å¤±è´¥äº†ã€‚ Promise ä¸€æ—¦åˆ›å»ºå°±ä¼šç«‹å³æ‰§è¡Œï¼Œä¸èƒ½ä¸­é€”å–æ¶ˆã€‚ 2ã€ç”¨æ³•é€šå¸¸æˆ‘ä»¬æ¥è¯´ï¼ŒPromise ä¸»è¦æ˜¯è§£å†³å¼‚æ­¥å›è°ƒåœ°ç‹±ã€‚ä»€ä¹ˆæ˜¯å›è°ƒåœ°ç‹±ï¼Ÿä»ç½‘ä¸Šæ‰¾äº†å‡ å¼ å›¾ï¼Œå¤§å®¶å¯ä»¥æ„Ÿå—ä¸€ä¸‹è¢«å›è°ƒåœ°ç‹±æ‰€æ”¯é…çš„ææƒ§ï¼šå›è°ƒåœ°ç‹±æœ€å¤§çš„ç¼ºç‚¹å°±æ˜¯ä»£ç å¯è¯»æ€§å·®ï¼Œç¼–å†™è´¹åŠ²ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ Promise çš„åŸºæœ¬ç”¨æ³•ï¼š 12345678new Promise((resolve, reject)=&gt;&#123; ... if(success) &#123; resolve(value); &#125;else &#123; reject(error); &#125;&#125;) ä¹‹å‰è¯´è¿‡ï¼ŒPromise æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œå®ƒæ¥æ”¶ä¸€ä¸ªå‡½æ•°å‚æ•°ï¼Œè¿™ä¸ªå‡½æ•°ä¸­æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯ resolve è¿˜æœ‰ä¸€ä¸ªæ˜¯ rejectedï¼Œè¿™ä¸¤ä¸ªå‚æ•°å‡ä¸ºå‡½æ•°ï¼Œå¹¶ä¸”è¿™ä¸¤ä¸ªå‚æ•°ä¸ç”¨è‡ªå·±éƒ¨ç½²ï¼ŒJS å¼•æ“ä¼šè‡ªåŠ¨éƒ¨ç½²ã€‚resolve å‡½æ•°çš„ä½œç”¨æ˜¯å½“å¼‚æ­¥å‡½æ•°æˆåŠŸæ—¶ï¼Œå°†æˆåŠŸåçš„å€¼ä¼ é€’å‡ºå»ï¼ŒåŒæ—¶ä¹Ÿæ˜¯å°†çŠ¶æ€ä» pending å˜ä¸º resolvedï¼Œreject å‡½æ•°çš„ä½œç”¨æ˜¯å½“å¼‚æ­¥å‡½æ•°å¤±è´¥åï¼Œå°†å¤±è´¥çš„é”™è¯¯ä¿¡æ¯ä¼ é€’å‡ºå»ï¼ŒåŒæ—¶ä¹Ÿæ˜¯å°†çŠ¶æ€ä» pending å˜ä¸º rejectedã€‚ 2.1ã€then()å½“ Promise å®ä¾‹åˆ›å»ºæˆåŠŸåï¼Œå¯ä»¥æ‰§è¡Œå…¶åŸå‹ä¸Šçš„ then æ–¹æ³•ï¼Œthen æ–¹æ³•åŒæ ·æ¥æ”¶ä¸¤ä¸ªå‡½æ•°å‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯æ¥æ”¶çš„ resolve å›è°ƒçš„ç»“æœï¼Œç¬¬äºŒä¸ªæ˜¯ reject å›è°ƒçš„ç»“æœï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯éå¿…å¡«çš„ã€‚ 12345678910new Promise((resolve, reject) =&gt; &#123; resolve(1);&#125;).then( (value) =&gt; console.log(value) // 1);new Promise((resolve, reject) =&gt; &#123; reject(\"å‡ºç°é”™è¯¯\");&#125;).then( (error) =&gt; console.log(error) // å‡ºç°é”™è¯¯); å› ä¸º Promise çš„å¯¹è±¡æ—¶ç«‹å³åˆ›å»ºçš„ï¼Œæ‰€ä»¥åœ¨ resolve å’Œ reject å‡½æ•°ä¹‹å‰çš„æ“ä½œéƒ½ä¼šç«‹å³æ‰§è¡Œï¼š 123456new Promise((resolve, reject) =&gt; &#123; console.log(2); resolve(1);&#125;).then( (value) =&gt; console.log(value) // 2 1); Promise æ‰§è¡Œ then æ–¹æ³•åä¼šè¿”å›å›æ¥ä¸€ä¸ªæ–°çš„ Promise å¯¹è±¡ï¼Œæ‰€ä»¥å¯ä»¥é‡‡ç”¨é“¾å¼è°ƒç”¨ã€‚ 12345new Promise((resolve) =&gt; &#123; resolve(1);&#125;) .then((value) =&gt; value + 1) .then((value) =&gt; console.log(value)); // 2 ç¬¬ä¸€ä¸ª then å‡½æ•°çš„è¿”å›å€¼ï¼Œå¯ä»¥ä½œä¸ºå‚æ•°ä¼ ç»™ç¬¬äºŒä¸ª then å‡½æ•°ã€‚å¦‚æœç¬¬ä¸€ä¸ª then å‡½æ•°è¿”å›çš„ä¾æ—§æ˜¯ä¸€ä¸ª Promise å¯¹è±¡å‘¢ï¼Ÿå³æ˜¯ä¸€ä¸ª Promise å°è£…çš„å¼‚æ­¥æ“ä½œï¼š 12345678910new Promise((resolve) =&gt; &#123; resolve(1);&#125;) .then( (value) =&gt; new Promise((resolve) =&gt; &#123; resolve(3); &#125;) ) .then((value) =&gt; console.log(value)); // 3 æ­¤æ—¶ç¬¬äºŒä¸ª then å‡½æ•°ä¼ å…¥çš„å‚æ•°ï¼Œå³ä¸ºç¬¬ä¸€ä¸ª then å‡½æ•°è¿”å›çš„ Promise å¯¹è±¡çš„ resolved çŠ¶æ€ä¸‹ä¼ é€’çš„å€¼ã€‚ä¹Ÿå¯ä»¥è¯´åªæœ‰ç¬¬ä¸€ä¸ª then è¿”å›çš„ Promise æ‰§è¡ŒçŠ¶æ€æˆåŠŸæ—¶ï¼Œç¬¬äºŒä¸ª then å‡½æ•°æ‰ä¼šæ‰§è¡Œã€‚ 2.2ã€catch()é™¤äº† then å‡½æ•°å¤–ï¼Œåœ¨ Promise åŸå‹ä¸Šè¿˜æœ‰ä¸€ä¸ª catch å‡½æ•°ï¼Œæ­¤å‡½æ•°æ—¶å½“ Promise å†…éƒ¨å¼‚æ­¥å‡ºç°é”™è¯¯çš„æ—¶å€™å³ä¸º rejected çŠ¶æ€æ—¶ï¼Œæ‰æ‰§è¡Œã€‚ 1234567new Promise((resolve, reject)=&gt;&#123; throw new Error('test')&#125;).catch(err=&gt;console.log(err)) // Error: testç­‰åŒäºï¼šnew Promise((resolve, reject)=&gt;&#123; throw new Error('test')&#125;).then(null, err=&gt;console.log(err)) // Error: test å½“ then ç¬¬äºŒä¸ªå‚æ•°å’Œ catch å‡½æ•°åŒæ—¶å­˜åœ¨æ—¶ï¼Œå°†ä¸ä¼šæ‰§è¡Œ catch å‡½æ•°ï¼š 12345new Promise((resolve, reject) =&gt; &#123; throw new Error(\"test\");&#125;) .then(null, (err) =&gt; console.log(err)) // Error: test .catch((err) =&gt; console.log(err)); é‚£æ­¤æ—¶çš„ catch æ•è·çš„æ˜¯å“ªä¸ª Promise çš„é”™è¯¯å‘¢ï¼Ÿæ•è·çš„æ˜¯å‰ä¸€ä¸ª Promise çš„é”™è¯¯ï¼Œå³ then å‡½æ•°è¿”å›å›æ¥çš„ Promise é”™è¯¯ï¼š 1234567new Promise((resolve, reject) =&gt; &#123; throw new Error(\"test\");&#125;) .then(null, (err) =&gt; &#123; throw new Error(\"test1\"); &#125;) .catch((err) =&gt; console.log(err)); // Error: test1 Promise çš„é”™è¯¯æœ‰ä¸€ç§ç±»ä¼¼å†’æ³¡æœºåˆ¶ï¼Œå½“ catch ä¹‹å‰æ²¡æœ‰æ²¡æœ‰ä»»ä½•å‡½æ•°æˆªè·é”™è¯¯ï¼Œé‚£ç»ˆç©¶ä¼šè¢« catch æˆªè·ã€‚ 12345new Promise((resolve, reject) =&gt; &#123; throw new Error(\"test\");&#125;) .then() .catch((err) =&gt; console.log(err)); // Error: test åªè¦ catch å‰ä»»ä½•ä¸€ä¸ª Promise æŠ¥é”™ï¼Œé‚£ç»ˆç©¶ä¼šè¢« catch æˆªè·ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œä¸å»ºè®®ä½¿ç”¨ then å‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°æ¥è¿›è¡Œé”™è¯¯çš„æ•è·ï¼Œå¦‚ä¸Šæ‰€è¯´çš„ catch å†™æ³•å¯ä»¥æ•è·å‰é¢ then æ–¹æ³•æ‰§è¡Œä¸­çš„é”™è¯¯ï¼Œä¹Ÿæ›´æ¥è¿‘åŒæ­¥çš„å†™æ³•ï¼ˆtry/catchï¼‰ã€‚å› æ­¤ï¼Œå»ºè®®æ€»æ˜¯ä½¿ç”¨ catch()æ–¹æ³•ï¼Œè€Œä¸ä½¿ç”¨ then()æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°ã€‚then()è¿”å›ä¸€ä¸ªæ–°çš„ Promise å¯¹è±¡ï¼Œcatch()åŒæ ·è¿”å›ä¸€ä¸ª Promise å¯¹è±¡ï¼ŒåŒæ ·å¯ä»¥ä½¿ç”¨é“¾å¼è°ƒç”¨ï¼š 123456new Promise((resolve, reject) =&gt; &#123; throw new Error(\"test\");&#125;) .then() .catch((err) =&gt; console.log(err)) // Error: test .then(() =&gt; console.log(2)); // 2 å½“ catch æ•è·å®Œé”™è¯¯åï¼Œä¼šæ¥ç€æ‰§è¡Œä¸‹é¢çš„ then æ–¹æ³•ï¼Œå½“æ²¡æœ‰é”™è¯¯æŠ›å‡ºæ—¶ï¼Œåˆ™ä¼šè·³è¿‡ catchï¼Œç›´æ¥æ‰§è¡Œåé¢çš„ then æ–¹æ³•ã€‚ä½†æ˜¯ä¹‹åçš„ Promise å‡ºç°é”™è¯¯æ—¶ï¼Œä¹‹å‰çš„ catch å°±æ•è·ä¸åˆ°äº†ã€‚ 12345678new Promise((resolve, reject) =&gt; &#123; throw new Error(\"test\");&#125;) .then() .catch((err) =&gt; &#123; throw new Error(\"test1\"); &#125;) // Error: test .then(() =&gt; console.log(2)); catch åé¢å¯ä»¥é“¾å¼è°ƒç”¨ then æ–¹æ³•ï¼ŒåŒæ ·ä¹Ÿå¯ä»¥è°ƒç”¨ catch æ–¹æ³•ï¼Œåé¢çš„ catch æ–¹æ³•æ˜¯æ¥æ”¶å‰ä¸€ä¸ª catch æ–¹æ³•æ‰€æŠ›å‡ºçš„é”™è¯¯ã€‚ 2.3ã€finallyåœ¨ ES8 ä¸­æ–°åŠ å…¥äº†ä¸€ä¸ªæ–¹æ³•ï¼Œå³ finallyï¼Œæ­¤æ–¹æ³•ä¸åŒäº then å’Œ catchï¼Œå®ƒä¸è·Ÿè¸ªä¸ Promise å¯¹è±¡çŠ¶æ€çš„æ”¹å˜ï¼Œå³ä¸ç®¡ Promise çš„æœ€ç»ˆçŠ¶æ€å¦‚ä½•ï¼Œéƒ½ä¼šæ‰§è¡Œè¿™ä¸ªæ–¹æ³•ï¼ŒåŒæ—¶ finally ä¸åŒäº then å’Œ catch åœ°æ–¹å°±æ˜¯ï¼Œå®ƒä¸æ¥å—ä»»ä½•å‚æ•°ã€‚ 1234567891011new Promise((resolve) =&gt; &#123; resolve(1);&#125;) .then((value) =&gt; console.log(value)) // 1 .finally(() =&gt; console.log(2)); // 2new Promise(() =&gt; &#123; throw new Error(\"test\");&#125;) .catch((err) =&gt; console.log(err)) // Error test .finally(() =&gt; console.log(2)); // 2 finally åŒæ ·è¿”å›ä¸€ä¸ªæ–°çš„ Promise å¯¹è±¡ï¼Œç”¨æ³•å’Œä¹‹å‰çš„ then å’Œ catch ä¸€æ ·ï¼Œè¿™å—å°±ä¸åšè¿‡å¤šçš„è®²è§£äº†ã€‚ 3ã€å…¶ä»– APIé™¤äº†ä¸Šè¿° Promise åŸå‹ä¸Šçš„æ–¹æ³•å¤–ï¼ŒPromise è¿˜æœ‰å¾ˆå¤šå…¶ä»–çš„ APIã€‚ 3.1ã€ Promise.allé€šè¿‡å­—é¢æ„æ€å°±èƒ½çœ‹å‡ºæ¥ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯â€˜å…¨éƒ¨â€™æ„æ€ï¼Œç”±æ­¤å¯è§å¯ä»¥æ¥å—å¤šä¸ª Promise å¯¹è±¡ã€‚è¯¥æ–¹æ³•æ¥å—å…·æœ‰ Iterator æ¥å£å¹¶ä¸”æ¯ä¸ªæˆå‘˜éƒ½æ˜¯ Promise å®ä¾‹çš„å‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–°çš„ Promise å¯¹è±¡ã€‚ 1234567891011let p = Promise.all([ new Promise((resolve) =&gt; &#123; resolve(1); &#125;), new Promise((resolve) =&gt; &#123; resolve(2); &#125;), new Promise((resolve) =&gt; &#123; resolve(3); &#125;),]); å¹¶ä¸”ï¼Œåªæœ‰å½“æ¥å—çš„å‚æ•°ä¸­æ‰€æœ‰æˆå‘˜çš„çŠ¶æ€éƒ½ä¸º resolved çš„æ—¶å€™ï¼Œp çš„çŠ¶æ€æ‰ä¼šä¸º resolvedï¼Œå¦‚æœæœ‰ä¸€ä¸ªæˆå‘˜çš„çŠ¶æ€ä¸º rejectedï¼Œé‚£ p çš„çŠ¶æ€å°±ä¸º rejectedã€‚å½“æ‰€æœ‰æˆå‘˜çš„çŠ¶æ€å‡ä¸º resolved çš„æ—¶å€™ï¼Œä¼šå°†æ¯ä¸ªæˆå‘˜ resolved çŠ¶æ€ä¸‹çš„å€¼æ‹¼æˆæ•°ç»„ä¼ é€’ç»™ p çš„å›è°ƒå‡½æ•°ã€‚ 123456789101112let p = Promise.all([ new Promise((resolve) =&gt; &#123; resolve(1); &#125;), new Promise((resolve) =&gt; &#123; resolve(2); &#125;), new Promise((resolve) =&gt; &#123; resolve(3); &#125;),]);p.then((result) =&gt; console.log(result)); // [1, 2, 3] å½“æœ‰ä¸€ä¸ªæˆå‘˜çš„çŠ¶æ€ä¸º rejected çš„æ—¶å€™ï¼Œåˆ™ä¼šå°†ç¬¬ä¸€ä¸ª rejected çŠ¶æ€çš„å€¼è¿”ç»™ p çš„ catch æ–¹æ³•ã€‚ 123456789101112let p = Promise.all([ new Promise((resolve) =&gt; &#123; resolve(1); &#125;), new Promise((resolve, rejecct) =&gt; &#123; rejecct(2); &#125;), new Promise((resolve) =&gt; &#123; resolve(3); &#125;),]);p.catch((err) =&gt; console.log(err)); å¦‚æœæœ‰ä¸€ä¸ªæˆå‘˜ä¸º rejected çŠ¶æ€ï¼Œå¹¶ä¸”è‡ªèº«è°ƒç”¨äº† catch æ–¹æ³•ï¼Œé‚£å°†ä¸ä¼šèµ° p å¯¹è±¡çš„ catch æ–¹æ³•ï¼Œè¿™ä¸€ç‚¹è¦æ³¨æ„ã€‚ 3.2ã€ Promise.racerace ç¿»è¯‘æˆä¸­æ–‡æ˜¯ç«èµ›çš„æ„æ€ï¼Œä»–è¡¨ç¤ºå¤šä¸ª Promise å¯¹è±¡ï¼Œå“ªä¸ªæˆå‘˜ç‡å…ˆæ”¹å˜çŠ¶æ€ï¼Œé‚£ Promise.race è¿”å›çš„ Promise å¯¹è±¡çš„çŠ¶æ€å˜ä¸ºä»€ä¹ˆï¼Œå¹¶å°†å€¼è½¬é€’ç»™ p çš„å›è°ƒå‡½æ•°ï¼Œå®ƒå’Œ Promise.all æ¥æ”¶çš„å‚æ•°ä¸€æ ·ã€‚ 12345678910111213141516171819202122232425let p = Promise.race([ new Promise((resolve) =&gt; &#123; setTimeout(() =&gt; resolve(1), 100); &#125;), new Promise((resolve) =&gt; &#123; setTimeout(() =&gt; resolve(2), 50); &#125;), new Promise((resolve) =&gt; &#123; setTimeout(() =&gt; resolve(3), 200); &#125;),]);p.then((result) =&gt; console.log(result)); // 2let p = Promise.race([ new Promise((resolve) =&gt; &#123; setTimeout(() =&gt; resolve(1), 100); &#125;), new Promise((resolve, reject) =&gt; &#123; setTimeout(() =&gt; reject(2), 50); &#125;), new Promise((resolve) =&gt; &#123; setTimeout(() =&gt; resolve(3), 200); &#125;),]);p.catch((err) =&gt; console.log(err)); // 2 3.3ã€Promise.allSettledè¯¥æ–¹æ³•æ˜¯ ES2020 æ–°åŠ å…¥çš„ï¼Œå’Œ all ä¸€æ ·ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„ Promise å¯¹è±¡ï¼Œæ¥æ”¶ä¸€ç»„ Promise å¯¹è±¡ï¼Œä½†æ˜¯å’Œ all åŒºåˆ«çš„æ˜¯ï¼Œå½“ä¸ç®¡æ¯ä¸ªæˆå‘˜çš„ Promise æ˜¯ä»€ä¹ˆçŠ¶æ€ï¼Œåªè¦æ‰§è¡Œç»“æŸï¼Œåˆ™è¿”å›çš„ Promise å¯¹è±¡å°±ä¼šæ‰§è¡Œç»“æŸã€‚ 123456789101112let p = Promise.allSettled([ new Promise((resolve) =&gt; &#123; resolve(1); &#125;), new Promise((resolve, rejecct) =&gt; &#123; rejecct(2); &#125;), new Promise((resolve) =&gt; &#123; resolve(3); &#125;),]);p.then((value) =&gt; console.log(JSON.stringify(value))); // [&#123;status:\"fulfilled\",value:1&#125;,&#123;status:\"rejected\",reason:2&#125;,&#123;status:\"fulfilled\",value:3&#125;] æœ‰æ—¶å€™å¼‚æ­¥è¯·æ±‚å¹¶ä¸åœ¨æ„æ˜¯å¦èƒ½å¤ŸæˆåŠŸï¼Œè¿™ä¸ªæ—¶å€™è¿™ä¸ªæ–¹æ³•å°±å¾ˆç¬¦åˆåœºæ™¯äº†ï¼Œå¹¶ä¸”è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„ä¸­æ¯ä¸ªå¯¹è±¡æœ‰ä¸¤ä¸ªçŠ¶æ€ï¼Œä¸€ä¸ªæ˜¯ fulfilledï¼Œå¦ä¸€ä¸ªæ˜¯ rejectedï¼Œè¿”å›ä¹‹åå¯ä»¥è¿›è¡Œç­›é€‰ï¼ŒæŸ¥çœ‹é”™è¯¯ä¿¡æ¯ã€‚ 3.4ã€Promise.resolveå°†ä¸€ä¸ªå¯¹è±¡è½¬åŒ–ä¸ºä¸€ä¸ª Promise å¯¹è±¡ã€‚ 123Promise.resolve(\"foo\");ç­‰ä»·äº;new Promise((resolve) =&gt; resolve(\"foo\")); å½“ Promise.resolve çš„å‚æ•°æ˜¯ä¸€ä¸ª Promise å®ä¾‹æ—¶ï¼ŒåŸå°ä¸åŠ¨çš„è¿”å›è¿™ä¸ªå®ä¾‹ï¼š 123let p = new Promsie((resolve) =&gt; resolve(1));let p1 = Promise.resolve(p);p === p1; // true å½“å‚æ•°æ˜¯ä¸€ä¸ª thenable å¯¹è±¡æ—¶ï¼Œå³å«æœ‰ then æ–¹æ³•çš„å¯¹è±¡æ—¶ï¼Œä¼šè¿”å›ä¸€ä¸ª Promise å¯¹è±¡ï¼Œå¹¶ç«‹å³æ‰§è¡Œ then æ–¹æ³•ã€‚ 1234567let thenable = &#123; then: function (resolve, reject) &#123; resolve(1); &#125;,&#125;;let p = Promise.resolve(thenable);p.then((value) =&gt; console.log(value)); // 1 å½“å‚æ•°æ˜¯ä¸æ˜¯ä¸€ä¸ª thenable å¯¹è±¡æ—¶ï¼Œç”±äºå‚æ•°ä¸æ˜¯ä¸€ä¸ªå¼‚æ­¥çš„ï¼Œæ‰€ä»¥å½“ Promise.resolve åï¼Œç›´æ¥çš„çŠ¶æ€å°±æ˜¯ resolved çš„çŠ¶æ€ï¼Œæ‰€ä»¥ then åå°±ä¼šè¾“å‡ºåŸå€¼ã€‚ 123456789101. å‚æ•°æ˜¯ä¸ªæ™®é€šå¯¹è±¡let obj = &#123; name: '1'&#125;let p = Promise.resolve(obj);p.then(value=&gt;console.log(value)) // &#123;name: '1'&#125;2. å‚æ•°æ˜¯ä¸ªåŸºæœ¬æ•°æ®ç±»å‹let num = '1';let p = Promise.resolve(num);p.then(value=&gt;console.log(value)) // 1 å½“ä¸ä¼ å‚æ•°çš„æ—¶å€™ï¼Œè¿”å›çš„å°±æ˜¯ä¸€ä¸ªå¸¦æœ‰ resolved çŠ¶æ€çš„ Promise å¯¹è±¡ã€‚ 3.5ã€Promise.rejectè¿”å›ä¸€ä¸ªçŠ¶æ€ä¸º rejected çš„ Promise å¯¹è±¡ï¼Œä¼ å…¥çš„å‚æ•°ä½œä¸ºé”™è¯¯ä¿¡æ¯ä½œä¸ºåç»­æ–¹æ³•ä¼ é€’çš„å‚æ•°ã€‚ 123let num = \"1\";let p = Promise.reject(num);p.then(null, (err) =&gt; console.log(err)); // 1 å½“å‚æ•°æ˜¯ thenable å¯¹è±¡æ—¶ï¼Œè¿”å›çš„ä¸æ˜¯ error ä¿¡æ¯è€Œæ˜¯ thenable å¯¹è±¡ã€‚ 1234567let thenable = &#123; then: function (resolve, reject) &#123; reject(1); &#125;,&#125;;let p = Promise.reject(thenable);p.then(null, (err) =&gt; console.log(err === thenable)); // true","categories":[{"name":"ES6","slug":"ES6","permalink":"https://tomatoesman.github.io/categories/ES6/"}],"tags":[{"name":"ES6","slug":"ES6","permalink":"https://tomatoesman.github.io/tags/ES6/"}]},{"title":"varã€letå’Œconst","slug":"varã€letå’Œconst","date":"2020-06-22T14:35:21.000Z","updated":"2020-06-25T12:06:05.668Z","comments":true,"path":"2020/06/22/varã€letå’Œconst/","link":"","permalink":"https://tomatoesman.github.io/2020/06/22/var%E3%80%81let%E5%92%8Cconst/","excerpt":"1ã€varåœ¨æ²¡å‡ºç° let å’Œ const ä¹‹å‰ï¼Œæˆ‘ä»¬å®šä¹‰å˜é‡åªèƒ½ç”¨ varã€‚ä½†æ˜¯ç”¨ var å®šä¹‰å˜é‡é€šå¸¸æœ‰å¾ˆå¤šçš„é—®é¢˜ï¼Œå°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„å˜é‡æå‡ï¼Œä¾‹å¦‚ï¼š","text":"1ã€varåœ¨æ²¡å‡ºç° let å’Œ const ä¹‹å‰ï¼Œæˆ‘ä»¬å®šä¹‰å˜é‡åªèƒ½ç”¨ varã€‚ä½†æ˜¯ç”¨ var å®šä¹‰å˜é‡é€šå¸¸æœ‰å¾ˆå¤šçš„é—®é¢˜ï¼Œå°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„å˜é‡æå‡ï¼Œä¾‹å¦‚ï¼š 1234if (false) &#123; var a = 1;&#125;console.log(a); å¦‚æœåˆå­¦è€…ç¬¬ä¸€æ¬¡çœ‹è¿™æ®µä»£ç çš„æ—¶å€™ï¼Œè‚¯å®šä¼šè§‰å¾—æ®µä»£ç ä¼šæŠ¥é”™ï¼Œå› ä¸º if ä¸­çš„æ¡ä»¶æ˜¯ falseï¼Œå¹¶æ²¡æœ‰æ‰§è¡Œ var a = 1ï¼Œæ‰€ä»¥æœ€ååº”è¯¥æŠ¥ a æ²¡æœ‰å®šä¹‰çš„é”™è¯¯ï¼Œä½†æ˜¯å®é™…æœ€åå´è¾“å‡ºäº† undefinedï¼Œè¿™å°±æ˜¯å˜é‡æå‡ã€‚ä»€ä¹ˆæ˜¯å˜é‡æå‡ï¼šMDN æ˜¯è¿™ä¹ˆè¯´çš„ï¼šå˜é‡æå‡ï¼ˆHoistingï¼‰è¢«è®¤ä¸ºæ˜¯ï¼Œ Javascript ä¸­æ‰§è¡Œä¸Šä¸‹æ–‡ ï¼ˆç‰¹åˆ«æ˜¯åˆ›å»ºå’Œæ‰§è¡Œé˜¶æ®µï¼‰å·¥ä½œæ–¹å¼çš„ä¸€ç§è®¤è¯†ã€‚åœ¨ ECMAScriptÂ® 2015 Language Specification ä¹‹å‰çš„ JavaScript æ–‡æ¡£ä¸­æ‰¾ä¸åˆ°å˜é‡æå‡ï¼ˆHoistingï¼‰è¿™ä¸ªè¯ã€‚ä¸è¿‡ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¼€å§‹æ—¶ï¼Œè¿™ä¸ªæ¦‚å¿µå¯èƒ½æ¯”è¾ƒéš¾ç†è§£ï¼Œç”šè‡³æ¼äººã€‚è¿™å°±æ²¡äº†ï¼Ÿå¯¹è¿™å°±æ²¡äº†ï¼å½“çœ‹åˆ°çš„æ—¶å€™åŒæ ·æœ‰è¿™ä¸ªç–‘é—®ï¼Œæ‰€ä»¥æˆ‘åœ¨var æè¿°ä¸­æ‰¾åˆ°äº†è¿™ä¹ˆä¸€å¥è¯ï¼šå˜é‡å£°æ˜ï¼Œæ— è®ºå‘ç”Ÿåœ¨ä½•å¤„ï¼Œéƒ½åœ¨æ‰§è¡Œä»»ä½•ä»£ç ä¹‹å‰è¿›è¡Œå¤„ç†ã€‚æ‰€ä»¥ä»¥ä¸Šä»£ç å¯ä»¥è¢«ç¿»è¯‘æˆè¿™æ ·ï¼š 12345var a;if (false) &#123; a = 1;&#125;console.log(a); 2ã€letæˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹ let çš„å‡ å¤§ç‰¹æ€§ï¼š 1ã€æ²¡æœ‰å£°æ˜æå‡æˆ‘ä»¬é€šè¿‡ä»£ç æ¥çœ‹ä¸€ä¸‹ï¼š 1234if (false) &#123; let a = 1;&#125;console.log(a); æ¬£å–œè‹¥ç‹‚ç»ˆäºå¾—åˆ°äº†æˆ‘ä»¬æƒ³è¦çš„ç»“æœï¼ŒæŠ¥é”™ï¼Œa æ²¡æœ‰è¢«å®šä¹‰ã€‚ 2ã€é‡å¤å£°æ˜æŠ¥é”™12var a = 1;let a = 2; å“‡å¡ï¼ŒæŠ¥é”™äº†ï¼Œæ˜¾ç¤º a å·²ç»è¢«å®šä¹‰è¿‡äº†ï¼Œè¿™ç®€ç›´æ˜¯å¤ªå‹å¥½äº†ï¼Œç»ˆäºä¸ä¼šä¸€ä¸å°å¿ƒå°±æ”¹å˜äº†å…¨å±€å˜é‡ï¼Œä¹Ÿç»ˆäºé¿å…äº†é‡å¤å‘½åçš„å±é™©ã€‚ 3ã€ä¸ç»‘å®šå…¨å±€ä½œç”¨åŸŸ12let a = 1;console.log(window.a); // undefined æ ¹æœ¬æ²¡æœ‰å®šä¹‰åˆ°å…¨å±€ä¸Šï¼Œä¸»è¦è¿˜æ˜¯å› ä¸º let æ˜¯å—çº§ä½œç”¨åŸŸä¸æ˜¯å…¨å±€ä½œç”¨åŸŸã€‚ 3ã€conståœ¨å¼€å‘ä¸­ const æˆ‘ä»¬ä¸€èˆ¬æ˜¯æ¥å®šä¹‰å¸¸é‡ï¼Œå³ä¸å¯æ›´æ”¹çš„é‡ï¼Œå®ƒçš„åŸºæœ¬ç‰¹æ€§å’Œ let æ˜¯å·®ä¸å¤šçš„ã€‚ 12const a = 1;a = 3; æ‰§è¡Œä¸Šè¿°ä»£ç æ—¶ï¼Œä¼šæŠ¥é”™ï¼Œå› ä¸º const å®šä¹‰çš„æ˜¯å¸¸é‡ï¼Œæ— æ³•è¿›è¡Œä¿®æ”¹ã€‚ä½†æ˜¯å½“ const å®šä¹‰çš„æ˜¯å¼•ç”¨æ•°æ®ç±»å‹æ—¶ï¼š 12345const a = &#123; value: 1,&#125;;a.value = 2;console.log(a); // &#123;value: 2&#125; æ„Ÿè§‰æœ‰äº›æ‰“è„¸ï¼Œä½†ç¡®å®å¦‚æ­¤ï¼Œè¿™æ˜¯å› ä¸º const å®šä¹‰çš„å®é™…æ˜¯å¼•ç”¨åœ°å€ï¼Œå®ƒåˆ¤æ–­æ˜¯çš„å¼•ç”¨åœ°å€æ˜¯å¦å‘ç”Ÿå˜åŒ–ï¼Œè™½ç„¶æ”¹å˜äº†å¼•ç”¨æ•°æ®ä¸­çš„æ•°æ®ï¼Œä½†æ˜¯å®ƒçš„å¼•ç”¨åœ°å€å¹¶æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œæ‰€ä»¥å°±å¯ä»¥æ›´æ”¹ï¼Œä½†æ˜¯è¿™ç§æ–¹å¼è¿˜æ˜¯ä¸æå€¡çš„ã€‚","categories":[{"name":"ES6","slug":"ES6","permalink":"https://tomatoesman.github.io/categories/ES6/"}],"tags":[{"name":"ES6","slug":"ES6","permalink":"https://tomatoesman.github.io/tags/ES6/"}]},{"title":"callã€applyå’Œbind","slug":"callã€applyå’Œbind","date":"2020-06-18T15:03:59.000Z","updated":"2020-06-25T11:52:37.088Z","comments":true,"path":"2020/06/18/callã€applyå’Œbind/","link":"","permalink":"https://tomatoesman.github.io/2020/06/18/call%E3%80%81apply%E5%92%8Cbind/","excerpt":"callã€apply å’Œ bind éƒ½æ˜¯å¯¹ this å€¼å¾—æ”¹å˜ï¼Œé‚£ä¸‰è€…æœ‰ä»€ä¹ˆä¸åŒå‘¢ï¼Ÿæœ¬ç¯‡é€šè¿‡æ¨¡æ‹Ÿä¸‰è€…ä»£ç çš„å½¢å¼æ¥è®²è§£ã€‚","text":"callã€apply å’Œ bind éƒ½æ˜¯å¯¹ this å€¼å¾—æ”¹å˜ï¼Œé‚£ä¸‰è€…æœ‰ä»€ä¹ˆä¸åŒå‘¢ï¼Ÿæœ¬ç¯‡é€šè¿‡æ¨¡æ‹Ÿä¸‰è€…ä»£ç çš„å½¢å¼æ¥è®²è§£ã€‚ 1ã€callW3schoolä¸­å¯¹ call()æ–¹æ³•çš„å®šä¹‰æ˜¯ï¼šå®ƒå¯ä»¥ç”¨æ¥è°ƒç”¨æ‰€æœ‰è€…å¯¹è±¡ä½œä¸ºå‚æ•°çš„æ–¹æ³•ã€‚é€šè¿‡ call()ï¼Œèƒ½å¤Ÿä½¿ç”¨å±äºå¦ä¸€ä¸ªå¯¹è±¡çš„æ–¹æ³•ã€‚æˆ‘ä»¬ä¸¾ä¸ªä¾‹å­ï¼š 1234567var foo = &#123; name: \"Jack\",&#125;;function bar() &#123; console.log(this.name);&#125;bar.call(foo); ç”±ä¸Šå¯ä»¥çœ‹å‡º call()å‡½æ•°ä¸»è¦åšäº†ä¸¤ä»¶äº‹ï¼Œç¬¬ä¸€ä¸ªæ˜¯æ”¹å˜ this çš„æŒ‡å‘ï¼Œå°† bar ä¸­çš„ this æŒ‡å‘äº† fooï¼Œç¬¬äºŒä¸ªæ˜¯æ‰§è¡Œäº† bar æ–¹æ³•ã€‚ æ¥ä¸‹æ¥æˆ‘ä»¬æ¥æ¨¡æ‹Ÿ call æ–¹æ³•ï¼š ç¬¬ä¸€æ­¥ï¼šå®ç°ç®€å•çš„ call æ–¹æ³•ï¼šä¸Šé¢çš„ä¾‹å­å¯ä»¥æ”¹é€ ä¸ºï¼š 1234567var foo = &#123; name: \"Jack\", bar: function () &#123; console.log(this.name); &#125;,&#125;;foo.bar(); è¾“å‡ºçš„ç»“æœå’Œä¸Šè¿°çš„ä¸€æ¨¡ä¸€æ ·ï¼Œå”¯ä¸€çš„ä¸åŒå°±æ˜¯ foo ä¸­å¤šäº†ä¸€ä¸ª bar çš„å±æ€§ï¼Œé‚£æˆ‘ä»¬æ‰§è¡Œå®Œååˆ é™¤è¿™ä¸ªå±æ€§å°±å¯ä»¥äº†ã€‚ 123456789101112Function.prototype.myCall = function (Context) &#123; Context.fn = this; // æ­¤æ—¶çš„thisæŒ‡å‘çš„æ˜¯Functionï¼Œå³è°ƒç”¨è€… Context.fn(); delete Context.fn;&#125;;var foo = &#123; name: \"Jack\",&#125;;function bar() &#123; console.log(this.name);&#125;bar.myCall(foo); ç»“æœå’Œ call ä¸€è‡´ã€‚ ç¬¬äºŒæ­¥ï¼šå› ä¸º call å¯ä»¥å¸¦å‚æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬æ¥ä¸‹æ¥å®ç°è¿™ä¸ªçœ‹ä¸€ä¸‹åŸç‰ˆçš„ï¼š 123456789var foo = &#123; name: \"Jack\",&#125;;function bar(age, goods) &#123; console.log(this.name); console.log(age); // 10 console.log(goods); // è‡ªè¡Œè½¦&#125;bar.call(foo, 10, \"è‡ªè¡Œè½¦\"); å› ä¸ºå‚æ•°æ˜¯ä¸å›ºå®šçš„ï¼Œæ‰€ä»¥å¯ä»¥æƒ³åˆ° argumentsã€‚æ€ä¹ˆå°† arguments ä¼ å…¥å¯¹è±¡ä¸­ï¼Œè¿™å°±æ˜¯ä¸ªéš¾é¢˜ï¼Œé«˜å…´çš„æ˜¯ ES6 ç»™äº†æˆ‘ä»¬æ–¹æ³•ï¼šè§£æ„èµ‹å€¼ 123456789101112131415Function.prototype.myCall = function (Context) &#123; Context.fn = this; // æ­¤æ—¶çš„thisæŒ‡å‘çš„æ˜¯Functionï¼Œå³è°ƒç”¨è€… var args = [...arguments].slice(1); Context.fn(...args); delete Context.fn;&#125;;var foo = &#123; name: \"Jack\",&#125;;function bar(age, goods) &#123; console.log(this.name); console.log(age); // 10 console.log(goods); // è‡ªè¡Œè½¦&#125;bar.myCall(foo, 10, \"è‡ªè¡Œè½¦\"); æ˜¯ä¸æ˜¯æ„Ÿè§‰ç‰¹åˆ«ç®€å•ï¼Œä½†æ˜¯ call æ˜¯ ES3 çš„æ–¹æ³•ï¼Œè§£æ„èµ‹å€¼æ˜¯ ES6 çš„æ–¹æ³•ï¼Œæ„Ÿè§‰æœ‰ç‚¹æ¬ºè´Ÿå®ƒï¼Œé‚£æˆ‘ä»¬å°±éœ€è¦é‡æ–°æƒ³ä¸€ä¸ªã€‚è¿™ä¸ªæ–¹æ³•ä¹Ÿæ˜¯æŸ¥çœ‹äº†èµ„æ–™åæ‰æ‰¾åˆ°çš„ï¼Œè‡ªå·±èƒ½åŠ›è¿˜æ˜¯æœ‰é™å•Šï¼å¯ä»¥è¿ç”¨ eval()ï¼Œeval() å‡½æ•°å¯è®¡ç®—æŸä¸ªå­—ç¬¦ä¸²ï¼Œå¹¶æ‰§è¡Œå…¶ä¸­çš„çš„ JavaScript ä»£ç ã€‚ 123456789101112131415161718Function.prototype.myCall = function(Context) &#123; Context.fn = this; // æ­¤æ—¶çš„thisæŒ‡å‘çš„æ˜¯Functionï¼Œå³è°ƒç”¨è€… var args = []; for (var i = 1; i &lt; arguments.length; i++&gt;) &#123; args.push('arguments[+' i '+]'); &#125; eval('Context.fn(+' args '+)'); delete Context.fn;&#125;var foo = &#123; name: 'Jack'&#125;function bar(age, goods) &#123; console.log(this.name); console.log(age); // 10 console.log(goods); // è‡ªè¡Œè½¦&#125;bar.myCall(foo, 10, 'è‡ªè¡Œè½¦'); æ„Ÿè§‰å¾ˆå®Œç¾äº†ï¼Œä½†æ˜¯ä¾æ—§æœ‰ä¸¤å°ç‚¹éœ€è¦æ³¨æ„ï¼š å½“ this ä¸º null æ—¶ å½“å‡½æ•°æœ‰è¿”å›å€¼æ—¶æˆ‘ä»¬å…ˆæ¥çœ‹ç¬¬ä¸€ç‚¹ï¼š 12345var name = \"Jack\";function bar() &#123; console.log(this.name); // Jack&#125;bar.call(null); å½“ this ä¸º null æ—¶ï¼Œé»˜è®¤èµ°å‘ windowç¬¬äºŒç‚¹ï¼š 12345678910var foo = &#123; name: \"Jack\",&#125;;function bar() &#123; return &#123; age: 1, goods: \"è‡ªè¡Œè½¦\", &#125;;&#125;bar.call(foo); // &#123;age: 1, goods: \"è‡ªè¡Œè½¦\"&#125; å½“å‡½æ•°æœ‰è¿”å›å€¼æ—¶ï¼Œç»“æœå°±æ˜¯è¿™ä¸ªè¿”å›å€¼ã€‚ ç¬¬ä¸‰æ­¥ï¼šæˆ‘ä»¬å¯¹è‡ªå·±æ¨¡æ‹Ÿçš„æ–¹æ³•è¿›è¡Œæœ€åçš„ä¼˜åŒ–ï¼š1234567891011Function.prototype.myCall = function (Context) &#123; var Context = Context ? Context : window; Context.fn = this; // æ­¤æ—¶çš„thisæŒ‡å‘çš„æ˜¯Functionï¼Œå³è°ƒç”¨è€… var args = []; for (var i = 1; i &lt; arguments.length; i++) &#123; args.push(\"arguments[\" + i + \"]\"); &#125; var result = eval(\"Context.fn(\" + args + \")\"); delete Context.fn; return result;&#125;; 2ã€applycall() å’Œ apply() ä¹‹é—´çš„åŒºåˆ«ï¼Œä¸åŒä¹‹å¤„æ˜¯ï¼š call() æ–¹æ³•åˆ†åˆ«æ¥å—å‚æ•°ã€‚ apply() æ–¹æ³•æ¥å—æ•°ç»„å½¢å¼çš„å‚æ•°ã€‚ æ‰€ä»¥ call å’Œ apply åªæ˜¯æ¥å—å‚æ•°çš„ä¸åŒï¼Œæ€è·¯è¿˜æ˜¯å’Œ call ä¸€æ ·ï¼Œè¿™æ¬¡å°±ä¸é‡å¤äº†ç›´æ¥è´´ä»£ç ï¼šè¿ç”¨è§£æ„èµ‹å€¼ï¼š 12345678Function.prototype.myApply = function (Context) &#123; var Context = Context ? Context : window; Context.fn = this; // æ­¤æ—¶çš„thisæŒ‡å‘çš„æ˜¯Functionï¼Œå³è°ƒç”¨è€… var args = arguments[1] ? arguments[1] : []; var result = Context.fn(...args); delete Context.fn; return result;&#125;; è¿ç”¨ evalï¼š 12345678910111213141516171819Function.prototype.myApply = function (Context) &#123; var Context = Context ? Context : window; Context.fn = this; // æ­¤æ—¶çš„thisæŒ‡å‘çš„æ˜¯Functionï¼Œå³è°ƒç”¨è€… var args = []; var arguments = arguments[1] ? arguments[1] : []; for (var i = 0; i &lt; arguments.length; i++) &#123; args.push(\"arguments[\" + i + \"]\"); &#125; var result = eval(\"Context.fn(\" + args + \")\"); delete Context.fn; return result;&#125;;var foo = &#123; name: \"Jack\",&#125;;function bar() &#123; console.log(this.name);&#125;bar.myApply(foo); 3ã€bindbind() æ–¹æ³•ä¼šåˆ›å»ºä¸€ä¸ªæ–°å‡½æ•°ï¼Œå½“è¿™ä¸ªæ–°å‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œå®ƒçš„ this å€¼æ˜¯ä¼ é€’ç»™ bind()çš„ç¬¬ä¸€ä¸ªå‚æ•°, å®ƒçš„å‚æ•°æ˜¯ bind()çš„å…¶ä»–å‚æ•°å’Œå…¶åŸæœ¬çš„å‚æ•°ã€‚æ‰€ä»¥ bind æ‰§è¡Œä¸¤ä¸ªæ­¥éª¤ï¼š è¿”å›ä¸€ä¸ªæ–°å‡½æ•° å¯ä»¥ä¼ å…¥å‚æ•° æˆ‘ä»¬æŒ‰ç…§åˆ†æ call()å‡½æ•°ä¸€æ ·çš„æ€è·¯æ¥åˆ†æ bind()ï¼Œé¦–å…ˆçœ‹ä¸€ä¸‹åŸå…ˆçš„ bindï¼š 12345678var foo = &#123; name: \"Jack\",&#125;;function bar() &#123; console.log(this.name);&#125;var bindFoo = bar.bind(foo);bindFoo(); // Jack æ‰€ä»¥å¯ä»¥çœ‹å‡º bar.bind(foo);è¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œå½“è¿™ä¸ªå‡½æ•°æ‰§è¡Œæ—¶ï¼Œæ‰è¿”å›å…¶ä¸­çš„ç»“æœï¼Œé‚£æˆ‘ä»¬å…ˆæ¨¡æ‹Ÿä¸€ä¸‹è¿™ä¸ªï¼š 1234567891011121314Function.prototype.myBind = function (Context) &#123; var self = this; return function () &#123; return self.apply(Context); &#125;;&#125;;var foo = &#123; name: \"Jack\",&#125;;function bar() &#123; console.log(this.name);&#125;var bindFoo = bar.myBind(foo);bindFoo(); // Jack ç»“æœä¸€æ ·ï¼Œè¯´æ˜è¿™ä¸€æ­¥æ¨¡æ‹Ÿçš„æ²¡æœ‰é—®é¢˜ã€‚é‚£æˆ‘ä»¬è¿›è¡Œä¸‹ä¸€æ­¥çš„æ¨¡æ‹Ÿï¼Œå› ä¸º bind ä¹Ÿæ˜¯å¯ä»¥æºå¸¦å‚æ•°çš„ï¼Œæºå¸¦å‚æ•°çš„æ–¹å¼å’Œ call ç›¸åŒï¼š 12345678910var foo = &#123; name: \"Jack\",&#125;;function bar(age, goods) &#123; console.log(this.name); console.log(age); console.log(goods);&#125;var bindFoo = bar.bind(foo, 1, \"1\");bindFoo(); // Jack 1 1 æ¨¡æ‹Ÿæ¿å‡çº§ï¼š 1234567Function.prototype.myBind = function (Context) &#123; var self = this; var args = [].slice.call(arguments, 1); return function () &#123; return self.apply(Context, args); &#125;;&#125;; å¾ˆå®Œç¾ï¼Œä½†æ˜¯ bind æœ‰ä¸ªç‰¹ç‚¹è¢«å¿½è§†äº†ï¼Œå› ä¸º bind è¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œé‚£æˆ‘ä»¬å°†è¿”å›çš„å‡½æ•°é‡Œé¢ä¼ å‚ï¼Œä¼šæœ‰ä»€ä¹ˆæ•ˆæœï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹ï¼š 12345678910var foo = &#123; name: \"Jack\",&#125;;function bar(age, goods) &#123; console.log(this.name); console.log(age); console.log(goods);&#125;var bindFoo = bar.bind(foo, 1);bindFoo(\"1\"); // Jack 1 1 å¯ä»¥çœ‹å‡º bind å¯ä»¥åªä¼ å…¥ ageï¼Œç„¶åå†ä»è¿”å›çš„æ–°å‡½æ•°ä¸­ä¼ å…¥ goodsï¼Œé‚£æˆ‘ä»¬éœ€è¦æŠŠä¸Šè¿°æ¨¡æ‹Ÿè¿›è¡Œå‡çº§ï¼š 12345678Function.prototype.myBind = function (Context) &#123; var self = this; var args = [].slice.call(arguments, 1); return function () &#123; var bindArgs = [].slice.call(arguments); return self.apply(Context, args.concat(bindArgs)); &#125;;&#125;; æ€è·¯å…¶å®å¾ˆç®€å•ï¼Œå°±æ˜¯å°†ä¸¤ä¸ª arguments è¿›è¡Œåˆå¹¶ã€‚æœ¬ä»¥ä¸ºè¿™æ ·å°±ç»“æŸäº†ï¼Œä½†æ˜¯ MDN æåˆ°äº† bind çš„å¦å¤–ä¸€ä¸ªç‰¹ç‚¹ï¼šç»‘å®šå‡½æ•°è‡ªåŠ¨é€‚åº”äºä½¿ç”¨ new æ“ä½œç¬¦å»æ„é€ ä¸€ä¸ªç”±ç›®æ ‡å‡½æ•°åˆ›å»ºçš„æ–°å®ä¾‹ã€‚å½“ä¸€ä¸ªç»‘å®šå‡½æ•°æ˜¯ç”¨æ¥æ„å»ºä¸€ä¸ªå€¼çš„ï¼ŒåŸæ¥æä¾›çš„ this å°±ä¼šè¢«å¿½ç•¥ã€‚ä¸è¿‡æä¾›çš„å‚æ•°åˆ—è¡¨ä»ç„¶ä¼šæ’å…¥åˆ°æ„é€ å‡½æ•°è°ƒç”¨æ—¶çš„å‚æ•°åˆ—è¡¨ä¹‹å‰ã€‚ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿç”¨ä»£ç æ¼”ç¤ºä¸€ä¸‹ï¼š 123456789101112var foo = &#123; name: \"Jack\",&#125;;function bar(age, goods) &#123; console.log(this.name); console.log(age); console.log(goods);&#125;bar.prototype.friends = \"a\";var BindFoo = bar.bind(foo, 1);var bindFoo = new BindFoo(\"1\"); // undefined 1 1console.log(bindFoo.friends); // a this.name ç«Ÿç„¶è¾“å‡º undefinedï¼Œé‚£æ˜¯å› ä¸º new åï¼ŒBindFoo ä¸­ this çš„æŒ‡å‘æ”¹å˜äº†ï¼ŒæŒ‡å‘äº† bindFooï¼Œè€Œ BindFoo å®é™…æ˜¯ bar å‡½æ•°ï¼Œå¹¶ä¸” bindFoo æ²¡æœ‰ value å±æ€§ï¼Œæ‰€ä»¥å°±è¾“å‡ºäº† undefinedï¼Œé€šè¿‡ instanceof å°±å¯ä»¥çœ‹å‡ºæ¥ï¼ŒbindFoo æ˜¯ BindFoo çš„å®ä¾‹ï¼Œä¹Ÿæ˜¯ bar çš„å®ä¾‹ã€‚ 123456789101112131415Function.prototype.myBind = function (Context) &#123; var self = this; var args = [].slice.call(arguments, 1); var cacheFn = function () &#123;&#125;; var bindFun = function () &#123; var bindArgs = [].slice.call(arguments); return self.apply( this instanceof cacheFn ? this : Context, args.concat(bindArgs) ); &#125;; cacheFn.prototype = this.prototype; bindFun.prototype = new cacheFn(); return bindFun;&#125;; æˆ‘ä»¬è¿›è¡Œåˆ†æ­¥è®²è§£ï¼š1ã€ä¸ºä»€ä¹ˆè¦åˆ¤æ–­ this instanceof bindFunï¼Ÿä¹‹å‰ä¹Ÿè¯´åˆ°ï¼Œå½“å°† bind è¿”å›åå‡½æ•°å½“åšæ„é€ å‡½æ•°æ—¶ï¼ŒbindFoo å³æ˜¯ BindFoo çš„å®ä¾‹ä¹Ÿæ˜¯ bar çš„å®ä¾‹ï¼ŒBindFoo å³ä¸ºè¿”å›æ¥çš„å‡½æ•°ï¼Œåœ¨æˆ‘ä»¬æ¨¡æ‹Ÿçš„ä»£ç ä¸­å°±æ˜¯ bindFun è¿™ä¸ªå‡½æ•°ï¼Œå¹¶ä¸”å½“ new ä¹‹å this æŒ‡å‘çš„æ˜¯å®ä¾‹ï¼Œæ‰€ä»¥ç”¨ this instanceof bindFun åˆ¤æ–­çš„å®é™…å°±æ˜¯å‡½æ•°å‰æœ‰æ²¡æœ‰ new è¿™ä¸ªå…³é”®è¯ã€‚2ã€ä¸ºä»€ä¹ˆè¦ç»§æ‰¿ this çš„åŸå‹ï¼Ÿè¿™æ˜¯ä¸ºäº†ç»§æ‰¿ bar åŸå‹ä¸Šçš„å±æ€§ã€‚æœ€åä¸€æ­¥ï¼Œå¥å£®æ¨¡æ‹Ÿçš„ bindï¼Œåˆ¤æ–­ä¼ è¿‡æ¥çš„ this æ˜¯å¦ä¸ºå‡½æ•°ï¼Œä¹Ÿæ˜¯æœ€ç»ˆç‰ˆï¼š 1234567891011121314151617181920Function.prototype.myBind = function (Context) &#123; if (typeof this !== \"function\") &#123; throw new Error( \"Function.prototype.bind - what is trying to be bound is not callable\" ); &#125; var self = this; var args = [].slice.call(arguments, 1); var cacheFn = function () &#123;&#125;; var bindFun = function () &#123; var bindArgs = [].slice.call(arguments); return self.apply( this instanceof cacheFn ? this : Context, args.concat(bindArgs) ); &#125;; cacheFn.prototype = this.prototype; bindFun.prototype = new cacheFn(); return bindFun;&#125;;","categories":[{"name":"JSåŸºç¡€","slug":"JSåŸºç¡€","permalink":"https://tomatoesman.github.io/categories/JS%E5%9F%BA%E7%A1%80/"}],"tags":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://tomatoesman.github.io/tags/%E5%89%8D%E7%AB%AF/"},{"name":"javascript","slug":"javascript","permalink":"https://tomatoesman.github.io/tags/javascript/"}]},{"title":"é—­åŒ…","slug":"é—­åŒ…","date":"2020-06-12T12:54:24.000Z","updated":"2020-06-25T12:03:59.588Z","comments":true,"path":"2020/06/12/é—­åŒ…/","link":"","permalink":"https://tomatoesman.github.io/2020/06/12/%E9%97%AD%E5%8C%85/","excerpt":"æ ¹æ®ã€Šé«˜ç¨‹ã€‹ä¸­æ‰€è®²ï¼šé—­åŒ…æ˜¯æŒ‡æœ‰æƒè®¿é—®å¦ä¸€ä¸ªå‡½æ•°ä½œç”¨åŸŸä¸­çš„å˜é‡çš„å‡½æ•°ã€‚ã€ŠJavascript æƒå¨æŒ‡å—ã€‹ä¸­æŒ‡å‡ºï¼Œä»æŠ€æœ¯è§’åº¦è®²ï¼Œæ‰€æœ‰çš„ javascript å‡½æ•°éƒ½æ˜¯é—­åŒ…ã€‚é—­åŒ…ï¼Œä¹‹å‰æ„Ÿè§‰å¾ˆç¥ç§˜ï¼Œä»Šå¤©æˆ‘ä»¬æ¥æ­å¼€å®ƒçš„é¢çº±ï¼Œçœ‹çœ‹ç©¶ç«Ÿå¹²äº†ä»€ä¹ˆï¼","text":"æ ¹æ®ã€Šé«˜ç¨‹ã€‹ä¸­æ‰€è®²ï¼šé—­åŒ…æ˜¯æŒ‡æœ‰æƒè®¿é—®å¦ä¸€ä¸ªå‡½æ•°ä½œç”¨åŸŸä¸­çš„å˜é‡çš„å‡½æ•°ã€‚ã€ŠJavascript æƒå¨æŒ‡å—ã€‹ä¸­æŒ‡å‡ºï¼Œä»æŠ€æœ¯è§’åº¦è®²ï¼Œæ‰€æœ‰çš„ javascript å‡½æ•°éƒ½æ˜¯é—­åŒ…ã€‚é—­åŒ…ï¼Œä¹‹å‰æ„Ÿè§‰å¾ˆç¥ç§˜ï¼Œä»Šå¤©æˆ‘ä»¬æ¥æ­å¼€å®ƒçš„é¢çº±ï¼Œçœ‹çœ‹ç©¶ç«Ÿå¹²äº†ä»€ä¹ˆï¼ æˆ‘ä»¬ä¸¾ä¸ªä¾‹å­ï¼š 12345678function scope() &#123; let a = 1; return function () &#123; return a; &#125;;&#125;let foo = scope();foo(); æ ¹æ®å‰é¢æ‰€å†™çš„ã€Šæ‰§è¡Œä¸Šä¸‹æ–‡ã€‹ä¸­æˆ‘ä»¬å¯ä»¥æ‰¾åˆ°å½“è§£æä»£ç æ—¶ï¼Œä¼šæ‰§è¡Œä¸Šä¸‹æ–‡æ ˆï¼Œé‚£æˆ‘ä»¬æŒ‰ç…§æ‰§è¡Œä¸Šä¸‹æ–‡æ¥çœ‹ä¸€ä¸‹å‡½æ•°å†…éƒ¨éƒ½åšäº†å“ªäº›äº‹æƒ…ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647var scope = [];scope.push(globalContext = &#123; this: &lt;Global Object&gt;, LE: &#123; ER: &#123; scope: &lt;func&gt;, foo: &lt;uninitialized&gt;, &#125;, outer: null &#125;, VR: &#123; ER: &#123;&#125;, outer: null &#125;&#125;);scope.push(&lt;scope&gt;, scopefunctionContext = &#123; this: &lt;Global Object&gt;, LE: &#123; ER: &#123; arguments: &#123; length: 0 &#125; &#125;, outer: &lt;globalContext&gt; &#125;, VR: &#123; ER: &#123;&#125;, outer: null &#125;&#125;);scope.pop();scope.push(&lt;foo&gt;, foofunctionContext = &#123; this: &lt;Global Object&gt;, LE: &#123; ER: &#123; arguments: &#123; length: 0 &#125; &#125;, outer: &lt;scopefunctionContext&gt; &#125;, VR: &#123; ER: &#123;&#125;, outer: null &#125;&#125;);scope.pop(); å…¶å®ä¼šå¾ˆå¥½å¥‡ï¼Œscope å‡½æ•°æ‰§è¡Œå®Œåæ˜æ˜å·²ç»åœ¨æ‰§è¡Œæ ˆä¸­ç§»é™¤äº†ï¼Œä¸ºä»€ä¹ˆ foo å‡½æ•°ä¾æ—§èƒ½è®¿é—®åˆ°å…¶å†…éƒ¨çš„å˜é‡ã€‚æ˜¯å› ä¸º foo å‡½æ•°çš„å¯¹å¤–éƒ¨å¼•ç”¨æ˜¯ scope çš„è¯æ³•ç¯å¢ƒï¼Œè¿™ä¸ªç¯å¢ƒè¿˜æ²¡æœ‰æ¶ˆå¤±ã€‚æ­£å› ä¸º JS æœ‰è¿™ä¸ªç‰¹ç‚¹ï¼Œæ‰€ä»¥æ‰ä¼šç”Ÿæˆé—­åŒ…è¿™ä¸ªæ¦‚å¿µã€‚ ä¸‹é¢ä¸¾å‡ ä¸ªå¸¸ç”¨çš„é¢è¯•é¢˜ï¼Œæ¥è‡ªã€Šé«˜ç¨‹ã€‹ï¼š 123456789101112function createFunctions() &#123; var result = new Array(); for (var i = 0; i &lt; 10; i++) &#123; result[i] = function () &#123; console.log(i); &#125;; &#125; return result;&#125;createFunctions().forEach((item) =&gt; &#123; item();&#125;); è¿è¡Œä¸Šè¿°ä¹‹åï¼Œå‘ç°æœ€åè¾“å‡º 10 ä¸ª 10ï¼Œä¸ºä»€ä¹ˆä¸æ˜¯ 0-9 å‘¢ï¼Ÿæˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹ï¼Œå·² result[0]ä¸ºä¾‹ï¼Œåœ¨ result[0]è¿è¡Œä¹‹å‰ï¼Œå…¨å±€ä¸Šä¸‹æ–‡æ˜¯è¿™æ ·çš„ï¼š 1234567891011121314151617var scope = [];scope.push(globalContext = &#123; this: &lt;Global Object&gt;, LE: &#123; ER: &#123; createFunctions: &lt;func&gt;, &#125;, outer: null &#125;, VR: &#123; ER: &#123; result: [....], i: 10 &#125;, outer: null &#125;&#125;) å½“ result[0]è¿è¡Œæ—¶ï¼Œå®ƒçš„å‡½æ•°ä¸Šä¸‹æ–‡å‘ç”Ÿå˜åŒ–ï¼š 1234567891011functionContext = &#123; this: &lt;Global Object&gt;, LE: &#123; ER: &#123;&#125;, outer: &lt;createFunctionsContext&gt; &#125;, VR: &#123; ER: &#123;&#125;, outer: &lt;createFunctionsContext&gt; &#125;&#125; ç”±äº result[0]ä¸­æ²¡æœ‰å®šä¹‰ iï¼Œæ‰€ä»¥å°±ä¼šå‘å¤–éƒ¨çš„è¯æ³•ç¯å¢ƒä¸­æŸ¥æ‰¾ï¼Œæœ€åæ‰¾åˆ° iï¼Œè¾“å‡º 10ã€‚ å¦‚æœæƒ³è¾“å‡ºé¢„æœŸç»“æœ 0-9ï¼Œé«˜ç¨‹ä¸­ä¹Ÿç»™å‡ºäº†è§£å†³æ–¹æ¡ˆï¼š 1234567891011121314function createFunctions() &#123; var result = new Array(); for (var i = 0; i &lt; 10; i++) &#123; result[i] = (function (num) &#123; return function () &#123; console.log(num); &#125;; &#125;)(i); &#125; return result;&#125;createFunctions().forEach((item) =&gt; &#123; item();&#125;); å½“å†æ¬¡æ‰§è¡Œ result[0]æ—¶ï¼Œè¿™ä¸ªåŒ¿åå‡½æ•°çš„ä¸Šä¸‹æ–‡ï¼š 12345678910111213141516171819functionContext = &#123; this: &lt;Global Object&gt;, LE: &#123; ER: &#123; åŒ¿åfunction: &lt;func&gt; &#125;, outer: &lt;createFunctionsContext&gt; &#125;, VR: &#123; ER: &#123; arguments: &#123; 0: 0, length: 1 &#125;, num: 0 &#125;, outer: &lt;createFunctionsContext&gt; &#125;&#125; å½“åŒ¿åå‡½æ•°æ‰§è¡Œæ—¶ï¼š 12345678910111213141516åŒ¿åfunctionContext = &#123; this: &lt;Global Object&gt;, LE: &#123; ER: &#123;&#125;, outer: &lt;functionContext&gt; &#125;, VR: &#123; ER: &#123; arguments: &#123; length: 0 &#125;, num: 0 &#125;, outer: &lt;functionContext&gt; &#125;&#125; åŒæ ·å…¶å†…éƒ¨æ²¡æœ‰ num å˜é‡ï¼Œé‚£å®ƒå°±ä¼šå»å¤–éƒ¨çš„æ­¤æ³•ç¯å¢ƒä¸­æŸ¥æ‰¾ï¼Œæ‰¾åˆ°äº† functionContextï¼ŒfunctionContext å†…éƒ¨çš„ num ä¸º 0ï¼Œåˆ™è¾“å‡º 0ã€‚è¿™æ ·å°±å®Œç¾è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œä¹Ÿä½“ç°äº†é—­åŒ…çš„ä½œç”¨ï¼Œä½†ç°åœ¨æœ‰ let äº†è¿™ç§å°±ç”¨çš„å¾ˆå°‘äº†ã€‚é—­åŒ…è™½ç„¶èƒ½è§£å†³ä¸€äº›é—®é¢˜ï¼Œä½†æ˜¯å°½é‡è¿˜æ˜¯è¦å°‘ç”¨é—­åŒ…ï¼Œå› ä¸ºå…¶å¤–éƒ¨çš„è¯æ³•ç¯å¢ƒå·²ç»é”€æ¯äº†ï¼Œä½†å…¶å†…éƒ¨è¿˜åœ¨å¼•ç”¨ï¼Œè¿™æ ·çš„è¯é—­åŒ…è¿‡å¤šä¼šé€ æˆå†…å­˜æ³„æ¼ï¼Œæœ€ç®€å•ç›´æ¥çš„åŠæ³•å°±æ˜¯ï¼Œæ‰§è¡Œå®Œåè®¾ç½®ä¸º nullï¼Œè¿™æ ·å°±é”€æ¯äº†ã€‚","categories":[{"name":"JSåŸºç¡€","slug":"JSåŸºç¡€","permalink":"https://tomatoesman.github.io/categories/JS%E5%9F%BA%E7%A1%80/"}],"tags":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://tomatoesman.github.io/tags/%E5%89%8D%E7%AB%AF/"},{"name":"javascript","slug":"javascript","permalink":"https://tomatoesman.github.io/tags/javascript/"}]},{"title":"æ‰§è¡Œä¸Šä¸‹æ–‡","slug":"æ‰§è¡Œä¸Šä¸‹æ–‡","date":"2020-05-29T14:36:39.000Z","updated":"2020-06-25T12:03:48.155Z","comments":true,"path":"2020/05/29/æ‰§è¡Œä¸Šä¸‹æ–‡/","link":"","permalink":"https://tomatoesman.github.io/2020/05/29/%E6%89%A7%E8%A1%8C%E4%B8%8A%E4%B8%8B%E6%96%87/","excerpt":"ä¸Šç¯‡ä»‹ç»å®Œ JS çš„ä½œç”¨åŸŸï¼Œé‚£æ¥ä¸‹æ¥çš„å‡ ç¯‡å°±è¦è®²è®²è·Ÿä½œç”¨åŸŸç›¸å…³çš„å†…å®¹äº†ã€‚","text":"ä¸Šç¯‡ä»‹ç»å®Œ JS çš„ä½œç”¨åŸŸï¼Œé‚£æ¥ä¸‹æ¥çš„å‡ ç¯‡å°±è¦è®²è®²è·Ÿä½œç”¨åŸŸç›¸å…³çš„å†…å®¹äº†ã€‚ 1ã€æ‰§è¡Œä¸Šä¸‹æ–‡æ‰§è¡Œä¸Šä¸‹æ–‡å°±æ˜¯å½“å‰ JavaScript ä»£ç è¢«è§£æå’Œæ‰§è¡Œæ—¶æ‰€åœ¨ç¯å¢ƒçš„æŠ½è±¡æ¦‚å¿µï¼Œ JavaScript ä¸­è¿è¡Œä»»ä½•çš„ä»£ç éƒ½æ˜¯åœ¨æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­è¿è¡Œã€‚ æ‰§è¡Œä¸Šä¸‹æ–‡ç±»å‹é˜…æ–‡å‰ç«¯å›¢é˜Ÿç¿»è¯‘çš„ã€Šç†è§£ Javascript æ‰§è¡Œä¸Šä¸‹æ–‡å’Œæ‰§è¡Œæ ˆã€‹ä¸­æ‰€è¯´ï¼š å…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡ï¼šè¿™æ˜¯é»˜è®¤çš„ã€æœ€åŸºç¡€çš„æ‰§è¡Œä¸Šä¸‹æ–‡ã€‚ä¸åœ¨ä»»ä½•å‡½æ•°ä¸­çš„ä»£ç éƒ½ä½äºå…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­ã€‚å®ƒåšäº†ä¸¤ä»¶äº‹ï¼š1. åˆ›å»ºä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼Œåœ¨æµè§ˆå™¨ä¸­è¿™ä¸ªå…¨å±€å¯¹è±¡å°±æ˜¯ window å¯¹è±¡ã€‚2. å°† this æŒ‡é’ˆæŒ‡å‘è¿™ä¸ªå…¨å±€å¯¹è±¡ã€‚ä¸€ä¸ªç¨‹åºä¸­åªèƒ½å­˜åœ¨ä¸€ä¸ªå…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡ã€‚ å‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡ï¼šæ¯æ¬¡è°ƒç”¨å‡½æ•°æ—¶ï¼Œéƒ½ä¼šä¸ºè¯¥å‡½æ•°åˆ›å»ºä¸€ä¸ªæ–°çš„æ‰§è¡Œä¸Šä¸‹æ–‡ã€‚æ¯ä¸ªå‡½æ•°éƒ½æ‹¥æœ‰è‡ªå·±çš„æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œä½†æ˜¯åªæœ‰åœ¨å‡½æ•°è¢«è°ƒç”¨çš„æ—¶å€™æ‰ä¼šè¢«åˆ›å»ºã€‚ä¸€ä¸ªç¨‹åºä¸­å¯ä»¥å­˜åœ¨ä»»æ„æ•°é‡çš„å‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡ã€‚æ¯å½“ä¸€ä¸ªæ–°çš„æ‰§è¡Œä¸Šä¸‹æ–‡è¢«åˆ›å»ºï¼Œå®ƒéƒ½ä¼šæŒ‰ç…§ç‰¹å®šçš„é¡ºåºæ‰§è¡Œä¸€ç³»åˆ—æ­¥éª¤ï¼Œå…·ä½“è¿‡ç¨‹å°†åœ¨æœ¬æ–‡åé¢è®¨è®ºã€‚ eval å‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡ï¼šè¿è¡Œåœ¨ eval å‡½æ•°ä¸­çš„ä»£ç ä¹Ÿè·å¾—äº†è‡ªå·±çš„æ‰§è¡Œä¸Šä¸‹æ–‡ã€‚ 2ã€æ‰§è¡Œä¸Šä¸‹æ–‡æ ˆæ‰§è¡Œæ ˆï¼Œåœ¨å…¶ä»–ç¼–ç¨‹è¯­è¨€ä¸­ä¹Ÿè¢«å«åšè°ƒç”¨æ ˆï¼Œå…·æœ‰ LIFOï¼ˆåè¿›å…ˆå‡ºï¼‰ç»“æ„ï¼Œç”¨äºå­˜å‚¨åœ¨ä»£ç æ‰§è¡ŒæœŸé—´åˆ›å»ºçš„æ‰€æœ‰æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œè¿™ä¸å †æ ˆä¸­æ ˆçš„åŸç†ç±»ä¼¼ã€‚ å½“ JS å¼•æ“å¼€å§‹ç¼–è¯‘ JS ä»£ç æ—¶ï¼Œä¼šåˆ›å»ºä¸€ä¸ªå…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡å‹å…¥åˆ°æ‰§è¡Œä¸Šä¸‹æ–‡æ ˆçš„æœ€é¡¶å±‚ï¼Œå½“è°ƒç”¨ä¸€ä¸ªå‡½æ•°æ—¶ï¼Œå°±ä¼šåˆ›å»ºä¸€ä¸ªå‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡å‹å…¥æ‰§è¡Œä¸Šä¸‹æ–‡æ ˆçš„æœ€é¡¶å±‚ã€‚ å½“æœ€æ–°çš„å‡½æ•°æ‰§è¡Œå®Œæ¯•åï¼Œå…¶æ‰§è¡Œä¸Šä¸‹æ–‡å°†ä¼šä»æ‰§è¡Œä¸Šä¸‹æ–‡æ ˆå¼¹å‡ºï¼Œç„¶åå°†æ‰§è¡Œä¸‹ä¸€ä¸ªå‡½æ•°ã€‚ æˆ‘ä»¬å¯ä»¥å°†æ‰§è¡Œä¸Šä¸‹æ–‡æ ˆæ¨¡æ‹Ÿä¸ºä¸€ä¸ªç©ºæ•°ç»„ï¼š 1stack = []; é€šè¿‡ä¸‹ä¸ªä¾‹å­æ¥ç†è§£ä¸€ä¸‹ï¼š 1234567891011121314var a = 1;function foo1() &#123; console.log(a);&#125;function foo2() &#123; foo1();&#125;function foo3() &#123; foo2();&#125;foo3(); å½“æ‰§è¡Œä¸Šè¿°ä¾‹å­æ—¶ï¼Œå…ˆå°†å…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡æ¨å…¥æ‰§è¡Œä¸Šä¸‹æ–‡æ ˆ 1stack = [globalContext]; å½“å‡½æ•°è°ƒç”¨çš„æ—¶å€™å¼€å§‹æ‰§è¡Œå‡½æ•°ä¸Šä¸‹æ–‡ï¼š 123456789101112stack.push(&lt;foo3&gt;, functionContext);// foo3å‡½æ•°ä¸­è°ƒç”¨äº†foo2stack.push(&lt;foo2&gt;, functionContext);// foo2å‡½æ•°ä¸­è°ƒç”¨äº†foo1stack.push(&lt;foo1&gt;, functionContext);// foo1æ‰§è¡Œå®Œæ¯•stack.pop();// foo2æ‰§è¡Œå®Œæ¯•stack.pop();// foo1æ‰§è¡Œå®Œæ¯•stack.pop();// ä¹‹åå†æ‰§è¡Œæ–°çš„ä»£ç ï¼Œä½†åº•å±‚æ°¸è¿œç•™æœ‰ä¸€ä¸ªglobalContext 3ã€æ‰§è¡Œä¸Šä¸‹æ–‡çš„åˆ›å»ºåœ¨æ‰§è¡Œä¸Šä¸‹æ–‡åˆ›å»ºçš„æ—¶å€™ï¼Œåˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼š1ã€åˆ›å»ºé˜¶æ®µ 2ã€æ‰§è¡Œé˜¶æ®µ 3.1ã€åˆ›å»ºé˜¶æ®µåˆ›å»ºé˜¶æ®µæœ‰ä¸‰ä¸ªé‡è¦çš„å±æ€§ï¼š this è¯æ³•ç¯å¢ƒï¼ˆä½œç”¨åŸŸé“¾ï¼‰ å˜é‡ç¯å¢ƒ 3.1.1ã€thisåœ¨å…¨å±€ä¸Šä¸‹æ–‡ä¸­ï¼Œthis æŒ‡å‘çš„æ˜¯å…¨å±€å¯¹è±¡ï¼Œåœ¨æµè§ˆå™¨ä¸­ï¼ŒæŒ‡å‘çš„æ˜¯ windowåœ¨å‡½æ•°ä¸Šä¸‹æ–‡ä¸­ï¼Œthis æŒ‡å‘çš„æ˜¯å‡½æ•°çš„è°ƒç”¨æ–¹ï¼Œå¦‚æœæ˜¯å¯¹è±¡è°ƒç”¨è¯¥å‡½æ•°ï¼Œåˆ™æŒ‡å‘çš„æ˜¯è¿™ä¸ªå¯¹è±¡ï¼Œå¦åˆ™ this æŒ‡å‘çš„æ˜¯å…¨å±€å¯¹è±¡æˆ–è€… undefinedï¼ˆä¸¥æ ¼æ¨¡å¼ï¼‰ 123456789101112let person = &#123; name: \"Jack\", eat: function () &#123; console.log(this.name); &#125;,&#125;;person.eat(); // æ­¤æ—¶çš„thisæŒ‡å‘personï¼Œå› ä¸ºæ˜¯personè°ƒç”¨çš„è¯¥å‡½æ•°function foo() &#123; console.log(this);&#125;foo(); // æ­¤æ—¶çš„thisæŒ‡å‘window 3.1.2ã€è¯æ³•ç¯å¢ƒï¼ˆä½œç”¨åŸŸé“¾ï¼‰è¯æ³•ç¯å¢ƒæ˜¯ä¸€ä¸ªåŒ…å«æ ‡è¯†ç¬¦å˜é‡æ˜ å°„çš„ç»“æ„ã€‚ï¼ˆè¿™é‡Œçš„æ ‡è¯†ç¬¦è¡¨ç¤ºå˜é‡/å‡½æ•°çš„åç§°ï¼Œå˜é‡æ˜¯å¯¹å®é™…å¯¹è±¡ã€åŒ…æ‹¬å‡½æ•°ç±»å‹å¯¹è±¡ã€‘æˆ–åŸå§‹å€¼çš„å¼•ç”¨ï¼‰ è¯æ³•ç¯å¢ƒåŒ…æ‹¬ä¸¤ä¸ªéƒ¨åˆ†ï¼š ç¯å¢ƒè®°å½•ï¼šå­˜å‚¨å˜é‡å’Œå‡½æ•°å£°æ˜çš„å®é™…ä½ç½® å¯¹å¤–éƒ¨ç¯å¢ƒçš„å¼•ç”¨ï¼šæ„å‘³ç€å¯ä»¥è®¿é—®å…¶å¤–éƒ¨çš„è¯æ³•å˜é‡ åœ¨å…¨å±€ä¸Šä¸‹æ–‡ä¸­ï¼Œå¯¹å¤–ç¯å¢ƒçš„å¼•ç”¨ä¸º nullï¼Œå®ƒæ‹¥æœ‰ä¸€ä¸ªå…¨å±€çš„å¯¹è±¡ï¼ˆwindowd å¯¹è±¡ï¼‰ä»¥åŠå…¶å…³è”çš„å±æ€§å’Œæ–¹æ³•å’Œç”¨æˆ·è‡ªå®šä¹‰çš„å…¨å±€å˜é‡ã€‚ åœ¨å‡½æ•°ä¸Šä¸‹æ–‡ä¸­ï¼Œç”¨æˆ·è‡ªå®šä¹‰çš„å˜é‡å­˜å‚¨åœ¨ç¯å¢ƒè®°å½•ä¸­ï¼Œå¯¹å¤–éƒ¨ç¯å¢ƒçš„å¼•ç”¨å¯ä»¥æ˜¯å…¨å±€ç¯å¢ƒï¼Œä¹Ÿå¯ä»¥æ˜¯åŒ…å«å†…éƒ¨å‡½æ•°çš„å¤–éƒ¨å‡½æ•°ç¯å¢ƒã€‚å¦å¤–åœ¨å‡½æ•°ä¸Šä¸‹æ–‡åˆ›å»ºæ—¶ï¼Œåœ¨å…¶ç¯å¢ƒè®°å½•ä¸­è¿˜ä¼šç”Ÿæˆä¸€ä¸ª arguments å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åŒ…å«äº†ç´¢å¼•å’Œä¼ é€’ç»™å‡½æ•°çš„å‚æ•°ä¹‹é—´çš„æ˜ å°„ä»¥åŠä¼ é€’ç»™å‡½æ•°çš„å‚æ•°çš„é•¿åº¦ï¼ˆæ•°é‡ï¼‰ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š 123456function add(a, b) &#123; return a + b;&#125;add(2, 3);// argumentså¯¹è±¡Arguments: &#123;0: 2, 1: 3, length: 2&#125; æˆ‘ä»¬ä»¥ä¸€ä¸ªä¾‹å­ï¼Œå¹¶ç”¨ä¼ªä»£ç æ¥çœ‹ä¸€ä¸‹åœ¨è¯æ³•ç¯å¢ƒä¸­ JS å†…éƒ¨éƒ½åšäº†ä»€ä¹ˆï¼š 123456var a, b = 1;function foo(a, b) &#123; return a + b;&#125;foo(2, 3); æˆ‘ä»¬ç”¨ ER ä»£è¡¨ç¯å¢ƒè®°å½•ï¼Œç”¨ outer ä»£è¡¨å¯¹å¤–éƒ¨ç¯å¢ƒçš„å¼•ç”¨ï¼Œä¼ªä»£ç å†™æˆï¼š 1234567891011121314151617181920å…¨å±€ä¸Šä¸‹æ–‡ï¼šGlobalExectionContext = &#123; ER: &#123; a, b, foo &#125;, outer: null&#125;å½“è¿è¡Œå‡½æ•°æ—¶ï¼Œä¼šäº§ç”Ÿå‡½æ•°ä¸Šä¸‹æ–‡ï¼šFunctionExectionContext = &#123; ER: &#123; arguments: &#123; 0: 2, 1: 3, length: 2 &#125; &#125;, outer: &lt;GlobalExectionContext&gt;&#125; åœ¨ ES8 ä¸­è§„å®šç¯å¢ƒè®°å½•åŒæ ·æ‹¥æœ‰ä¸¤ä¸ªç±»å‹ï¼š å£°æ˜æ€§ç¯å¢ƒè®°å½•ï¼šå­˜å‚¨å˜é‡ã€å‡½æ•°å’Œå‚æ•°ã€‚ä¸€ä¸ªå‡½æ•°ç¯å¢ƒåŒ…å«å£°æ˜æ€§ç¯å¢ƒè®°å½•ã€‚ å¯¹è±¡ç¯å¢ƒè®°å½•ï¼šç”¨äºå®šä¹‰åœ¨å…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­å‡ºç°çš„å˜é‡å’Œå‡½æ•°çš„å…³è”ã€‚å…¨å±€ç¯å¢ƒåŒ…å«å¯¹è±¡ç¯å¢ƒè®°å½•ã€‚ 3.1.3ã€å˜é‡ç¯å¢ƒå˜é‡ç¯å¢ƒä¹Ÿæ˜¯ä¸€ä¸ªè¯æ³•ç¯å¢ƒï¼Œæ‰€ä»¥ä»–åŒ…å«äº†è¯æ³•ç¯å¢ƒçš„æ‰€æœ‰ç‰¹æ€§ï¼Œåœ¨ ES6 ä¸­å˜é‡ç¯å¢ƒåŒ…æ‹¬ä¸¤ä¸ªä¸€ä¸ªæ˜¯ LexicalEnvironment ç»„ä»¶å¦ä¸€ä¸ªæ˜¯ VariableEnvironment ç»„ä»¶ï¼Œä»–ä¿©çš„åŒºåˆ«åœ¨äºå‰è€…ç”¨äºå­˜å‚¨å‡½æ•°å£°æ˜å’Œå˜é‡ï¼ˆ let å’Œ const ï¼‰ç»‘å®šï¼Œè€Œåè€…ä»…ç”¨äºå­˜å‚¨å˜é‡ï¼ˆ var ï¼‰ç»‘å®šã€‚ è¿™æ ·æˆ‘ä»¬å†ä¸¾ä¾‹æ¥çœ‹ä¸€ä¸‹ JS å†…éƒ¨ç©¶ç«Ÿå¹²äº†ä»€ä¹ˆï¼š 1234567let a = 1;const b = 2;var c;function add(a, b) &#123; return a + b;&#125;c = add(1, 3); æˆ‘ä»¬åŒæ ·ç”¨ä¼ªä»£ç æ¥æ¨¡æ‹Ÿä¸€ä¸‹å—ï¼Œç”¨ LE ä»£è¡¨ LexicalEnvironmentï¼Œç”¨ VE ä»£è¡¨ VariableEnvironmentï¼š 123456789101112131415161718192021222324252627282930313233343536å…¨å±€ä¸Šä¸‹æ–‡ï¼šGlobalExectionContext = &#123; this: &lt;Global Object&gt;, LE: &#123; ER: &#123; a: &lt;uninitialized&gt;, b: &lt;uninitialized&gt;, add: &lt;func&gt; &#125;, outer: null, &#125;, VE: &#123; ER: &#123; c: undefined &#125;, outer: null, &#125;&#125;å½“è°ƒç”¨addæ—¶ï¼Œç”Ÿæˆå‡½æ•°ä¸Šä¸‹æ–‡ï¼šFunctionExectionContext = &#123; this: &lt;Global Object&gt;, LE: &#123; ER: &#123; arguments: &#123; 0: 1, 1: 3, length: 2 &#125; &#125;, outer: &lt;GlobalExectionContext&gt;, &#125;, VE: &#123; ER: null, outer: &lt;GlobalExectionContext&gt;, &#125;&#125; æ­¤æ—¶ä½ ä¸€å®šä¼šå¯¹ letã€constã€var çš„å€¼æœ‰ä¸€ä¸ªç–‘æƒ‘ï¼Œé‚£æ˜¯å› ä¸ºåœ¨åˆ›å»ºé˜¶æ®µçš„æ—¶å€™ï¼Œä»£ç ä¼šè¢«æ‰«æå’Œè§£ææˆå˜é‡å’Œå‡½æ•°å£°æ˜ï¼Œå‡½æ•°å£°æ˜å­˜å‚¨åœ¨ç¯å¢ƒä¸­ï¼Œè€Œ var ä¼šè¢«å®šä¹‰ä¸º undefinedï¼Œlet å’Œ const ä¼šè¢«å®šä½ä¸º uninitializedï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆä½ å¯ä»¥åœ¨å£°æ˜ä¹‹å‰è®¿é—® var å®šä¹‰çš„å˜é‡ï¼ˆå°½ç®¡æ˜¯ undefined ï¼‰ï¼Œä½†å¦‚æœåœ¨å£°æ˜ä¹‹å‰è®¿é—® let å’Œ const å®šä¹‰çš„å˜é‡å°±ä¼šæç¤ºå¼•ç”¨é”™è¯¯çš„åŸå› ï¼Œè¿™ä¸ªé”™è¯¯å°±æ˜¯æš‚æ—¶æ€§æ­»åŒºæˆ–è€…å«åšä¸´æ—¶æ­»äº¡ï¼ˆTDZï¼‰ï¼ŒåŸå› å°±æ˜¯åœ¨è®¿é—®ä¸€ä¸ªå·²ç»å£°æ˜ä½†æ²¡æœ‰åˆå§‹åŒ–çš„å˜é‡ã€‚ 3.2ã€æ‰§è¡Œé˜¶æ®µåœ¨æ­¤é˜¶æ®µï¼Œå®Œæˆå¯¹æ‰€æœ‰å˜é‡çš„åˆ†é…ï¼Œæœ€åæ‰§è¡Œä»£ç ã€‚æ³¨ï¼šåœ¨æ‰§è¡Œé˜¶æ®µï¼Œå¦‚æœ Javascript å¼•æ“åœ¨æºä»£ç ä¸­å£°æ˜çš„å®é™…ä½ç½®æ‰¾ä¸åˆ° let å˜é‡çš„å€¼ï¼Œé‚£ä¹ˆå°†ä¸ºå…¶åˆ†é… undefined å€¼ã€‚ è¿™ç¯‡æŸ¥é˜…äº†å¾ˆå¤šç›¸å…³èµ„æ–™ï¼Œä½†æ˜¯è§‰å¾—å¾ˆå¤šè¿˜æ˜¯ç†è§£çš„ä¸æ˜¯å¾ˆé€å½»ï¼Œä»Šåæœ‰æ—¶é—´ä¼šç»§ç»­è¡¥å……ï¼Œä¹Ÿå¸Œæœ›å¤§å®¶èƒ½å¤šç»™äº›è¯„ä»·ã€‚ å‚è€ƒï¼šã€è¯‘ã€‘ç†è§£ Javascript æ‰§è¡Œä¸Šä¸‹æ–‡å’Œæ‰§è¡Œæ ˆ","categories":[{"name":"JSåŸºç¡€","slug":"JSåŸºç¡€","permalink":"https://tomatoesman.github.io/categories/JS%E5%9F%BA%E7%A1%80/"}],"tags":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://tomatoesman.github.io/tags/%E5%89%8D%E7%AB%AF/"},{"name":"javascript","slug":"javascript","permalink":"https://tomatoesman.github.io/tags/javascript/"}]},{"title":"ä½œç”¨åŸŸ","slug":"ä½œç”¨åŸŸ","date":"2020-05-29T14:14:37.000Z","updated":"2020-06-25T12:03:40.106Z","comments":true,"path":"2020/05/29/ä½œç”¨åŸŸ/","link":"","permalink":"https://tomatoesman.github.io/2020/05/29/%E4%BD%9C%E7%94%A8%E5%9F%9F/","excerpt":"ä½•ä¸ºä½œç”¨åŸŸï¼ŒæŸ¥æ‰¾åº¦å¨˜ç™¾ç§‘ä¸­æ˜¯è¿™ä¹ˆå®šä¹‰çš„ï¼š ä½œç”¨åŸŸï¼ˆscopeï¼‰ï¼Œç¨‹åºè®¾è®¡æ¦‚å¿µï¼Œé€šå¸¸æ¥è¯´ï¼Œä¸€æ®µç¨‹åºä»£ç ä¸­æ‰€ç”¨åˆ°çš„åå­—å¹¶ä¸æ€»æ˜¯æœ‰æ•ˆ/å¯ç”¨çš„ï¼Œè€Œé™å®šè¿™ä¸ªåå­—çš„å¯ç”¨æ€§çš„ä»£ç èŒƒå›´å°±æ˜¯è¿™ä¸ªåå­—çš„ä½œç”¨åŸŸã€‚","text":"ä½•ä¸ºä½œç”¨åŸŸï¼ŒæŸ¥æ‰¾åº¦å¨˜ç™¾ç§‘ä¸­æ˜¯è¿™ä¹ˆå®šä¹‰çš„ï¼š ä½œç”¨åŸŸï¼ˆscopeï¼‰ï¼Œç¨‹åºè®¾è®¡æ¦‚å¿µï¼Œé€šå¸¸æ¥è¯´ï¼Œä¸€æ®µç¨‹åºä»£ç ä¸­æ‰€ç”¨åˆ°çš„åå­—å¹¶ä¸æ€»æ˜¯æœ‰æ•ˆ/å¯ç”¨çš„ï¼Œè€Œé™å®šè¿™ä¸ªåå­—çš„å¯ç”¨æ€§çš„ä»£ç èŒƒå›´å°±æ˜¯è¿™ä¸ªåå­—çš„ä½œç”¨åŸŸã€‚ 1ã€é™æ€ä½œç”¨åŸŸï¼ˆè¯æ³•ä½œç”¨åŸŸï¼‰é€šå¸¸æ¥è¯´ JS æ˜¯é™æ€ä½œç”¨åŸŸï¼Œå‡½æ•°çš„ä½œç”¨åŸŸåœ¨å‡½æ•°å®šä¹‰çš„æ—¶å€™å°±å·²ç»ç¡®å®šäº†ã€‚å¯ä»¥ä¸¾ä¸ªä¾‹å­ï¼š 123456789var scope = 1;function foo() &#123; console.log(scope);&#125;function bar() &#123; var scope = 2; foo();&#125;bar(); æœ€åè¾“å‡ºä¸º 1ï¼Œå› ä¸º JS æ˜¯é™æ€ä½œç”¨åŸŸï¼Œæ‰€ä»¥ foo å‡½æ•°çš„ä½œç”¨åŸŸåœ¨å…¶å®šä¹‰çš„æ—¶å€™å°±è¢«ç¡®å®šäº†ï¼Œå½“åœ¨ bar å‡½æ•°ä¸­æ‰§è¡Œ foo()æ—¶ï¼Œæ²¡æœ‰å»æŸ¥æ‰¾ bar ä¸­çš„ scope å˜é‡ï¼Œè€Œæ˜¯å»æŸ¥æ‰¾ foo å‡½æ•°ä¸­çš„ scopeï¼Œå½“ foo å‡½æ•°ä¸­æ²¡æœ‰æ‰¾åˆ°è¿™ä¸ªå˜é‡çš„æ—¶å€™ä»–ä¼šåœ¨å…¨å±€ä¸­æŸ¥æ‰¾ï¼Œæ‰€ä»¥æœ€åè¾“å‡º 1ã€‚ 2ã€åŠ¨æ€ä½œç”¨åŸŸå‡½æ•°çš„ä½œç”¨åŸŸåœ¨å‡½æ•°è°ƒç”¨çš„æ—¶å€™æ‰å†³å®šã€‚å…¶å®å¤§éƒ¨åˆ†çš„è¯­è¨€éƒ½æ˜¯åŸºäºé™æ€ä½œç”¨åŸŸçš„ï¼Œå¦‚æœ JS æ˜¯åŠ¨æ€ä½œç”¨åŸŸçš„è¯ï¼Œé‚£ä¸Šè¿°ä¾‹å­æœ€åçš„ç»“æœåº”è¯¥æ˜¯ 2 è€Œä¸æ˜¯ 1ï¼Œå› ä¸ºå½“ foo()æ— æ³•æ‰¾åˆ° scope çš„å˜é‡å¼•ç”¨æ—¶ï¼Œä¼šé¡ºç€è°ƒç”¨æ ˆåœ¨è°ƒç”¨ foo()çš„åœ°æ–¹æŸ¥æ‰¾ scopeï¼Œè€Œä¸æ˜¯åœ¨åµŒå¥—çš„è¯æ³•ä½œç”¨åŸŸé“¾ä¸­å‘ä¸ŠæŸ¥æ‰¾ã€‚ç”±äº foo()æ˜¯åœ¨ bar()ä¸­è°ƒç”¨çš„ï¼Œå¼•æ“ä¼šæ£€æŸ¥ bar()çš„ä½œç”¨åŸŸï¼Œå¹¶åœ¨å…¶ä¸­æ‰¾åˆ°å€¼ä¸º 2 çš„å˜é‡ scopeã€‚çœ‹åˆ°è¿™é‡Œæœ‰æ²¡æœ‰æ„Ÿè§‰åˆ°è¿™ä¸ªåŠ¨æ€ä½œç”¨åŸŸçš„å·¥ä½œåŸç†åƒæäº† JS ä¸­çš„ thisï¼Œå…³äº this çš„æœºåˆ¶æˆ‘ä»¬å°†åœ¨åç»­ä¸­è¿›è¡Œè®²è§£ã€‚ 3ã€JS çš„å…¨å±€ä½œç”¨åŸŸã€å—çº§ä½œç”¨åŸŸã€å‡½æ•°ä½œç”¨åŸŸ3.1 å…¨å±€ä½œç”¨åŸŸåœ¨ ES6 ä¹‹å‰ï¼ŒJS åªæœ‰å…¨å±€ä½œç”¨åŸŸå’Œå‡½æ•°ä½œç”¨åŸŸï¼Œä½†æ˜¯å½“å…¨å±€ä½œç”¨åŸŸç”¨çš„è¿‡å¤šæ—¶å°±ä¼šå‘ç°ä¸€ä¸ªå¤§é—®é¢˜ï¼Œå°±æ˜¯å…¨å±€æ±¡æŸ“ï¼Œä¸ºäº†è¿™ä¸ªè§£å†³è¿™ä¸ªé—®é¢˜æ¨å‡ºäº†å¥½å¤šæ–¹æ³•ï¼šæ¨¡å—åŒ–ã€é—­åŒ…ã€å‘½åç©ºé—´ç­‰ç­‰ç­‰ç­‰ã€‚ä»€ä¹ˆæ˜¯å…¨å±€ä½œç”¨åŸŸï¼Ÿå…¨å±€ä½œç”¨åŸŸå³è´¯ç©¿æ•´ä¸ª JS æ–‡æ¡£ï¼Œåœ¨ä»»ä½•åœ°æ–¹éƒ½èƒ½å¤Ÿè®¿é—®åˆ°ï¼ŒJS ä¸­æœ‰ä¸ªå…¨å±€å¯¹è±¡ windowï¼Œå¦‚å£°æ˜ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œå°±ç›¸å½“äºåœ¨ window ä¸Šæ·»åŠ ä¸€ä¸ªå±æ€§ã€‚ 3.2 å—çº§ä½œç”¨åŸŸå—çº§ä½œç”¨åŸŸæ˜¯ ES6 ä¸­æ‰å‡ºç°çš„æ–°ç‰¹æ€§ï¼Œé€šå¸¸ä½¿ç”¨çš„ letã€const éƒ½æ˜¯æ˜¾å¼å£°æ˜å—çº§ä½œç”¨åŸŸçš„æ–¹æ³•ã€‚åœ¨ã€Šä½ ä¸çŸ¥é“çš„ JavaScriptã€‹ä¸­å¯¹å—çº§ä½œç”¨åŸŸçš„æ€»ç»“æ˜¯è¿™æ ·çš„ï¼šå—ä½œç”¨åŸŸæŒ‡çš„æ˜¯å˜é‡å’Œå‡½æ•°ä¸ä»…å¯ä»¥å±äºæ‰€å¤„çš„ä½œç”¨åŸŸï¼Œä¹Ÿå¯ä»¥å±äºæŸä¸ªä»£ç å—ï¼ˆé€šå¸¸æŒ‡ { .. } å†…éƒ¨ï¼‰ã€‚å…¶å®æˆ‘è®¤ä¸ºé€šä¿—çš„ç†è§£å°±æ˜¯ï¼Œåœ¨ä»£ç å—ä¸­å®šä¹‰çš„å˜é‡æˆ–è€…å‡½æ•°ï¼Œåœ¨å…¶ä»£ç å—å¤–æ— æ³•è®¿é—®ã€‚ 3.3 å‡½æ•°ä½œç”¨åŸŸå‡½æ•°ä½œç”¨åŸŸå³å®šä¹‰åœ¨å‡½æ•°ä»£ç å—ä¸­çš„å˜é‡å’Œå‡½æ•°ï¼Œå¤–éƒ¨æ— æ³•è®¿é—®ã€‚ä¸¾ä¸ªæ —å­ï¼š 1234567var a = 1;function foo() &#123; var a = 2; console.log(a);&#125;foo();console.log(a); è¿è¡Œä¸Šè¿°ç»“æœå¯ä»¥çš„å‡ºç»“è®ºï¼Œfoo å‡½æ•°è¿è¡Œå®Œååœ¨ foo å‡½æ•°ä¸­è¾“å‡ºçš„ä¸º 2ï¼Œåœ¨å…¨å±€ä¸Šè¾“å‡ºçš„ä¸º 1ã€‚ä½†æ˜¯è¿™æ ·å¹¶ä¸æ˜¯å¾ˆç†æƒ³ï¼Œå› ä¸º foo å‡½æ•°æ˜¯æŒ‚è½½åœ¨å…¨å±€ä¸­çš„ï¼Œä¹Ÿä¼šå®¹æ˜“é€ æˆä¸€ä¸ªå…¨å±€æ±¡æŸ“çš„é—®é¢˜ï¼Œå…¶æ¬¡å¿…é¡»æ˜¾å¼è°ƒç”¨(foo())æ‰èƒ½è¿è¡Œå‡½æ•°ä»£ç ï¼Œè¿˜å¥½ JS ç»™æˆ‘ä»¬æä¾›äº†ä¸€ä¸ªè§£å†³è¿™ç§é—®é¢˜çš„æ–¹æ³•ï¼Œå³è‡ªæ‰§è¡Œå‡½æ•°ã€‚å¯ä»¥é€šè¿‡è‡ªæ‰§è¡Œå‡½æ•°å°†ä¸Šé¢çš„ä¾‹å­è¿›è¡Œæ”¹é€ ï¼š 1234567var a = 1;(function foo() &#123; var a = 2; console.log(a);&#125;)();console.log(a);console.log(foo); // Uncaught ReferenceError: foo is not defined æ‰§è¡Œç»“æœä¸ä¹‹å‰ç›¸åŒï¼Œå½“æŸ¥çœ‹ foo å‡½æ•°æ—¶ä¼šæŠ¥ foo æ²¡æœ‰è¢«å®šä¹‰çš„é”™è¯¯ã€‚foo å˜é‡åè¢«éšè—åœ¨è‡ªèº«ä¸­æ„å‘³ç€ä¸ä¼šéå¿…è¦åœ°æ±¡æŸ“å¤–éƒ¨ä½œç”¨åŸŸã€‚","categories":[{"name":"JSåŸºç¡€","slug":"JSåŸºç¡€","permalink":"https://tomatoesman.github.io/categories/JS%E5%9F%BA%E7%A1%80/"}],"tags":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://tomatoesman.github.io/tags/%E5%89%8D%E7%AB%AF/"},{"name":"javascript","slug":"javascript","permalink":"https://tomatoesman.github.io/tags/javascript/"}]},{"title":"newå…³é”®è¯","slug":"newå…³é”®è¯","date":"2020-04-21T14:05:33.000Z","updated":"2020-06-25T11:52:45.285Z","comments":true,"path":"2020/04/21/newå…³é”®è¯/","link":"","permalink":"https://tomatoesman.github.io/2020/04/21/new%E5%85%B3%E9%94%AE%E8%AF%8D/","excerpt":"å¤§éƒ¨åˆ†é¢è¯•çš„æ—¶å€™ï¼Œé¢è¯•å®˜å…ˆå·²åŸå‹é“¾é“ºè·¯ï¼Œéšåå°±ä¼šé—®ä½  new å…³é”®è¯éƒ½åšäº†äº›ä»€ä¹ˆï¼Ÿä¹Ÿæ˜¯ä¸ºäº†ä¸‹ä¸€ä¸ªç»§æ‰¿é—®é¢˜å†æ¬¡é“ºè·¯ï¼é‚£è¿™ç¯‡æ–‡ç« æˆ‘ä»¬å°±æ¥è®²è®²è¿™ä¸ª newï¼æˆ‘ä»¬é€šå¸¸åœ¨ä»€ä¹ˆåœ°æ–¹èƒ½çœ‹åˆ°å®ƒï¼Œåœ¨åˆ›å»ºå®ä¾‹çš„æ—¶å€™ï¼Œnew åé¢åŠ ä¸Šä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œå°±æ˜¯åˆ›å»ºè¿™ä¸ªæ„é€ å‡½æ•°çš„å®ä¾‹ã€‚","text":"å¤§éƒ¨åˆ†é¢è¯•çš„æ—¶å€™ï¼Œé¢è¯•å®˜å…ˆå·²åŸå‹é“¾é“ºè·¯ï¼Œéšåå°±ä¼šé—®ä½  new å…³é”®è¯éƒ½åšäº†äº›ä»€ä¹ˆï¼Ÿä¹Ÿæ˜¯ä¸ºäº†ä¸‹ä¸€ä¸ªç»§æ‰¿é—®é¢˜å†æ¬¡é“ºè·¯ï¼é‚£è¿™ç¯‡æ–‡ç« æˆ‘ä»¬å°±æ¥è®²è®²è¿™ä¸ª newï¼æˆ‘ä»¬é€šå¸¸åœ¨ä»€ä¹ˆåœ°æ–¹èƒ½çœ‹åˆ°å®ƒï¼Œåœ¨åˆ›å»ºå®ä¾‹çš„æ—¶å€™ï¼Œnew åé¢åŠ ä¸Šä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œå°±æ˜¯åˆ›å»ºè¿™ä¸ªæ„é€ å‡½æ•°çš„å®ä¾‹ã€‚ é¦–å…ˆæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œçœ‹çœ‹ new éƒ½åšäº†å“ªäº›äº‹æƒ…ï¼š 1234567891011function Person() &#123; this.name = \"Jack\"; this.age = \"29\";&#125;Person.prototype.eat = function () &#123; console.log(\"çƒ¤é¸­\");&#125;;var person = new Person();console.log(person.name); //Jackconsole.log(person.age); // 29person.eat(); // çƒ¤é¸­ æˆ‘ä»¬ä»ä¸Šè¿°å¯ä»¥çœ‹å‡ºï¼Œnew å…³é”®è¯ä¸»è¦åšäº†ä»¥ä¸‹å‡ ä¸ªäº‹æƒ…ï¼š åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œ å°†æ–°å¯¹è±¡çš„__proto__å‡½æ•°æŒ‡å‘æ„é€ å‡½æ•°çš„ prototypeï¼Œè¿™ä¸ªæ–°å¯¹è±¡å°±å¯ä»¥è®¿é—®æ„é€ å‡½æ•°åŸå‹ä¸Šçš„å±æ€§ å°† this æŒ‡å‘æ”¹å˜ï¼ŒæŒ‡å‘æ–°çš„å¯¹è±¡ï¼Œè¿™æ ·å°±å¯ä»¥è®¿é—®æ„é€ å‡½æ•°å†…éƒ¨çš„å±æ€§ è¿”å›æ–°çš„å¯¹è±¡ æ¥ä¸‹æ¥æ¥æ¨¡æ‹Ÿä¸€ä¸‹ new å‡½æ•°ï¼š 1234567function MyNew() &#123; let obj = new Object(); Constructor = [].shift.call(arguments); obj.__proto__ = Constructor.prototype; Constructor.apply(obj, arguments); return obj;&#125; æˆ‘ä»¬æ¥éªŒè¯ä¸€ä¸‹å†™çš„è¿™ä¸ªæ–¹æ³•æ˜¯å¦æ­£ç¡®ï¼š 1234567891011function Person() &#123; this.name = \"Jack\"; this.age = \"29\";&#125;Person.prototype.eat = function () &#123; console.log(\"çƒ¤é¸­\");&#125;;var person = MyNew(Person);console.log(person.name); //Jackconsole.log(person.age); // 29person.eat(); // çƒ¤é¸­ è¾“å‡ºç»“æœä¸€æ ·ï¼Œé‚£å¿½ç„¶æœ‰ä¸ªæƒ³æ³•ï¼Œæ„é€ å‡½æ•°æ¯•ç«Ÿæ˜¯ä¸ªå‡½æ•°ï¼Œå¦‚æœæ„é€ å‡½æ•°æœ‰è¿”å›å€¼ï¼Œé‚£ new åç»“æœæ˜¯æ€æ ·å‘¢ï¼š 12345678910111213141516171819202122232425262728293031// è¿”å›åŸºæœ¬æ•°æ®ç±»å‹function Person() &#123; this.name = \"Jack\"; this.age = \"29\"; return 1;&#125;Person.prototype.eat = function () &#123; console.log(\"çƒ¤é¸­\");&#125;;var person = new Person();console.log(person.name); //Jackconsole.log(person.age); // 29person.eat(); // çƒ¤é¸­// è¿”å›å¯¹è±¡function Person() &#123; this.name = \"Jack\"; this.age = \"29\"; return &#123; sex: \"nan\", like: \"nv\", &#125;;&#125;Person.prototype.eat = function () &#123; console.log(\"çƒ¤é¸­\");&#125;;var person = new Person();console.log(person.name); //undefinedconsole.log(person.age); // undefinedconsole.log(person.sex); //Jackconsole.log(person.like); // 29person.eat(); // Uncaught TypeError: person.eat is not a function å½“æ„é€ å‡½æ•°è¿”å›çš„æ˜¯ä¸€ä¸ªåŸºæœ¬æ•°æ®ç±»å‹æ—¶ï¼Œè·Ÿæ²¡æœ‰è¿”å›å€¼æ˜¯ä¸€æ ·çš„ç»“æœï¼Œä½†æ˜¯å½“è¿”å›å€¼æ˜¯ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œå°±ä¼šçœŸçš„è¿”å›è¿™ä¸ªå¯¹è±¡ï¼Œreturn ä¹‹å‰å®šä¹‰çš„å±æ€§éƒ½ä¼šå¤±æ•ˆï¼Œå¹¶ä¸”å®šä¹‰åœ¨åŸå‹ä¸Šçš„å±æ€§ä¹Ÿä¼šå¤±æ•ˆã€‚æ ¹æ®è¿™ä¸ªç‰¹æ€§ï¼Œå¯¹ä¹‹å‰å†™çš„ MyNew å‡½æ•°è¿›è¡Œå‡çº§ã€‚ 1234567function MyNew() &#123; let obj = new Object(); Constructor = [].shift.call(arguments); obj.__proto__ = Constructor.prototype; let res = Constructor.apply(obj, arguments); return typeof res === \"object\" ? res : obj;&#125;","categories":[{"name":"JSåŸºç¡€","slug":"JSåŸºç¡€","permalink":"https://tomatoesman.github.io/categories/JS%E5%9F%BA%E7%A1%80/"}],"tags":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://tomatoesman.github.io/tags/%E5%89%8D%E7%AB%AF/"},{"name":"javascript","slug":"javascript","permalink":"https://tomatoesman.github.io/tags/javascript/"}]},{"title":"ç»§æ‰¿","slug":"ç»§æ‰¿","date":"2020-04-20T02:18:58.000Z","updated":"2020-06-25T11:52:13.208Z","comments":true,"path":"2020/04/20/ç»§æ‰¿/","link":"","permalink":"https://tomatoesman.github.io/2020/04/20/%E7%BB%A7%E6%89%BF/","excerpt":"JS æ˜¯ä¸€é—¨é¢å‘å¯¹è±¡çš„è¯­è¨€ï¼Œé¢å‘å¯¹è±¡çš„ä¸‰ä¸ªç‰¹æ€§ï¼šå°è£…ã€ç»§æ‰¿ã€å¤šæ€ã€‚è™½ç„¶ JS æ²¡æœ‰å¤šæ€ï¼Œä½†æ˜¯ç»§æ‰¿è¿˜æ˜¯æœ‰çš„ï¼Œä½†æ˜¯ JS çš„ç»§æ‰¿åªæ”¯æŒå®ç°ç»§æ‰¿ï¼Œå®ç°çš„æ–¹å¼å°±æ˜¯é€šè¿‡åŸå‹é“¾ã€‚åŸå‹é“¾æˆ‘ä»¬ä¸Šç¯‡å·²ç»è®²è¿‡äº†ï¼Œæ‰€ä»¥æœ¬ç¯‡ä¸»è¦ JS ä¸­å‡ ç§ç»§æ‰¿çš„æ–¹å¼ã€‚","text":"JS æ˜¯ä¸€é—¨é¢å‘å¯¹è±¡çš„è¯­è¨€ï¼Œé¢å‘å¯¹è±¡çš„ä¸‰ä¸ªç‰¹æ€§ï¼šå°è£…ã€ç»§æ‰¿ã€å¤šæ€ã€‚è™½ç„¶ JS æ²¡æœ‰å¤šæ€ï¼Œä½†æ˜¯ç»§æ‰¿è¿˜æ˜¯æœ‰çš„ï¼Œä½†æ˜¯ JS çš„ç»§æ‰¿åªæ”¯æŒå®ç°ç»§æ‰¿ï¼Œå®ç°çš„æ–¹å¼å°±æ˜¯é€šè¿‡åŸå‹é“¾ã€‚åŸå‹é“¾æˆ‘ä»¬ä¸Šç¯‡å·²ç»è®²è¿‡äº†ï¼Œæ‰€ä»¥æœ¬ç¯‡ä¸»è¦ JS ä¸­å‡ ç§ç»§æ‰¿çš„æ–¹å¼ã€‚ 1ã€å€Ÿç”¨æ„é€ å‡½æ•°å®ç°ç»§æ‰¿è¿™ç§ç»§æ‰¿æ–¹æ³•æœ€åŸå§‹çš„ç»§æ‰¿ï¼Œå®ç°çš„éå¸¸ç®€å•å°±æ˜¯åœ¨å­ç±»å‹æ„é€ å‡½æ•°çš„å†…éƒ¨å®ç°è¶…ç±»å‹çš„æ„é€ å‡½æ•°ã€‚å¯ä»¥é€šè¿‡ call å’Œ apply æ¥å®ç°ã€‚ 12345678910function Father() &#123; this.money = \"$1\";&#125;function Son() &#123; Father.call(this);&#125;var son1 = new Son();console.log(son1.money); // $1var son2 = new Son();console.log(son2.money); // $1 ä¸Šè¿°å¯è§ï¼Œè¿™å®Œå…¨å®ç°äº†ç»§æ‰¿ï¼Œå„¿å­ç»§æ‰¿äº†è€å­çš„é’±ï¼Œè™½ç„¶åªæœ‰ 1 ç¾å…ƒï¼Œä½†ä¹Ÿæ˜¯çˆ±å•Šï¼ ä½†æ˜¯è¿™æ ·æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ï¼š 123456789101112function Father() &#123; this.money = \"$1\";&#125;Father.prototype.makeMoney = function () &#123; console.log(\"åŠªåŠ›å·¥ä½œ\");&#125;;function Son() &#123; Father.call(this);&#125;var son1 = new Son();console.log(son1.money); // $1son1.makeMoney(); //Uncaught TypeError: son1.makeMoney is not a function å‘ç°äº†å§ï¼Œè¿™æ˜¯ä¸€ä¸ªå¤§é—®é¢˜å•Šï¼Œè™½ç„¶å„¿å­ç»§æ‰¿äº†è€å­çš„é’±ï¼Œä½†æ˜¯æ²¡æœ‰ç»§æ‰¿è€å­çš„èµšé’±çš„èƒ½åŠ›ï¼Œè™½ç„¶ 1 ç¾å…ƒæ˜¯ä¸€ç¬”å¤§æ¬¾ï¼Œä½†æ˜¯æ²¡æœ‰èµšé’±çš„èƒ½åŠ›ï¼Œæ—©æ™šä¹Ÿä¼šèŠ±å…‰çš„å•Šï¼è¿™æ˜¯å› ä¸ºæ–¹æ³•éƒ½åœ¨æ„é€ å‡½æ•°ä¸­å®šä¹‰ï¼Œå› æ­¤å‡½æ•°å¤ç”¨å°±æ— ä»è°ˆèµ·äº†ï¼Œè€Œä¸”åœ¨çˆ¶ç±»çš„åŸå‹ä¸Šå®šä¹‰çš„æ–¹æ³•ï¼Œå¯¹å­ç±»å‹è€Œè¨€ä¹Ÿæ˜¯ä¸å¯è§çš„ï¼Œç»“æœæ‰€æœ‰ç±»å‹éƒ½åªèƒ½ä½¿ç”¨æ„é€ å‡½æ•°æ¨¡å¼ã€‚å› ä¸ºè¿™ä¸ªé—®é¢˜ï¼Œå€ŸåŠ©æ„é€ å‡½æ•°çš„æŠ€æœ¯é€šå¸¸éƒ½ä¸æ˜¯å•ç‹¬ä½¿ç”¨çš„ã€‚é‚£å¦‚ä½•å®ç°ç»§æ‰¿çˆ¶ç±»åŸå‹ä¸Šçš„æ–¹æ³•å‘¢ï¼Ÿè¿™å°±è¦è®²åˆ°å¦å¤–ä¸€ä¸ªå®ç°ç»§æ‰¿çš„æ–¹å¼äº†ï¼Œç”¨åŸå‹é“¾ç»§æ‰¿ã€‚ 2ã€åŸå‹é“¾å®ç°ç»§æ‰¿åŸå‹é“¾åœ¨ JS ä¸­æ˜¯ä¸€ç§ç‰¹æ®Šçš„å­˜åœ¨ï¼Œé‚£å¦‚ä½•å®ç°åœ¨åŸå‹é“¾ä¸Šçš„ç»§æ‰¿å‘¢ï¼Ÿæ˜¯å¦æƒ³åˆ°äº† new è¿™ä¸ªå…³é”®è¯ï¼Ÿnew å¹²äº†å“ªäº›äº‹æƒ…å‘¢ï¼Ÿè¿™æ˜¯ä¸€ä¸ªç»å…¸é¢è¯•é¢˜ï¼Œç®€å•çš„è¯´æ˜¯ï¼š åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ å°†æ–°å¯¹è±¡çš„__proto__æŒ‡å‘æ„é€ å‡½æ•°çš„ prototype å¯¹è±¡ å°†æ„é€ å‡½æ•°çš„ä½œç”¨åŸŸèµ‹å€¼ç»™æ–°å¯¹è±¡ ï¼ˆä¹Ÿå°±æ˜¯ this æŒ‡å‘æ–°å¯¹è±¡ï¼‰ æ‰§è¡Œæ„é€ å‡½æ•°ä¸­çš„ä»£ç ï¼ˆä¸ºè¿™ä¸ªæ–°å¯¹è±¡æ·»åŠ å±æ€§ï¼‰ è¿”å›æ–°çš„å¯¹è±¡ ç¬¬äºŒæ¡å°±èƒ½æ»¡è¶³å’±ä»¬çš„è¦æ±‚ã€‚æ‰€ä»¥ç»§æ‰¿çˆ¶ç±»åŸå‹é“¾ä¸Šçš„æ–¹æ³•æˆ‘ä»¬å¯ä»¥è¿™æ ·å†™ï¼š 1234567891011function Father() &#123; this.money = \"$1\";&#125;Father.prototype.makeMoney = function () &#123; console.log(\"åŠªåŠ›å·¥ä½œ\");&#125;;function Son() &#123;&#125;Son.prototype = new Father();var son1 = new Son(); // $1console.log(son1.money);son1.makeMoney(); // åŠªåŠ›å·¥ä½œ ç®€ç›´å®Œç¾å•Šï¼Œå„¿å­å³ç»§æ‰¿äº† 1 ç¾å…ƒåˆç»§æ‰¿äº†åŠªåŠ›èµšé’±çš„æ–¹æ³•ã€‚ä½†æ˜¯å¥½åƒå¿½ç•¥äº†ä¸€ç‚¹ï¼Œè¿™ä¸ªçˆ¶äº²å¥½åƒæœ‰ä¸¤ä¸ªå„¿å­ï¼Œç°åœ¨è¿™ä¸ªçˆ¶äº²ä¸æ­¢åªæœ‰é’±è¿˜æœ‰å¾ˆå¤šä¸œè¥¿ï¼Œé‚£æˆ‘ä»¬å°†å®ƒä»¬å†™æˆä¸€ä¸ªæ•°ç»„ï¼Œæ­¤æ—¶å°å„¿å­å·æ‘¸çš„æƒ³è¦è€çˆ¶äº²çš„è‡ªè¡Œè½¦ï¼Œè€çˆ¶äº²å…è®¸äº†ï¼Œè®©ä»–è‡ªå·±æ‹¿äºæ˜¯ï¼š 123456789101112131415function Father() &#123; this.goods = [\"$1\", \"æ‰‹ç”µç­’\", \"å†°ç®±\"];&#125;Father.prototype.makeMoney = function () &#123; console.log(\"åŠªåŠ›å·¥ä½œ\");&#125;;function Son() &#123;&#125;Son.prototype = new Father();var son1 = new Son();var son2 = new Son();son2.goods.push(\"è‡ªè¡Œè½¦\");console.log(son1.goods); // [\"$1\", \"æ‰‹ç”µç­’\", \"å†°ç®±\", \"è‡ªè¡Œè½¦\"]son1.makeMoney(); // åŠªåŠ›å·¥ä½œconsole.log(son2.goods); // [\"$1\", \"æ‰‹ç”µç­’\", \"å†°ç®±\", \"è‡ªè¡Œè½¦\"]son2.makeMoney(); // åŠªåŠ›å·¥ä½œ è²Œä¼¼æœ‰äº›å°´å°¬ï¼Œå› ä¸ºå°å„¿å­ç»§æ‰¿è‡ªè¡Œè½¦è¿™ä¸ªäº‹æƒ…ä¸€ä¸‹å­å°±è¢«å¤§å„¿å­å‘ç°äº†ã€‚è¿™æ˜¯å› ä¸ºåŒ…å«å¼•ç”¨ç±»å‹å€¼çš„åŸå‹å±æ€§ä¼šè¢«æ‰€æœ‰å®ä¾‹å…±äº«ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆè¦ä½¿ç”¨æ„é€ å‡½æ•°æ¥å®šä¹‰å±æ€§çš„åŸå› ã€‚åœ¨é€šè¿‡åŸå‹æ¥å®ç°ç»§æ‰¿æ—¶ï¼ŒåŸå‹å®é™…ä¸Šä¼šå˜æˆå¦ä¸€ä¸ªåŸå‹çš„å®ä¾‹ï¼Œäºæ˜¯åŸå…ˆçš„å®ä¾‹å±æ€§ä¹Ÿå°±å˜æˆäº†ç°åœ¨çš„åŸå‹å±æ€§ã€‚ ä»¥è¿™ä¸ªä¾‹å­æ¥è¯´ï¼Œçˆ¶ç±»çš„ goods æ˜¯ä¸ªæ•°ç»„ï¼ˆå¼•ç”¨æ•°æ®ç±»å‹ï¼‰ï¼Œæ¯ä¸ªçˆ¶ç±»çš„å®ä¾‹éƒ½ä¼šæœ‰ä¸€ä¸ª goods çš„å±æ€§ï¼Œåœ¨å­ç±»é€šè¿‡åŸå‹é“¾ç»§æ‰¿äº†çˆ¶ç±»çš„åŸå‹æ—¶ï¼Œå­ç±»çš„åŸå‹å°±æ˜¯çˆ¶ç±»çš„å®ä¾‹ï¼Œé‚£ä¹ˆæ¯ä¸ªå­ç±»ä¹ŸåŒæ ·æ‹¥æœ‰äº† goods è¿™ä¸ªåŸå‹å±æ€§ï¼Œå°±ç›¸å½“äºåœ¨ son.prototype.goods ä¸€æ ·ï¼Œä½†æ˜¯ç”±äºåŒ…å«å¼•ç”¨ç±»å‹çš„åŸå‹å±æ€§ä¼šè¢«æ‰€æœ‰å®ä¾‹å…±äº«ï¼Œæ‰€ä»¥å½“ son1 å¯¹ goods è¿›è¡Œä¿®æ”¹æ—¶ï¼Œson2 ä¹Ÿä¼šè¢«ä¿®æ”¹ã€‚ 3ã€ç»„åˆç»§æ‰¿ç»„åˆç»§æ‰¿å°±æ˜¯æŠŠæ„é€ å‡½æ•°ç»§æ‰¿å’ŒåŸå‹é“¾ç»§æ‰¿ç»„åˆåœ¨ä¸€èµ·ï¼Œç»“åˆä¸¤è€…çš„é•¿å¤„ã€‚ 1234567891011121314151617function Father() &#123; this.goods = [\"$1\", \"æ‰‹ç”µç­’\", \"å†°ç®±\"];&#125;Father.prototype.makeMoney = function () &#123; console.log(\"åŠªåŠ›å·¥ä½œ\");&#125;;function Son() &#123; Father.call(this);&#125;Son.prototype = new Father();var son1 = new Son();var son2 = new Son();son2.goods.push(\"è‡ªè¡Œè½¦\");console.log(son1.goods); // ['$1', 'æ‰‹ç”µç­’', 'å†°ç®±']son1.makeMoney(); // åŠªåŠ›å·¥ä½œconsole.log(son2.goods); // ['$1', 'æ‰‹ç”µç­’', 'å†°ç®±', 'è‡ªè¡Œè½¦']son2.makeMoney(); // åŠªåŠ›å·¥ä½œ ç»ˆäºæ»¡è¶³äº†å°å„¿å­ç‹¬è‡ªç»§æ‰¿è‡ªè¡Œè½¦çš„æ¢¦æƒ³ã€‚ 4ã€ç»„åˆç»§æ‰¿çš„ä¼˜åŒ–ç»„åˆç»§æ‰¿æ˜¯ JS ä¸­æœ€ç»å…¸çš„ç»§æ‰¿æ–¹å¼ï¼Œä½†æ˜¯ä¸Šè¿°ä¸­è¿˜æœ‰äº›è®¸çš„ç¼ºç‚¹ï¼Œä¼šå‘ç°åœ¨åˆ›å»ºä¸€ä¸ªå­ç±»å‹çš„å®ä¾‹æ—¶ï¼Œä¼šåˆ›å»ºä¸¤æ¬¡çˆ¶ç±»çš„å®ä¾‹ï¼Œæ¥ä¸‹æ¥å°±å¯¹è¿™ä¸€ç‚¹è¿›è¡Œä¼˜åŒ–ã€‚ä¸Šè¿°å€Ÿç”¨åŸå‹é“¾ç»§æ‰¿ä¸­ï¼Œåº”ç”¨ new å…³é”®è¯çš„ç›®çš„ï¼Œå°±æ˜¯å¸Œæœ›æŠŠçˆ¶ç±»çš„åŸå‹èµ‹å€¼ç»™å­ç±»ï¼Œé‚£å¯ä»¥ç›´æ¥å°†çˆ¶ç±»çš„åŸå‹èµ‹å€¼è¿‡å»ï¼Œä¼˜åŒ– 1 å¦‚ä¸‹ï¼š 1234567891011121314151617function Father() &#123; this.goods = [\"$1\", \"æ‰‹ç”µç­’\", \"å†°ç®±\"];&#125;Father.prototype.makeMoney = function () &#123; console.log(\"åŠªåŠ›å·¥ä½œ\");&#125;;function Son() &#123; Father.call(this);&#125;Son.prototype = Father.prototype;var son1 = new Son();var son2 = new Son();son2.goods.push(\"è‡ªè¡Œè½¦\");console.log(son1.goods); // ['$1', 'æ‰‹ç”µç­’', 'å†°ç®±']son1.makeMoney(); // åŠªåŠ›å·¥ä½œconsole.log(son2.goods); // ['$1', 'æ‰‹ç”µç­’', 'å†°ç®±', 'è‡ªè¡Œè½¦']son2.makeMoney(); // åŠªåŠ›å·¥ä½œ ç»“æœæ²¡æœ‰ä»»ä½•é—®é¢˜ï¼Œä¹Ÿè§£å†³äº†è°ƒç”¨ä¸¤æ¬¡çˆ¶ç±»å®ä¾‹çš„é—®é¢˜ï¼Œä½†æ˜¯ï¼š 1234son1.constructorÆ’ Father() &#123; this.goods = [\"$1\", \"æ‰‹ç”µç­’\", \"å†°ç®±\"];&#125; å­ç±»è™½ç„¶æ˜¯ç»§æ‰¿çˆ¶ç±»çš„ï¼Œä½†æ˜¯å®ƒçš„å®ä¾‹ä¹Ÿæ˜¯ä¸€ä¸ªä¸ªä½“å•Šï¼Œå„¿å­ 1 å’Œå„¿å­ 2 éƒ½æ˜¯å„¿å­å•Šï¼Œæ€ä¹ˆä¸€ä¸‹å­æˆä¸ºè€å­äº†ï¼Œè¿™è‚¯å®šä¸è¡Œã€‚æ‰€ä»¥æˆ‘ä»¬å†æ¬¡ä¼˜åŒ–ï¼Œä¼˜åŒ– 2ï¼š 123456789101112131415161718function Father() &#123; this.goods = [\"$1\", \"æ‰‹ç”µç­’\", \"å†°ç®±\"];&#125;Father.prototype.makeMoney = function () &#123; console.log(\"åŠªåŠ›å·¥ä½œ\");&#125;;function Son() &#123; Father.call(this);&#125;Son.prototype = Object.create(Father.prototype);Son.prototype.constuctor = Son;var son1 = new Son();var son2 = new Son();son2.goods.push(\"è‡ªè¡Œè½¦\");console.log(son1.goods); // ['$1', 'æ‰‹ç”µç­’', 'å†°ç®±']son1.makeMoney(); // åŠªåŠ›å·¥ä½œconsole.log(son2.goods); // ['$1', 'æ‰‹ç”µç­’', 'å†°ç®±', 'è‡ªè¡Œè½¦']son2.makeMoney(); // åŠªåŠ›å·¥ä½œ è¿™æ ·æ‰ç®—æ˜¯çœŸæ­£ä¼˜åŒ–å®Œæˆã€‚ 5ã€åŸå‹å¼ç»§æ‰¿æœ¬æ¥è§‰å¾—å†™åˆ°ä¸Šä¸€æ¡çš„æ—¶å€™å°±ç»“æŸäº†ï¼Œä½†æ˜¯çœ‹åˆ°äº†ã€Šé«˜ç¨‹ã€‹é‡Œå¯¹ç»§æ‰¿çš„è®²è¿°ï¼Œè¿˜æœ‰ ES6 ç»§æ‰¿ç‰¹æ€§çš„åº•å±‚å®ç°åŸç†ï¼Œè§‰å¾—è¿˜æ˜¯æœ‰å¿…è¦å¥½å¥½çš„äº†è§£è¿™ä¸€å—çš„çŸ¥è¯†ã€‚ å¦‚é«˜ç¨‹æ‰€è®²ï¼Œæå‡ºè¿™ç§ç»§æ‰¿æ–¹å¼çš„äººå«é“æ ¼æ‹‰æ–¯Â·å…‹ç½—å…‹ç¦å¾·ï¼Œä»–åœ¨ 2006 å¹´å†™äº†ä¸€ç¯‡åä¸ºã€ŠPrototypal Inheritance in Javascriptã€‹ï¼ˆJavascript ä¸­åŸå‹å¼ç»§æ‰¿ï¼‰ï¼Œåœ¨æ­¤ä¹¦ä¸­ä»–å®ç°äº†ä¸€ç§æ–°å‹çš„ç»§æ‰¿æ–¹å¼ï¼Œè¿™ä¸ªç»§æ‰¿æ–¹å¼æ²¡æœ‰ä½¿ç”¨ä¸¥æ ¼æ„ä¹‰ä¸Šçš„æ„é€ å‡½æ•°ï¼Œè€Œæ˜¯å»ºé€ ä¸€ä¸ªåŸºå‡†çš„å¯¹è±¡ï¼Œé€šè¿‡åŸå‹å°†å·²æœ‰çš„åŸºå‡†å¯¹è±¡å†åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼ŒåŒæ—¶è¿˜ä¸å¿…å› æ­¤åˆ›å»ºè‡ªå®šä¹‰ç±»å‹ï¼Œä¸ºäº†å®ç°è¿™ä¸ªç›®çš„ï¼Œä»–åˆ›å»ºäº†å¦‚ä¸‹å‡½æ•°ï¼š 12345function object(o) &#123; function F() &#123;&#125; F.prototype = o; return new F();&#125; ä»–åœ¨é‡Œé¢åˆ›å»ºäº†ä¸€ä¸ªä¸´æ—¶çš„æ„é€ å‡½æ•°ï¼Œç„¶åå°†ä¼ å…¥çš„å¯¹è±¡èµ‹å€¼ç»™è¿™ä¸ªä¸´æ—¶æ„é€ å‡½æ•°çš„åŸå‹ï¼Œæœ€åè¿”å›è¿™ä¸ªä¸´æ—¶æ„é€ å‡½æ•°çš„æ–°å®ä¾‹ã€‚çœ‹ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼š 12345678var father = &#123; money: \"$1\", goods: [\"æ‰‹ç”µç­’\", \"å†°ç®±\"],&#125;;var son1 = object(father);var son2 = object(father);son2.goods.push(\"è‡ªè¡Œè½¦\");console.log(father.goods); // ['æ‰‹ç”µç­’', 'å†°ç®±', 'John', 'è‡ªè¡Œè½¦'] æ¯•ç«Ÿæ˜¯é€šè¿‡åŸå‹ç»§æ‰¿ï¼Œæ‰€ä»¥ç»ˆç©¶è¿˜æ˜¯ä¼šæœ‰åŸå‹ç»§æ‰¿åº”æœ‰çš„é—®é¢˜ï¼Œå¼•ç”¨ç±»å‹çš„å±æ€§ä¼šè¢«å…±äº«ï¼Œä½†æ˜¯æœ‰æ²¡æœ‰æ„Ÿè§‰è¿™ä¸ªæ–¹æ³•å’Œ Object.create()å¾ˆåƒï¼Œæ²¡é”™ object.create()å°±æ˜¯åŸºäºè¿™ä¸ªæ–¹æ³•å»ºç«‹çš„ã€‚ 12345678var father = &#123; money: \"$1\", goods: [\"æ‰‹ç”µç­’\", \"å†°ç®±\"],&#125;;var son1 = Object.create(father);var son2 = Object.create(father);son2.goods.push(\"è‡ªè¡Œè½¦\");console.log(father.friends); // ['æ‰‹ç”µç­’', 'å†°ç®±', 'John', 'è‡ªè¡Œè½¦'] ä½† Object.create()ä¸åŒçš„æ˜¯ï¼Œå®ƒè¿˜æœ‰ç¬¬äºŒä¸ªå‚æ•°ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯å¯é€‰å€¼ï¼Œè®¾ç½®ç¬¬äºŒä¸ªå‚æ•°æ—¶ï¼Œå¯ä»¥æŒ‡å®šä»»ä½•å±æ€§éƒ½ä¼šè¦†ç›–åŸå‹ä¸Šçš„åŒåå±æ€§ã€‚ 6ã€å¯„ç”Ÿå¼ç»§æ‰¿è¿™ç§ç»§æ‰¿æ–¹å¼åŒæ ·æ˜¯é“æ ¼æ‹‰æ–¯Â·å…‹ç½—å…‹ç¦å¾·æå‡ºçš„ï¼Œæœ‰äº›ç±»ä¼¼äºå€Ÿç”¨æ„é€ å‡½æ•°ç»§æ‰¿ï¼Œä½†æ˜¯åŒæ ·çš„ä»–åˆ©ç”¨äº†ä¸€ä¸ªä¸´æ—¶æ„é€ å‡½æ•°çš„æ€æƒ³ï¼Œå³æ‰€è¯´çš„å¯„ç”Ÿæ€æƒ³ï¼Œå°†ä¸€ä¸ªå¯¹è±¡ä½œä¸ºåŸºå‡†ï¼Œç„¶åå¯„ç”Ÿåœ¨è¿™ä¸ªå¯¹è±¡ä¸Šï¼Œè¿™æ ·å°±å¯ä»¥æ‹¥æœ‰è¿™ä¸ªå¯¹è±¡çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ï¼Œå°è£…æˆä¸€ä¸ªå‡½æ•°ï¼Œåœ¨å‡½æ•°å†…éƒ¨ç»™è¿™ä¸ªå¯¹è±¡çš„å‰¯æœ¬æ·»åŠ æ–°çš„å±æ€§å’Œæ–¹æ³•ã€‚ 1234567function createAnother(o) &#123; var clone = object(o); clone.sayHi = function () &#123; console.log(\"hi\"); &#125;; return clone;&#125; ä½†æ˜¯è¿™ç§å‘¢ï¼Œæ— æ³•åšåˆ°å‡½æ•°çš„å¤ç”¨å¤§å¤§é™ä½æ•ˆç‡ã€‚ 7ã€å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿å‰é¢æåˆ°çš„ç»„åˆç»§æ‰¿æ—¶æœ€ç»å…¸çš„ç»§æ‰¿æ–¹å¼ï¼Œä½†æ˜¯æœ‰ä¸ªå¾ˆé‡è¦çš„é—®é¢˜ï¼Œä¼šæ‰§è¡Œä¸¤æ¬¡çˆ¶ç±»çš„æ„é€ å‡½æ•°ã€‚æ²¡äº‹æˆ‘ä»¬å¯ä»¥ç”¨å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ æˆ‘ä»¬å¼•ç”¨ã€Šé«˜ç¨‹ã€‹å¯¹å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿è§£é‡Šï¼šå³é€šè¿‡å€Ÿç”¨æ„é€ å‡½æ•°æ¥ç»§æ‰¿å±æ€§ï¼Œé€šè¿‡åŸå‹é“¾çš„æ··ç”¨å½¢å¼æ¥ç»§æ‰¿æ–¹æ³•ã€‚å…¶èƒŒåçš„æ€è·¯æ˜¯ï¼šä¸å¿…ä¸ºäº†å­ç±»å‹çš„åŸå‹è€Œè°ƒç”¨è¶…ç±»å‹çš„æ„é€ å‡½æ•°ï¼Œæˆ‘ä»¬æ‰€éœ€è¦çš„çš„æ— éå°±æ˜¯è¶…ç±»å‹åŸå‹çš„ä¸€ä¸ªå‰¯æœ¬è€Œå·²ã€‚æœ¬è´¨ä¸Šï¼Œå°±æ˜¯ä½¿ç”¨å¯„ç”Ÿå¼ç»§æ‰¿æ¥ç»§æ‰¿è¶…ç±»å‹çš„åŸå‹ï¼Œç„¶åå†å°†ç»“æœæŒ‡å®šç»™å­ç±»å‹çš„åŸå‹ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š 12345function inheritPrototype(father, son) &#123; var prototype = object(father.prototype); prototype.constructor = son; son.prototype = prototype;&#125; è¿™ä¸ªç¤ºä¾‹å®ç°äº†æœ€ç®€å•çš„å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿ã€‚å®ƒæ¥å—äº†ä¸¤ä¸ªå‚æ•°ï¼Œåˆ†åˆ«æ˜¯çˆ¶ç±»çš„æ„é€ å‡½æ•°å’Œå­ç±»çš„æ„é€ å‡½æ•°ã€‚åœ¨å‡½æ•°å†…éƒ¨ç¬¬ä¸€æ­¥æ˜¯åˆ›å»ºä¸€ä¸ªçˆ¶ç±»å‹åŸå‹å‰¯æœ¬ï¼Œç¬¬äºŒæ­¥æ˜¯å°†æ–°çš„å‰¯æœ¬æ·»åŠ  constructorï¼Œå¼¥è¡¥å› é‡æ„åŸå‹è€Œå¤±å»çš„é»˜è®¤ constuctor å±æ€§ï¼Œç¬¬ä¸‰æ­¥æ˜¯å°†æ–°çš„å‰¯æœ¬èµ‹å€¼ç»™å­ç±»å‹çš„åŸå‹ä¸Šã€‚ è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ä¿è¯åªæ‰§è¡Œä¸€æ¬¡çˆ¶ç±»çš„æ„é€ å‡½æ•°ã€‚ 12345678910function Father() &#123; this.money = \"$1\";&#125;Father.prototype.makeMoney = function () &#123; console.log(\"åŠªåŠ›å·¥ä½œ\");&#125;;function Son() &#123; Father.call(this);&#125;inheritPrototype(Father, Son); 8ã€ES6 çš„ç»§æ‰¿ classâ€¦extendsâ€¦ä»¥å‰è¯´åˆ°ç»§æ‰¿çš„æ—¶å€™åªæ˜¯è§‰å¾—æ˜¯ä¸ªè¯­æ³•ç³–ï¼Œç”¨èµ·æ¥å¾ˆæ˜¯æ–¹ä¾¿ï¼Œä½†æ˜¯é€šè¿‡å†™è¿™ç¯‡æ–‡ç« æŸ¥é˜…èµ„æ–™æ—¶çœ‹åˆ°äº†å…¶åº•å±‚å®ç°çš„åŸç†ã€‚è¿™ä¹Ÿæ˜¯å†™äº†åŸå‹å¼ç»§æ‰¿ã€å¯„ç”Ÿç»§æ‰¿ã€å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿çš„åŸå› ã€‚ æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹ ES6 ç»§æ‰¿ï¼š 123456789101112131415class Father &#123; constructor() &#123; this.money = \"$1\"; this.goods = [\"æ‰‹ç”µç­’\", \"å†°ç®±\"]; &#125; makeMoney = function () &#123; console.log(\"åŠªåŠ›å·¥ä½œ\"); &#125;;&#125;class Son extends Father &#123; constructor() &#123; super(); &#125;&#125; ç”¨ Bable è½¬æˆ ES5 åï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465\"use strict\";function _possibleConstructorReturn(self, call) &#123; if (!self) &#123; throw new ReferenceError( \"this hasn't been initialised - super() hasn't been called\" ); &#125; return call &amp;&amp; (typeof call === \"object\" || typeof call === \"function\") ? call : self;&#125;function _inherits(subClass, superClass) &#123; if (typeof superClass !== \"function\" &amp;&amp; superClass !== null) &#123; throw new TypeError( \"Super expression must either be null or a function, not \" + typeof superClass ); &#125; subClass.prototype = Object.create(superClass &amp;&amp; superClass.prototype, &#123; constructor: &#123; value: subClass, enumerable: false, writable: true, configurable: true, &#125;, &#125;); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : (subClass.__proto__ = superClass);&#125;function _classCallCheck(instance, Constructor) &#123; if (!(instance instanceof Constructor)) &#123; throw new TypeError(\"Cannot call a class as a function\"); &#125;&#125;var Father = function Father() &#123; _classCallCheck(this, Father); this.makeMoney = function () &#123; console.log(\"åŠªåŠ›å·¥ä½œ\"); &#125;; this.money = \"$1\"; this.goods = [\"æ‰‹ç”µç­’\", \"å†°ç®±\"];&#125;;var Son = (function (_Father) &#123; _inherits(Son, _Father); function Son() &#123; _classCallCheck(this, Son); return _possibleConstructorReturn( this, (Son.__proto__ || Object.getPrototypeOf(Son)).call(this) ); &#125; return Son;&#125;)(Father); æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å½“åˆ›å»ºç±»çš„æ—¶å€™ï¼ŒES6 è½¬æ¢ä¸º ES5 æ—¶ï¼Œè·Ÿä»¥å‰åˆ›å»ºç±»ä¼šå¤šä¸€ä¸ª_classCallCheck å‡½æ•°ï¼Œå…¶å®çœ‹åç§°å°±çŸ¥é“æ˜¯ä¸€ä¸ªæ£€æµ‹ï¼Œå®ƒæ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯ thisï¼Œç¬¬äºŒä¸ªæ˜¯æ„é€ å‡½æ•°ï¼Œåˆ¤æ–­ this æ˜¯å¦æ˜¯è¿™ä¸ªè¿™ä¸ªæ„é€ å‡½æ•°çš„å®ä¾‹ï¼Œå³ instanceof æ£€æµ‹æ„é€ å‡½æ•°çš„ prototype å±æ€§æ˜¯å¦å‡ºç°åœ¨æŸä¸ªå®ä¾‹å¯¹è±¡çš„åŸå‹é“¾ä¸Šï¼Œè¯´ç™½äº†å°±æ˜¯åˆ¤æ–­è°ƒç”¨å‰æ˜¯å¦æœ‰ new å…³é”®å­—ï¼Œä¸æ˜¯åˆ™æŠ›å‡º Cannot call a class as a function å¼‚å¸¸ï¼Œæ‰€ä»¥èƒ½è¿›ä¸€æ­¥å¯çŸ¥ class å°±æ˜¯ä¸€ä¸ªè¯­æ³•ç³–ã€‚ ES6 çš„ç»§æ‰¿è½¬æ¢ä¸º ES5 åå‘ç°å­ç±»æ˜¯ä¸€ä¸ªè‡ªæ‰§è¡Œçš„å‡½æ•°ï¼Œå°†çˆ¶ç±»ä½œä¸ºå‚æ•°ä¼ é€’è¿‡å»ã€‚é¦–å…ˆæ˜¯_inherits å‡½æ•°ï¼ŒåŒæ ·æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯å­ç±»æ„é€ å‡½æ•°ï¼Œä¸€ä¸ªæ˜¯çˆ¶ç±»æ„é€ å‡½æ•°ã€‚çœ‹å…¶å†…éƒ¨ç»“æ„ï¼š é¦–å…ˆåˆ¤æ–­çˆ¶ç±»çš„ç±»å‹ åŸºäºçˆ¶ç±»çš„åŸå‹åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ã€‚å¹¶é€šè¿‡ Object.create çš„ç¬¬äºŒä¸ªå‚æ•°ï¼Œå°†æ–°å¯¹è±¡çš„æ„é€ å‡½æ•°æŒ‡å‘å­ç±»ï¼Œå†å°†å…¶èµ‹å€¼ç»™å­ç±»çš„åŸå‹ã€‚ å°†å­ç±»çš„__proto__æŒ‡å‘çˆ¶ç±»çš„æ„é€ å‡½æ•° ç¬¬äºŒæ­¥æ˜¯ä¸æ˜¯å¾ˆç†Ÿæ‚‰ï¼Œæ²¡é”™å°±æ˜¯å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿çš„ç®€å•ç‰ˆã€‚ä¹‹åæ˜¯ä¸ªé—­åŒ…ï¼Œä¿å­˜çˆ¶ç±»çš„å¼•ç”¨ï¼Œé—­åŒ…å†…éƒ¨çš„å®ç°æ­¥éª¤ï¼š åˆ¤æ–­è°ƒç”¨å‰æ˜¯å¦æœ‰ new å…³é”®å­— å› ä¸º_inherits å‡½æ•°æ‰§è¡Œåï¼ŒSon.__proto__ || Object.getPrototypeOf(Son)å®é™…ä¸ŠæŒ‡çš„å°±æ˜¯çˆ¶ç±»çš„æ„é€ å‡½æ•°ï¼Œé€šè¿‡ call æ–¹æ³•å°†å…¶è°ƒç”¨æ”¹ä¸ºå½“å‰çš„ this _possibleConstructorReturn å‡½æ•°ä¸­ï¼Œé¦–å…ˆæ ¡éªŒ this æ˜¯å¦è¢«åˆå§‹åŒ–ï¼Œsuper æ˜¯å¦è°ƒç”¨ï¼Œå¹¶è¿”å›çˆ¶ç±»å·²ç»èµ‹å€¼å®Œçš„ thisã€‚ ç„¶åè¿›è¡Œå­ç±»æ„é€ å‡½æ•°ä¸­çš„é€»è¾‘ å½“æˆ‘ä»¬æ²¡æœ‰å†™å­ç±»æ„é€ å‡½æ•°æ—¶ï¼š 12345678910111213class Son extends Father &#123;&#125;// è½¬ä¸ºES5var Son = (function (_Father) &#123; _inherits(Son, _Father); function Son() &#123; _classCallCheck(this, Son); return _possibleConstructorReturn( this, (Son.__proto__ || Object.getPrototypeOf(Son)).apply(this, arguments) ); &#125; return Son;&#125;)(Father); å¯è§é»˜è®¤çš„æ„é€ å‡½æ•°ä¸­ä¼šä¸»åŠ¨è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°ï¼Œå¹¶é»˜è®¤æŠŠå½“å‰ constructor ä¼ é€’çš„å‚æ•°ä¼ ç»™äº†çˆ¶ç±»ã€‚æ‰€ä»¥å½“æˆ‘ä»¬å£°æ˜äº† constructor åå¿…é¡»ä¸»åŠ¨è°ƒç”¨ super(),å¦åˆ™æ— æ³•è°ƒç”¨çˆ¶æ„é€ å‡½æ•°ï¼Œæ— æ³•å®Œæˆç»§æ‰¿ã€‚æœ¬ç¯‡å°±å…ˆå†™åˆ°è¿™å§ï¼Œæ¬¢è¿ç•™è¨€è®¨è®ºã€‚ å‚è€ƒèµ„æ–™ï¼š JavaScript é«˜çº§ç¨‹åºè®¾è®¡ï¼ˆç¬¬ 3 ç‰ˆï¼‰","categories":[{"name":"JSåŸºç¡€","slug":"JSåŸºç¡€","permalink":"https://tomatoesman.github.io/categories/JS%E5%9F%BA%E7%A1%80/"}],"tags":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://tomatoesman.github.io/tags/%E5%89%8D%E7%AB%AF/"},{"name":"javascript","slug":"javascript","permalink":"https://tomatoesman.github.io/tags/javascript/"}]},{"title":"åŸå‹ä¸åŸå‹é“¾","slug":"åŸå‹å’ŒåŸå‹é“¾","date":"2020-04-20T01:07:29.000Z","updated":"2020-06-25T11:52:26.555Z","comments":true,"path":"2020/04/20/åŸå‹å’ŒåŸå‹é“¾/","link":"","permalink":"https://tomatoesman.github.io/2020/04/20/%E5%8E%9F%E5%9E%8B%E5%92%8C%E5%8E%9F%E5%9E%8B%E9%93%BE/","excerpt":"1ã€åˆ›å»ºå¯¹è±¡","text":"1ã€åˆ›å»ºå¯¹è±¡ åˆ›å»ºå¯¹è±¡æœ‰å‡ ç§æ–¹æ³•ï¼š å­—é¢é‡åˆ›å»º 123let obj = &#123; name: \"o1\",&#125;; object æ„é€ å‡½æ•°åˆ›å»º 123let obj = new Object(&#123; name: \"o2\",&#125;); æ„é€ å‡½æ•°åˆ›å»º 1234let Person = function () &#123; this.name = \"o3\";&#125;;let obj = new Person(); object æ–¹æ³•åˆ›å»º 1234let person = &#123; name: \"o4\",&#125;;let obj = Object.create(person); æ­¤æ–¹æ³•æ˜¯ ES6 æ–°å‡ºçš„æ–¹æ³•ï¼Œæ­¤æ–¹æ³•çš„å¥½å¤„å¯ä»¥ç†è§£ä¸ºç»§æ‰¿ä¸€ä¸ªå¯¹è±¡, æ·»åŠ çš„å±æ€§æ˜¯åœ¨åŸå‹ä¸‹ 2ã€åŸå‹ã€æ„é€ å‡½æ•°ã€å®ä¾‹ã€åŸå‹é“¾ æ¯ä¸ªå‡½æ•°éƒ½æœ‰ä¸€ä¸ª prototype çš„å±æ€§ï¼Œæ¯ä¸ªå‡½æ•°é€šè¿‡ prototype å±æ€§æŒ‡å‘çš„å¯¹è±¡ï¼Œæˆ‘ä»¬å°±ç§°ä¹‹ä¸ºåŸå‹å¯¹è±¡ã€‚å¯èƒ½æ¯”è¾ƒç¬¼ç»Ÿï¼Œå¯¹åŸå‹ä¹Ÿå¯ä»¥è¿™æ ·ç†è§£ï¼šæ¯ä¸€ä¸ª JavaScript å¯¹è±¡(null é™¤å¤–)åœ¨åˆ›å»ºçš„æ—¶å€™å°±ä¼šä¸ä¹‹å…³è”å¦ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡å°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„åŸå‹ï¼Œæ¯ä¸€ä¸ªå¯¹è±¡éƒ½ä¼šä»åŸå‹â€ç»§æ‰¿â€å±æ€§ã€‚ æˆ‘ä»¬å¯ä»¥çœ‹çœ‹å¯¹è±¡çš„ prototype åˆ°åº•è¿”å›çš„æ˜¯ä»€ä¹ˆï¼š 12function Person() &#123;&#125;Person.prototype;","categories":[{"name":"JSåŸºç¡€","slug":"JSåŸºç¡€","permalink":"https://tomatoesman.github.io/categories/JS%E5%9F%BA%E7%A1%80/"}],"tags":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://tomatoesman.github.io/tags/%E5%89%8D%E7%AB%AF/"},{"name":"javascript","slug":"javascript","permalink":"https://tomatoesman.github.io/tags/javascript/"}]},{"title":"æ·±æ‹·è´å’Œæµ…æ‹·è´","slug":"æ·±æ‹·è´å’Œæµ…æ‹·è´","date":"2020-04-17T07:23:42.000Z","updated":"2020-06-25T11:52:22.215Z","comments":true,"path":"2020/04/17/æ·±æ‹·è´å’Œæµ…æ‹·è´/","link":"","permalink":"https://tomatoesman.github.io/2020/04/17/%E6%B7%B1%E6%8B%B7%E8%B4%9D%E5%92%8C%E6%B5%85%E6%8B%B7%E8%B4%9D/","excerpt":"è¿™å±äºé¢è¯•çš„é«˜é¢‘é—®é¢˜äº†ï¼Œæ·±æµ…æ‹·è´çš„é—®é¢˜åªé’ˆå¯¹äºå¼•ç”¨æ•°æ®ç±»å‹ï¼Œå¯¹äºåŸºæœ¬æ•°æ®ç±»å‹å¹¶æ²¡æœ‰è¿™æ ·çš„é—®é¢˜ã€‚ä¸ºä»€ä¹ˆå¼•ç”¨æ•°æ®ç±»å‹ä¼šå‡ºç°è¿™æ ·çš„é—®é¢˜ï¼Ÿç¬¬ä¸€ç¯‡ js æ•°æ®ç±»å‹ä¸­æœ‰æåˆ°ï¼Œå¼•ç”¨æ•°æ®ç±»å‹å­˜æ”¾åœ¨å †ä¸­ï¼Œæ ˆä¸­å­˜æ”¾çš„æ˜¯è¯¥å¼•ç”¨ç±»å‹çš„åœ°å€ï¼Œä»¥ä¾¿èƒ½é€šè¿‡åœ°å€å¿«é€Ÿæ‰¾åˆ°è¯¥å¼•ç”¨æ•°æ®ã€‚æ‰€ä»¥åœ¨æ‹·è´æ—¶å°±ä¼šå‡ºç°åªæ‹·è´å¼•ç”¨ç±»å‹çš„åœ°å€å’Œå†åœ¨å †ä¸­å¼€è¾Ÿä¸€ä¸ªæ–°çš„å†…å­˜ç©ºé—´çš„ä¸¤ç§æ‹·è´æ–¹å¼ã€‚","text":"è¿™å±äºé¢è¯•çš„é«˜é¢‘é—®é¢˜äº†ï¼Œæ·±æµ…æ‹·è´çš„é—®é¢˜åªé’ˆå¯¹äºå¼•ç”¨æ•°æ®ç±»å‹ï¼Œå¯¹äºåŸºæœ¬æ•°æ®ç±»å‹å¹¶æ²¡æœ‰è¿™æ ·çš„é—®é¢˜ã€‚ä¸ºä»€ä¹ˆå¼•ç”¨æ•°æ®ç±»å‹ä¼šå‡ºç°è¿™æ ·çš„é—®é¢˜ï¼Ÿç¬¬ä¸€ç¯‡ js æ•°æ®ç±»å‹ä¸­æœ‰æåˆ°ï¼Œå¼•ç”¨æ•°æ®ç±»å‹å­˜æ”¾åœ¨å †ä¸­ï¼Œæ ˆä¸­å­˜æ”¾çš„æ˜¯è¯¥å¼•ç”¨ç±»å‹çš„åœ°å€ï¼Œä»¥ä¾¿èƒ½é€šè¿‡åœ°å€å¿«é€Ÿæ‰¾åˆ°è¯¥å¼•ç”¨æ•°æ®ã€‚æ‰€ä»¥åœ¨æ‹·è´æ—¶å°±ä¼šå‡ºç°åªæ‹·è´å¼•ç”¨ç±»å‹çš„åœ°å€å’Œå†åœ¨å †ä¸­å¼€è¾Ÿä¸€ä¸ªæ–°çš„å†…å­˜ç©ºé—´çš„ä¸¤ç§æ‹·è´æ–¹å¼ã€‚ 1ã€æµ…æ‹·è´12345let arr = [1, 2, 3];let new_arr = arr;arr.push(4);console.log(arr); //[1, 2, 3, 4]console.log(new_arr); //[1, 2, 3, 4] å¼€å‘æ—¶æˆ‘ä»¬ç»å¸¸èƒ½é‡åˆ°ä¸Šé¢è¿™ç§æƒ…å†µï¼Œå½“å¯¹åŸæ•°ç»„æ·»åŠ æ–°å€¼æ—¶ï¼Œæ–°æ•°ç»„ä¹Ÿä¼šå‘ç”Ÿæ”¹å˜ï¼Œè¿™ç§æƒ…å†µæˆ‘ä»¬å°±ç§°ä¹‹ä¸ºæµ…æ‹·è´ã€‚åŸå› æ˜¯æµ…æ‹·è´åªæ‹·è´å¼•ç”¨åœ°å€ï¼Œè€Œåœ°å€éƒ½æ˜¯æŒ‡å‘äº†åŒä¸€ä¸ªå¯¹è±¡ï¼Œæ‰€ä»¥å½¼æ­¤ä¹‹é—´çš„æ”¹å˜ä¼šç›¸äº’å½±å“ã€‚å¤§éƒ¨åˆ†æƒ…å†µä¸‹çš„æ‹·è´éƒ½æ˜¯æµ…æ‹·è´ï¼Œé™¤äº†ä¸Šé¢=ï¼ˆèµ‹å€¼ï¼‰å¤–å®ç°æµ…æ‹·è´çš„æ–¹æ³•ä¹Ÿæœ‰å¾ˆå¤šï¼š 12345concat();slice();ES6æ–°å¢ï¼šå±•å¼€è¿ç®—ç¬¦(...)Array.from() ä¸Šè¿°æ–¹æ³•ä¸­ concat ä¼šæœ‰äº›ç‰¹æ®Šï¼š 12345let arr = [1, 2, 3];let new_arr = [].concat(arr);arr.push(4);console.log(arr); //[1, 2, 3, 4]console.log(new_arr); //[1, 2, 3] ä¸Šè¿°ç»“æœæ˜¾ç¤ºï¼Œå½“æ”¹å˜åŸæ•°ç»„æ—¶ï¼Œæ–°æ•°ç»„å¹¶æ²¡æœ‰å‘ç”Ÿæ”¹å˜ï¼Œä¼šä»¥ä¸º concat å±äºæ·±æ‹·è´çš„æ–¹æ³•ã€‚ä½†å½“è¿›è¡Œä¸‹è¿°è¿ç®—æ—¶ï¼š 123456var arr = [&#123; old: \"old\" &#125;, [\"old\"]];var new_arr = arr.concat();arr[0].old = \"new\";arr[1][0] = \"new\";console.log(arr); //[&#123;old: 'new'&#125;, ['new']]console.log(new_arr); //[&#123;old: 'new'&#125;, ['new']] æ‰€ä»¥å¯ä»¥å¾—å‡ºç»“è®ºï¼Œå½“æ•°ç»„å…ƒç´ æ˜¯åŸºæœ¬æ•°æ®ç±»å‹æ—¶ï¼Œå°±ä¼šæ‹·è´ä¸€ä»½ï¼Œäº’ä¸å½±å“ï¼Œè€Œå¦‚æœæ˜¯å¯¹è±¡æˆ–è€…æ•°ç»„ï¼Œå°±ä¼šåªæ‹·è´å¯¹è±¡å’Œæ•°ç»„çš„å¼•ç”¨ï¼Œè¿™æ ·æˆ‘ä»¬æ— è®ºåœ¨æ–°æ—§æ•°ç»„è¿›è¡Œäº†ä¿®æ”¹ï¼Œä¸¤è€…éƒ½ä¼šå‘ç”Ÿå˜åŒ–ã€‚ æˆ‘ä»¬æ¥å†™ä¸ªå‡½æ•°ç®€å•å®ç°ä¸€ä¸ªæµ…æ‹·è´ï¼š 12345678910let shallowCopy = (obj) =&gt; &#123; if (typeof obj !== \"object\") return; let new_obj = obj instanceof Array ? [] : &#123;&#125;; for (let key in obj) &#123; if (obj.hasOwnProperty(key)) &#123; new_obj[key] = obj[key]; &#125; &#125; return new_obj;&#125;; 2ã€æ·±æ‹·è´æ·±æ‹·è´æ˜¯å®Œå…¨æ‹·è´ä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œç›¸å½“äºå¼€è¾Ÿäº†ä¸€ä¸ªæ–°çš„å†…å­˜ç©ºé—´ï¼Œæ–°æ—§ä¸¤ä¸ªå¯¹è±¡ä¸ç›¸äº’å½±å“ã€‚å®ç°æ·±æ‹·è´çš„æ–¹æ³•ä¸»è¦æœ‰ä¸¤ä¸ªï¼Œä¸€ä¸ªæ˜¯ JSON.parse(JSON.stringify())å’Œè¿˜æœ‰ä¸€ä¸ªæ˜¯é€’å½’ 123456let arr = [&#123; old: \"old\" &#125;, [\"old\"]];let new_arr = JSON.parse(JSON.stringify(arr));arr[0].old = \"new\";arr[1][0] = \"new\";console.log(arr); //[&#123;old: 'new'&#125;, ['new']]console.log(new_arr); //[&#123;old: 'old'&#125;, ['old']] ä½†æ˜¯ JSON.parse(JSON.stringify())æœ‰ä¸ªæœ€å¤§çš„é—®é¢˜å°±æ˜¯ï¼Œä¸èƒ½æ‹·è´å‡½æ•° 123let arr = [&#123; old: \"old\" &#125;, function () &#123;&#125;];let new_arr = JSON.parse(JSON.stringify(arr));console.log(new_arr); //[&#123;old: 'old'&#125;, null] æˆ‘ä»¬é€šè¿‡é€’å½’çš„å½¢å¼ç®€å•å®ç°ä¸€ä¸ªæ·±æ‹·è´ï¼š 1234567891011let deepCopy = (obj) =&gt; &#123; if (typeof obj !== Object) return; let new_obj = obj instanceof Array ? [] : &#123;&#125;; for (let key in obj) &#123; if (obj.hasOwnProperty(key)) &#123; new_obj[key] = typeof obj[key] === \"object\" ? deepCopy(obj[key]) : obj[key]; &#125; &#125; return new_obj;&#125;;","categories":[{"name":"JSåŸºç¡€","slug":"JSåŸºç¡€","permalink":"https://tomatoesman.github.io/categories/JS%E5%9F%BA%E7%A1%80/"}],"tags":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://tomatoesman.github.io/tags/%E5%89%8D%E7%AB%AF/"},{"name":"javascript","slug":"javascript","permalink":"https://tomatoesman.github.io/tags/javascript/"}]},{"title":"ç±»å‹è½¬æ¢","slug":"ç±»å‹è½¬æ¢","date":"2020-04-17T03:38:47.000Z","updated":"2020-07-21T14:43:54.567Z","comments":true,"path":"2020/04/17/ç±»å‹è½¬æ¢/","link":"","permalink":"https://tomatoesman.github.io/2020/04/17/%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/","excerpt":"1ã€æ˜¾ç¤ºç±»å‹è½¬æ¢æ˜¾ç¤ºç±»å‹è½¬æ¢é¡¾åæ€ä¹‰å°±æ˜¯ç”¨ç‰¹æœ‰çš„æ–¹æ³•å¯¹ç±»å‹è¿›è¡Œè½¬æ¢æ˜¾ç¤ºç±»å‹è½¬æ¢çš„æ–¹å¼åªæœ‰ä¸‰ç§ï¼š","text":"1ã€æ˜¾ç¤ºç±»å‹è½¬æ¢æ˜¾ç¤ºç±»å‹è½¬æ¢é¡¾åæ€ä¹‰å°±æ˜¯ç”¨ç‰¹æœ‰çš„æ–¹æ³•å¯¹ç±»å‹è¿›è¡Œè½¬æ¢æ˜¾ç¤ºç±»å‹è½¬æ¢çš„æ–¹å¼åªæœ‰ä¸‰ç§ï¼š 1ã€Number() åŸå§‹ç±»å‹è½¬æ¢ æ•°å€¼ï¼šè½¬æ¢åè¿˜æ˜¯æ•°å€¼ å­—ç¬¦ä¸²ï¼šå¦‚æœå¯ä»¥è¢«è§£æä¸ºæ•°å€¼ï¼Œåˆ™è½¬åŒ–ä¸ºç›¸åº”çš„æ•°å€¼ä¼šå¿½ç•¥æ‰€æœ‰å‰å¯¼çš„ 0ï¼Œå¦åˆ™å¾—åˆ° NaNï¼Œç©ºå­—ç¬¦ä¸²ä¸º 0 1Number(\"000001\"); //1 å¸ƒå°”å€¼ï¼štrue è½¬æˆ 1ï¼Œfalse è½¬æˆ 0 undefinedï¼šè½¬æˆ NaN nullï¼šè½¬æˆ 0 å¯¹è±¡ç±»å‹è½¬æ¢ å…ˆè°ƒç”¨å¯¹è±¡è‡ªèº«çš„ valueOf æ–¹æ³•ï¼Œå¦‚æœè¯¥æ–¹æ³•è¿”å›åŸå§‹ç±»å‹çš„å€¼ï¼ˆæ•°å€¼ã€å­—ç¬¦ä¸²å’Œå¸ƒå°”å€¼ï¼‰ï¼Œåˆ™ç›´æ¥å¯¹è¯¥å€¼ä½¿ç”¨ Number æ–¹æ³•ï¼Œä¸å†è¿›è¡Œåç»­æ­¥éª¤ å¦‚æœ valueOf æ–¹æ³•è¿”å›å¤åˆç±»å‹çš„å€¼ï¼Œå†è°ƒç”¨å¯¹è±¡è‡ªèº«çš„ toString æ–¹æ³•ï¼Œå¦‚æœ toString æ–¹æ³•è¿”å›åŸå§‹ç±»å‹çš„å€¼ï¼Œåˆ™å¯¹è¯¥å€¼ä½¿ç”¨ Number æ–¹æ³•ï¼Œä¸å†è¿›è¡Œåç»­æ­¥éª¤ å¦‚æœ toString æ–¹æ³•è¿”å›çš„æ˜¯å¤åˆç±»å‹çš„å€¼ï¼Œåˆ™æŠ¥é”™ parseInt å’Œ parseFloat parseIntï¼šåªè§£ææ•´æ•°ï¼Œå½“ä¼ å…¥çš„å€¼ä»¥â€˜0xâ€™æˆ–â€˜0Xâ€™å¼€å¤´æ—¶ï¼Œä¼šè§£ææˆåå…­è¿›åˆ¶æ•° parseFloatï¼šæ—¢å¯ä»¥è§£ææ•´æ•°åˆå¯ä»¥è§£ææµ®ç‚¹æ•° å…±åŒç‚¹ï¼šéƒ½ä¼šè·³è¿‡ä»»æ„æ•°é‡çš„å‰å¯¼ç©ºæ ¼ï¼Œå°½å¯èƒ½è§£ææ›´å¤šæ•°å€¼å­—ç¬¦ï¼Œå¹¶å¿½ç•¥åé¢çš„å†…å®¹ã€‚å¦‚æœç¬¬ä¸€ä¸ªéç©ºæ ¼å­—ç¬¦æ˜¯éæ³•çš„æ•°å­—ç›´æ¥é‡ï¼Œå°†æœ€ç»ˆè¿”å› NaN 2ã€String() åŸå§‹ç±»å‹è½¬æ¢ æ•°å€¼ï¼šè½¬ä¸ºç›¸åº”çš„å­—ç¬¦ä¸² å­—ç¬¦ä¸²ï¼šè½¬æ¢åè¿˜æ˜¯åŸæ¥çš„å€¼ å¸ƒå°”å€¼ï¼štrue è½¬ä¸ºâ€˜trueâ€™ï¼Œfalse è½¬ä¸ºâ€˜falseâ€™ undefinedï¼šè½¬ä¸ºâ€˜undefined nullï¼šè½¬ä¸ºâ€˜nullâ€™ å¯¹è±¡ç±»å‹è½¬æ¢ å…ˆè°ƒç”¨ toString æ–¹æ³•ï¼Œå¦‚æœ toString æ–¹æ³•è¿”å›çš„æ˜¯åŸå§‹ç±»å‹çš„å€¼ï¼Œåˆ™å¯¹è¯¥å€¼ä½¿ç”¨ String æ–¹æ³•ï¼Œä¸å†è¿›è¡Œä»¥ä¸‹æ­¥éª¤ å¦‚æœ toString æ–¹æ³•è¿”å›çš„æ˜¯å¤åˆç±»å‹çš„å€¼ï¼Œå†è°ƒç”¨ valueOf æ–¹æ³•ï¼Œå¦‚æœ valueOf æ–¹æ³•è¿”å›çš„æ˜¯åŸå§‹ç±»å‹çš„å€¼ï¼Œåˆ™å¯¹è¯¥å€¼ä½¿ç”¨ String æ–¹æ³•ï¼Œä¸å†è¿›è¡Œä»¥ä¸‹æ­¥éª¤ å¦‚æœ valueOf æ–¹æ³•è¿”å›çš„æ˜¯å¤åˆç±»å‹çš„å€¼ï¼Œåˆ™æŠ¥é”™ JSON.stringify()JSON.stringify åº•å±‚ä¹Ÿæ˜¯è°ƒç”¨äº† toString æ–¹æ³• 3ã€Boolean()undefinedã€nullã€-0ã€+0ã€NaNã€â€™â€™ï¼ˆç©ºå­—ç¬¦ä¸²ï¼‰è¿”å›çš„éƒ½æ˜¯ falseï¼Œé™¤äº†ä¸Šè¿°çš„éƒ½æ˜¯è¿”å› trueï¼ŒåŒ…æ‹¬å¯¹è±¡ç±»å‹ 2ã€éšå¼ç±»å‹è½¬æ¢éšå¼ç±»å‹è½¬æ¢åŒæ ·æœ‰ä¸‰ç§ï¼š 1ã€+ï¼ˆåŠ å·ï¼‰1.1 ä¸€å…ƒ+ï¼ˆåŠ å·ï¼‰è¿ç®—ç¬¦æŸ¥çœ‹ES5 è§„èŒƒ 11.4.6å¯ä»¥çœ‹åˆ°ï¼Œå½“+ï¼ˆåŠ å·ï¼‰ä½œä¸ºä¸€å…ƒè¿ç®—ç¬¦æ—¶ï¼Œåº•å±‚ä¼šè°ƒç”¨ ToNumber æ–¹æ³•å»å¤„ç†ï¼Œç›¸å½“äº Number()ï¼Œå½“+ï¼ˆåŠ å·ï¼‰åæ˜¯æ™®é€šæ•°å€¼æ—¶ï¼Œè¿”å›çš„å°±æ˜¯ Number(æ•°å€¼) 1+\"1\"; //1 å½“+ï¼ˆåŠ å·ï¼‰åæ˜¯å¯¹è±¡ç±»å‹æ—¶ï¼Œå¯¹è±¡ç±»å‹å°±ä¼šåƒæ˜¾ç¤ºç±»å‹ä¸­æ‰€è®²ï¼š å…ˆè°ƒç”¨å¯¹è±¡è‡ªèº«çš„ valueOf æ–¹æ³•ï¼Œå¦‚æœè¯¥æ–¹æ³•è¿”å›åŸå§‹ç±»å‹çš„å€¼ï¼ˆæ•°å€¼ã€å­—ç¬¦ä¸²å’Œå¸ƒå°”å€¼ï¼‰ï¼Œåˆ™ç›´æ¥å¯¹è¯¥å€¼ä½¿ç”¨ Number æ–¹æ³•ï¼Œä¸å†è¿›è¡Œåç»­æ­¥éª¤ å¦‚æœ valueOf æ–¹æ³•è¿”å›å¤åˆç±»å‹çš„å€¼ï¼Œå†è°ƒç”¨å¯¹è±¡è‡ªèº«çš„ toString æ–¹æ³•ï¼Œå¦‚æœ toString æ–¹æ³•è¿”å›åŸå§‹ç±»å‹çš„å€¼ï¼Œåˆ™å¯¹è¯¥å€¼ä½¿ç”¨ Number æ–¹æ³•ï¼Œä¸å†è¿›è¡Œåç»­æ­¥éª¤ å¦‚æœ toString æ–¹æ³•è¿”å›çš„æ˜¯å¤åˆç±»å‹çš„å€¼ï¼Œåˆ™æŠ¥é”™ 12+[]; //0 []å…ˆè°ƒç”¨valueofæ–¹æ³•è¿”å›[]ï¼Œå†è°ƒç”¨toStringæ–¹æ³•è¿”å›\"\"+&#123;&#125;; //NaN &#123;&#125;ç›¸å½“äºnew Object() å…ˆè°ƒç”¨valueofæ–¹æ³•è¿”å›&#123;&#125;ï¼Œå†è°ƒç”¨toStringæ–¹æ³•è¿”å›\"[object Object]\" 1.2 äºŒå…ƒ+ï¼ˆåŠ å·ï¼‰è¿ç®—ç¬¦æŸ¥çœ‹ES5 è§„èŒƒ 11.6.1å¯ä»¥çœ‹åˆ°å½“ value1+value2 æ—¶ï¼š 1. lprim = ToPrimitive(value1) 2. rprim = ToPrimitive(value2) 3. å¦‚æœ lprim å’Œ rprim éƒ½æ˜¯ String ç±»å‹æ—¶ï¼Œåˆ™ç›´æ¥è¿”å› ToString(lprim)å’Œ ToString(rprim)æ‹¼æ¥ç»“æœ 4. è¿”å› ToNumber(lprim) å’Œ ToNumber(rprim)çš„è¿ç®—ç»“æœToPrimitiveã€ToStringã€ToNumber ä¸‰è€…çš†ä¸ºå†…éƒ¨å‡½æ•°: ToPrimitive æ‰§è¡Œçš„æ­¥éª¤ï¼š å¦‚æœ obj ä¸ºåŸºæœ¬ç±»å‹ï¼Œç›´æ¥è¿”å› å¦åˆ™ï¼Œè°ƒç”¨ valueOf æ–¹æ³•ï¼Œå¦‚æœè¿”å›ä¸€ä¸ªåŸå§‹å€¼ï¼Œåˆ™ JavaScript å°†å…¶è¿”å›ã€‚ å¦åˆ™ï¼Œè°ƒç”¨ toString æ–¹æ³•ï¼Œå¦‚æœè¿”å›ä¸€ä¸ªåŸå§‹å€¼ï¼Œåˆ™ JavaScript å°†å…¶è¿”å›ã€‚ å¦åˆ™ï¼ŒJavaScript æŠ›å‡ºä¸€ä¸ªç±»å‹é”™è¯¯å¼‚å¸¸ã€‚ ToString ç›¸å½“äº String() ToNumber ç›¸å½“äº Number() æŒ‰ä¸Šè¿°è§„èŒƒï¼Œå¯¹ä¸‹åˆ—å‡ ä¸ªä¾‹å­è¿›è¡Œè®²è§£ï¼š 12345null + 1; //1//1ã€lprim = ToPrimitive(null) å› ä¸ºnullä¸ºåŸºæœ¬æ•°æ®ç±»å‹ï¼Œæ‰€ä»¥è¿”å›null//2ã€lprim = ToPrimitive(1) å› ä¸º1ä¸ºåŸºæœ¬æ•°æ®ç±»å‹ï¼Œæ‰€ä»¥è¿”å›1//3ã€lprimå’Œlpriméƒ½ä¸æ˜¯Stringç±»å‹ï¼Œæ‰€ä»¥æ‰§è¡Œç¬¬å››éƒ¨//4ã€ToNumber(null)+ToNumber(1),æ‰€ä»¥è¿”å›ä¸º1 12345undefined + 1; //NaNnull//1ã€lprim = ToPrimitive(undefined) å› ä¸ºundefinedä¸ºåŸºæœ¬æ•°æ®ç±»å‹ï¼Œæ‰€ä»¥è¿”å›undefined//2ã€lprim = ToPrimitive(1) å› ä¸º1ä¸ºåŸºæœ¬æ•°æ®ç±»å‹ï¼Œæ‰€ä»¥è¿”å›1//3ã€lprimå’Œlpriméƒ½ä¸æ˜¯Stringç±»å‹ï¼Œæ‰€ä»¥æ‰§è¡Œç¬¬å››éƒ¨//4ã€ToNumber(undefined)+ToNumber(1),æ‰€ä»¥è¿”å›ä¸ºNaN 1234[] + []; //''//1ã€lprim = ToPrimitive([]) []çš„valueofä¸º[]ä¸æ˜¯åŸºæœ¬æ•°æ®ç±»å‹ï¼Œå†è°ƒç”¨toStringæ–¹æ³•è¿”å›çš„æ˜¯''//2ã€lprim = ToPrimitive([]) []çš„valueofä¸º[]ä¸æ˜¯åŸºæœ¬æ•°æ®ç±»å‹ï¼Œå†è°ƒç”¨toStringæ–¹æ³•è¿”å›çš„æ˜¯''//3ã€lprimå’Œlpriméƒ½æ˜¯Stringç±»å‹ï¼Œæ‰€ä»¥ç›´æ¥è¿”å›æ‹¼æ¥ï¼Œç»“æœä¸º'' 1234[] + &#123;&#125;; //'[object Object]'//1ã€lprim = ToPrimitive([]) []çš„valueofä¸º[]ä¸æ˜¯åŸºæœ¬æ•°æ®ç±»å‹ï¼Œå†è°ƒç”¨toStringæ–¹æ³•è¿”å›çš„æ˜¯''//2ã€lprim = ToPrimitive(&#123;&#125;) &#123;&#125;çš„valueofä¸º&#123;&#125;ä¸æ˜¯åŸºæœ¬æ•°æ®ç±»å‹ï¼Œå†è°ƒç”¨toStringæ–¹æ³•è¿”å›çš„æ˜¯'[object Object]'//3ã€lprimå’Œlpriméƒ½æ˜¯Stringç±»å‹ï¼Œæ‰€ä»¥ç›´æ¥è¿”å›æ‹¼æ¥ï¼Œç»“æœä¸º'[object Object]' 123&#123;&#125; + []; //0//æŒ‰ç…§è§„èŒƒæ¥è¯´ï¼Œè¿™ä¸ªçš„ç»“æœåº”è¯¥å’Œä¸Šä¸€ä¸ªä¸€æ ·ï¼Œä½†æ˜¯ä¸ºä»€ä¹ˆä¼šå‡ºç°å¦‚æ­¤çš„ä¸åŒï¼Œæ˜¯å› ä¸ºåœ¨æµè§ˆå™¨ä¸­ï¼Œ&#123;&#125;ç›¸å½“äºä¸€ä¸ªç‹¬ç«‹çš„ä»£ç å—ï¼Œæ‰€ä»¥æµè§ˆå™¨è®¤ä¸º&#123;&#125;+[]ç›¸å½“äº+[]ï¼Œæ‰€ä»¥è¿”å›0//å¦‚æœæƒ³è¿”å›å’Œä¸Šä¸€ä¸ªä¸€æ ·çš„ç»“æœçš„è¯å¯ä»¥åœ¨è¡¨è¾¾å¼å¤–åŠ æ‹¬å·,(&#123;&#125; + [])è¿™æ ·å°±è¿”å›æ­£å¸¸çš„ç»“æœäº† 1&#123;&#125; + &#123;&#125;; //è°·æ­Œè¿”å›'[object Object][object Object]' ç«ç‹è¿”å›NaN 2ã€æ¯”è¾ƒè¿ç®—2.1 ==ç›¸ç­‰åŒæ ·æˆ‘ä»¬æŸ¥çœ‹ES5 è§„èŒƒ 11.9.3ä¸­æ‰€è®²ï¼šæ¯”è¾ƒ x == yï¼Œå…¶ä¸­ x å’Œ y æ˜¯å€¼ï¼Œäº§ç”Ÿ true æˆ– falseã€‚è¿™æ ·çš„æ¯”è¾ƒæ‰§è¡Œå¦‚ä¸‹ï¼š 1. å¦‚æœ x,y ç±»å‹ç›¸åŒï¼Œåˆ™ a. å¦‚æœ x æ˜¯ Undefinedï¼Œåˆ™è¿”å› trueã€‚ b. å¦‚æœ x ä¸º Nullï¼Œåˆ™è¿”å› trueã€‚ c. å¦‚æœ x æ˜¯æ•°å­—ï¼Œåˆ™ i. å¦‚æœ x ä¸º NaNï¼Œåˆ™è¿”å› falseã€‚ ii. å¦‚æœ y ä¸º NaNï¼Œåˆ™è¿”å› falseã€‚ iii. å¦‚æœ x ä¸ y ç›¸åŒï¼Œåˆ™è¿”å› trueã€‚ iv. å¦‚æœ x ä¸º+0 ä¸” y ä¸º âˆ’ 0ï¼Œåˆ™è¿”å› trueã€‚ v. å¦‚æœ x ä¸º âˆ’ 0 ä¸” y ä¸º+0ï¼Œåˆ™è¿”å› trueã€‚ vi.è¿”å› falseã€‚ d. å¦‚æœ x ç±»å‹ä¸º Stringï¼Œåˆ™å¦‚æœ x å’Œ y æ˜¯å®Œå…¨ç›¸åŒçš„å­—ç¬¦åºåˆ—ï¼ˆç›¸åŒçš„é•¿åº¦å’Œç›¸åŒä½ç½®çš„ç›¸åŒå­—ç¬¦ï¼‰ï¼Œåˆ™è¿”å› trueã€‚å¦åˆ™ï¼Œè¿”å› falseã€‚ e. å¦‚æœ x ç±»å‹ä¸ºå¸ƒå°”å€¼ï¼Œåˆ™å¦‚æœ x å’Œ y å‡ä¸º true æˆ–å‡ä¸º falseï¼Œåˆ™è¿”å› trueã€‚å¦åˆ™ï¼Œè¿”å› falseã€‚ f. å¦‚æœ x å’Œ y æŒ‡å‘åŒä¸€å¯¹è±¡ï¼Œåˆ™ è¿”å› trueã€‚å¦åˆ™ï¼Œè¿”å› falseã€‚ 2. å¦‚æœ x æ˜¯ Null å’Œ y æ˜¯ Undefined çš„ï¼Œè¿”å› trueã€‚ 3. å¦‚æœ X æ˜¯ Undefined å’Œ y ä¸º Nullï¼Œè¿”å› trueã€‚ 4. å¦‚æœ x ç±»å‹æ˜¯ Number ä¸” y ç±»å‹æ˜¯ Stringï¼Œåˆ™è¿”å›æ¯”è¾ƒç»“æœ x == ToNumberï¼ˆyï¼‰ã€‚ 5. å¦‚æœ x ç±»å‹ä¸º String ä¸” y ç±»å‹ä¸º Numberï¼Œåˆ™è¿”å›æ¯”è¾ƒç»“æœ ToNumberï¼ˆxï¼‰== yã€‚ 6. å¦‚æœ x ç±»å‹ä¸ºå¸ƒå°”å€¼ï¼Œåˆ™è¿”å›æ¯”è¾ƒç»“æœ ToNumberï¼ˆxï¼‰== yã€‚ 7. å¦‚æœ y ç±»å‹ä¸ºå¸ƒå°”å‹ï¼Œåˆ™è¿”å›æ¯”è¾ƒç»“æœ x == ToNumberï¼ˆyï¼‰ã€‚ 8. å¦‚æœ x ç±»å‹æ˜¯ String æˆ– Number ä¸” y ç±»å‹æ˜¯ Objectï¼Œåˆ™è¿”å›æ¯”è¾ƒç»“æœ x == ToPrimitiveï¼ˆyï¼‰ã€‚ 9. å¦‚æœ x ç±»å‹æ˜¯ Object å¹¶ä¸” y ç±»å‹æ˜¯ String æˆ– Numberï¼Œåˆ™è¿”å›æ¯”è¾ƒç»“æœ ToPrimitiveï¼ˆxï¼‰== yã€‚ 10. è¿”å› falseã€‚æŒ‰ä¸Šè¿°è§„èŒƒï¼Œå¯¹ä¸‹åˆ—å‡ ä¸ªä¾‹å­è¿›è¡Œè®²è§£ï¼š 123undefined == undefined; //truenull == null; //ture//æŸ¥çœ‹ä¸Šè¿°çš„1.aã€1.bæ¡ 12NaN == NaN; //false//æŸ¥çœ‹ä¸Šè¿°çš„1.c.iæ¡ 123undefined == null; //truenull == undefined; //ture//æŸ¥çœ‹ä¸Šè¿°çš„2ã€3æ¡ 1231 == \"1\"; //true\"1\" == 1; //ture//æŸ¥çœ‹ä¸Šè¿°çš„4ã€5æ¡ 123false == 0; //true0 == false; //ture//æŸ¥çœ‹ä¸Šè¿°çš„6ã€7æ¡ 123[] == 0; //true0 == []; //ture//æŸ¥çœ‹ä¸Šè¿°çš„8ã€9æ¡ 2.2 &lt;åˆ¤æ–­åŒæ ·æˆ‘ä»¬æŸ¥çœ‹ES5 è§„èŒƒ 11.8.5ä¸­æ‰€è®²ï¼šæ¯”è¾ƒ x &lt; yï¼ˆå…¶ä¸­ x å’Œ y æ˜¯å€¼ï¼‰ä¼šäº§ç”Ÿ trueï¼Œfalse æˆ– undefinedï¼ˆè¿™è¡¨æ˜è‡³å°‘ä¸€ä¸ªæ“ä½œæ•°æ˜¯ NaNï¼‰ã€‚é™¤ x å’Œ y å¤–ï¼Œè¯¥ç®—æ³•è¿˜ä½¿ç”¨åä¸º LeftFirst çš„å¸ƒå°”æ ‡å¿— ä½œä¸ºå‚æ•°ã€‚è¯¥æ ‡å¿—ç”¨äºæ§åˆ¶å¯¹ x å’Œ y è¿›è¡Œå…·æœ‰æ½œåœ¨å¯è§å‰¯ä½œç”¨çš„æ“ä½œçš„é¡ºåº ã€‚è¿™æ˜¯å¿…éœ€çš„ï¼Œå› ä¸º ECMAScript æŒ‡å®šäº†ä»å·¦åˆ°å³çš„è¡¨è¾¾å¼æ±‚å€¼ã€‚LeftFirst çš„é»˜è®¤å€¼ ä¸º trueï¼Œè¡¨ç¤º x å‚æ•°å¯¹åº”äº y å‚æ•°å¯¹åº”è¡¨è¾¾å¼å·¦ä¾§å‡ºç°çš„è¡¨è¾¾å¼ã€‚å¦‚æœ LeftFirst ä¸ºå‡ï¼Œåˆ™ç›¸åï¼Œæ“ä½œå¿…é¡»åœ¨ x ä¹‹å‰å¯¹ y æ‰§è¡Œã€‚è¿™æ ·çš„æ¯”è¾ƒæ‰§è¡Œå¦‚ä¸‹ï¼š 1. å¦‚æœLeftFirstæ ‡å¿—ä¸ºtrueï¼Œåˆ™ a. è®¾ pxä¸ºè°ƒç”¨ToPrimitiveçš„ç»“æœï¼ˆxï¼ŒNumberï¼‰ã€‚ b. ä»¤ pyä¸ºè°ƒç”¨ToPrimitiveçš„ç»“æœï¼ˆyï¼ŒNumberï¼‰ã€‚ 2. å¦åˆ™éœ€è¦é¢ å€’è¯„ä¼°é¡ºåºä»¥ä¿ç•™ä»å·¦åˆ°å³çš„è¯„ä¼° a. ä»¤ pyä¸ºè°ƒç”¨ToPrimitiveçš„ç»“æœï¼ˆyï¼ŒNumberï¼‰ã€‚ b. è®¾ pxä¸ºè°ƒç”¨ToPrimitiveçš„ç»“æœï¼ˆxï¼ŒNumberï¼‰ã€‚ 3. å¦‚æœpxå’Œpyéƒ½ä¸æ˜¯Stringç±»å‹ï¼Œåˆ™ a. ä»¤ nxä¸ºè°ƒç”¨ToNumberï¼ˆpxï¼‰çš„ç»“æœã€‚å› ä¸ºpxå’Œpyæ˜¯åŸå§‹å€¼ï¼Œæ‰€ä»¥è¯„ä¼°é¡ºåºå¹¶ä¸é‡è¦ã€‚ b. ä»¤ nyä¸ºè°ƒç”¨ToNumberï¼ˆpyï¼‰çš„ç»“æœã€‚ c. å¦‚æœ nxæ˜¯NaNï¼Œåˆ™è¿”å›undefinedã€‚ d. å¦‚æœ nyæ˜¯NaNï¼Œåˆ™è¿”å›undefinedã€‚ e. å¦‚æœ nxå’Œnyæ˜¯ç›¸åŒçš„Numberå€¼ï¼Œåˆ™è¿”å›falseã€‚ f. å¦‚æœ nxä¸º+0ä¸”nyä¸ºâˆ’ 0ï¼Œåˆ™è¿”å›falseã€‚ g. å¦‚æœ nxä¸ºâˆ’ 0 ä¸”nyä¸º+0ï¼Œåˆ™è¿”å›falseã€‚ h. å¦‚æœ nxä¸º+ âˆï¼Œåˆ™è¿”å›falseã€‚ i. å¦‚æœ nyä¸º+ âˆï¼Œåˆ™è¿”å›trueã€‚ j. å¦‚æœ nyä¸º-âˆï¼Œåˆ™è¿”å›falseã€‚ k. å¦‚æœ nxä¸º-âˆï¼Œåˆ™è¿”å›trueã€‚ l. å¦‚æœnxçš„æ•°å­¦å€¼å°äºnyçš„æ•°å­¦å€¼ï¼ˆè¯·æ³¨æ„ï¼Œè¿™äº›æ•°å­¦å€¼éƒ½æ˜¯æœ‰é™çš„ä¸”ä¸éƒ½æ˜¯é›¶ï¼‰ï¼Œåˆ™è¿”å›trueã€‚å¦åˆ™ï¼Œè¿”å› falseã€‚ 4. å¦åˆ™ï¼Œpxå’Œpyéƒ½æ˜¯å­—ç¬¦ä¸² a. å¦‚æœ pyæ˜¯pxçš„å‰ç¼€ï¼Œåˆ™è¿”å›falseã€‚ï¼ˆå¦‚æœq å¯ä»¥æ˜¯è¿æ¥på’Œå…¶ä»–String rçš„ç»“æœï¼Œåˆ™Stringå€¼pæ˜¯Stringå€¼qçš„å‰ç¼€ã€‚è¯·æ³¨æ„ï¼Œä»»ä½•Stringéƒ½æ˜¯å…¶è‡ªèº«çš„å‰ç¼€ï¼Œå› ä¸ºr å¯èƒ½æ˜¯ç©ºStringã€‚ï¼‰ b. å¦‚æœ pxæ˜¯pyçš„å‰ç¼€ï¼Œåˆ™è¿”å›trueã€‚ c. ä»¤ kä¸ºæœ€å°çš„éè´Ÿæ•´æ•°ï¼Œä»¥ä½¿pxå†…çš„ä½ç½®kå¤„çš„å­—ç¬¦ä¸åŒäºpyå†…çš„ä½ç½®kå¤„çš„å­—ç¬¦ã€‚ï¼ˆå¿…é¡»æœ‰ä¸€ä¸ªkï¼Œå› ä¸ºStringéƒ½ä¸æ˜¯å¦ä¸€ä¸ªçš„å‰ç¼€ã€‚ï¼‰ d. è®¾mä¸ºæ•´æ•°ï¼Œè¡¨ç¤ºå­—ç¬¦åœ¨pxå†…ä½ç½®kå¤„çš„ä»£ç å•ä½å€¼ã€‚ e. è®¾nä¸ºæ•´æ•°ï¼Œè¡¨ç¤ºå­—ç¬¦åœ¨pyä¸­ä½ç½®kå¤„çš„ä»£ç å•ä½å€¼ã€‚ f. å¦‚æœ m &lt; nï¼Œåˆ™è¿”å›trueã€‚å¦åˆ™ï¼Œè¿”å› falseã€‚æŒ‰ä¸Šè¿°è§„èŒƒï¼Œå¯¹ä¸‹åˆ—å‡ ä¸ªä¾‹å­è¿›è¡Œè®²è§£ï¼š 12[] &lt; []; //false// ä»¥æˆ‘ç†è§£ä¸ºé¦–å…ˆLeftFirstå‘ç°å·¦è¾¹ä¸ºfalseï¼Œè€Œåé¢ å€’å‘ç°å·¦è¾¹ä¾æ—§ä¸ºfalseï¼Œåˆ™ç›¸å½“äºfasle&lt;fasle æœ€åç»“æœä¸ºfasle 12[] &lt; &#123;&#125;; //ture// ç›¸å½“äº''å’Œ'[object Object]'è¿›è¡Œæ¯”è¾ƒï¼Œåˆ™æ˜æ˜¾ç©ºå­—ç¬¦ä¸²å° å‚è€ƒï¼šå†´ç¾½ï¼šJavaScript æ·±å…¥ä¹‹å¤´ç–¼çš„ç±»å‹è½¬æ¢(ä¸Š)å†´ç¾½ï¼šJavaScript æ·±å…¥ä¹‹å¤´ç–¼çš„ç±»å‹è½¬æ¢(ä¸‹)","categories":[{"name":"JSåŸºç¡€","slug":"JSåŸºç¡€","permalink":"https://tomatoesman.github.io/categories/JS%E5%9F%BA%E7%A1%80/"}],"tags":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://tomatoesman.github.io/tags/%E5%89%8D%E7%AB%AF/"},{"name":"javascript","slug":"javascript","permalink":"https://tomatoesman.github.io/tags/javascript/"}]},{"title":"jsåŸºç¡€ç±»å‹å’Œå¼•ç”¨ç±»å‹","slug":"jsåŸºç¡€ç±»å‹å’Œå¼•ç”¨ç±»å‹","date":"2020-04-08T14:14:00.000Z","updated":"2020-06-25T11:52:41.341Z","comments":true,"path":"2020/04/08/jsåŸºç¡€ç±»å‹å’Œå¼•ç”¨ç±»å‹/","link":"","permalink":"https://tomatoesman.github.io/2020/04/08/js%E5%9F%BA%E7%A1%80%E7%B1%BB%E5%9E%8B%E5%92%8C%E5%BC%95%E7%94%A8%E7%B1%BB%E5%9E%8B/","excerpt":"å¼€å§‹ç¬¬ä¸€ç¯‡ï¼Œé‚£æˆ‘ä»¬ä» js æœ€åŸºç¡€çš„è®²èµ·ï¼ŒåŸºç¡€ç±»å‹å’Œå¼•ç”¨ç±»å‹","text":"å¼€å§‹ç¬¬ä¸€ç¯‡ï¼Œé‚£æˆ‘ä»¬ä» js æœ€åŸºç¡€çš„è®²èµ·ï¼ŒåŸºç¡€ç±»å‹å’Œå¼•ç”¨ç±»å‹ 1ã€ä»€ä¹ˆæ˜¯åŸºç¡€ç±»å‹ï¼ˆå€¼ç±»å‹ã€åŸå§‹ç±»å‹ï¼‰ä¿å­˜åœ¨æ ˆä¸­çš„ç±»å‹å°±æ˜¯åŸºç¡€ç±»å‹ï¼ŒåŸå› æ˜¯åŸºç¡€ç±»å‹å­˜å‚¨çš„ç©ºé—´å¾ˆå°ï¼Œå­˜æ”¾åœ¨æ ˆä¸­æ–¹ä¾¿æŸ¥æ‰¾ï¼Œä¸”ä¸æ˜“äºæ”¹å˜ js ä¸­çš„åŸºç¡€ç±»å‹ï¼ˆå€¼ç±»å‹ã€åŸå§‹ç±»å‹ï¼‰æœ‰å“ªäº›12Undefinedã€Nullã€Booleanã€Numberã€Stringã€Symbolï¼ˆES6ä¸­æ–°åŠ ç±»å‹ï¼‰// undefinedå’Œnullæ˜¯æ‰€æœ‰ç±»å‹çš„å­ç±»å‹ 2ã€ä»€ä¹ˆæ˜¯å¼•ç”¨ç±»å‹æŒ‡æœ‰å¤šä¸ªå€¼æ„æˆçš„å¯¹è±¡ï¼Œå¼•ç”¨æ•°æ®ç±»å‹æ˜¯å­˜å‚¨åœ¨å †ä¸­ï¼Œä¹Ÿå°±æ˜¯è¯´å­˜å‚¨çš„å˜é‡å¤„çš„å€¼æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘å­˜å‚¨å¯¹è±¡çš„å†…å­˜åœ°å€ã€‚å­˜åœ¨å †ä¸­çš„åŸå› æ˜¯ï¼šå¼•ç”¨å€¼çš„å¤§å°ä¼šæ”¹å˜ï¼Œæ‰€ä»¥ä¸èƒ½æ”¾åœ¨æ ˆä¸­ï¼Œå¦åˆ™ä¼šé™ä½å˜é‡æŸ¥è¯¢çš„é€Ÿåº¦ js ä¸­çš„å¼•ç”¨ç±»å‹æœ‰å“ªäº›1Object; 3ã€å¦‚ä½•åˆ¤æ–­ç±»å‹3.1 typeofå…·ä½“ä½¿ç”¨ï¼š 12345678910111213console.log(typeof a); //'undefined'console.log(typeof true); //'boolean'console.log(typeof \"123\"); //'string'console.log(typeof 123); //'number'console.log(typeof NaN); //'number'console.log(typeof null); //'object'let obj = new String();console.log(typeof obj); //'object'let fn = function () &#123;&#125;;console.log(typeof fn); //'function'console.log(typeof class c &#123;&#125;); //'function'let sym = Symbol();console.log(typeof sym); //'symbol' å®ç°åŸç†å¦‚ä¸‹ï¼š 1ä¸åŒçš„å¯¹è±¡åœ¨åº•å±‚éƒ½è¡¨ç¤ºä¸ºäºŒè¿›åˆ¶ï¼Œ åœ¨ JavaScript ä¸­äºŒè¿›åˆ¶å‰ä¸‰ä½éƒ½ä¸º 0 çš„è¯ä¼šè¢«åˆ¤æ–­ä¸º object ç±»å‹ï¼Œ null çš„äºŒè¿›åˆ¶è¡¨ç¤ºæ˜¯å…¨ 0ï¼Œ è‡ªç„¶å‰ä¸‰ä½ä¹Ÿæ˜¯ 0ï¼Œ æ‰€ä»¥æ‰§è¡Œ typeof æ—¶ä¼šè¿”å›â€œobjectâ€ã€‚ æ‰€ä»¥ typeof null çš„è¿”å›å€¼æ˜¯ objectï¼Œè¿™æ˜¯ä¸ªâ€œå†å²é—ç•™é—®é¢˜â€ã€‚å› ä¸º typeof åˆ¤æ–­å¼•ç”¨ç±»å‹æ—¶ä¸å¤ªå‡†ç¡®ï¼Œæ‰€ä»¥æˆ‘ä»¬é€‰ç”¨å…¶ä»–æ–¹æ³•ã€‚ 3.2 instanceofé€šå¸¸æ¥è¯´ï¼Œinstanceof æ˜¯åˆ¤æ–­ä¸€ä¸ªå®ä¾‹æ˜¯å¦å±äºæŸç§ç±»å‹å…·ä½“ä½¿ç”¨ï¼š 123456console.log(1 instanceof Number); //falseconsole.log(\"1\" instanceof String); //falseconsole.log(true instanceof Boolean); //falseconsole.log(function Foo() &#123;&#125; instanceof Function); //trueconsole.log(&#123;&#125; instanceof Object); //trueconsole.log([] instanceof Array); //true ä»ä»¥ä¸Šç»“æœå¯ä»¥çœ‹å‡ºï¼Œinstanceof å¯¹å¼•ç”¨ç±»å‹æ¥è¯´åˆ¤æ–­çš„éå¸¸å‡†ç¡®ï¼Œä½†æ˜¯å¯¹äºåŸºç¡€ç±»å‹å´ä¸èƒ½ç²¾å‡†çš„åˆ¤æ–­ã€‚åŸå› æ˜¯ instanceof è¿ç®—ç¬¦ç”¨æ¥æµ‹è¯•ä¸€ä¸ªå¯¹è±¡åœ¨å…¶åŸå‹é“¾ä¸­æ˜¯å¦å­˜åœ¨ä¸€ä¸ªæ„é€ å‡½æ•°çš„ prototype å±æ€§ã€‚å…¶æ„æ€å°±æ˜¯åˆ¤æ–­å¯¹è±¡æ˜¯å¦æ˜¯æŸä¸€æ•°æ®ç±»å‹çš„å®ä¾‹ï¼Œ1ã€â€˜1â€™ã€true å¹¶ä¸æ˜¯å®ä¾‹ï¼Œæ‰€ä»¥ä¸º falseã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š 123console.log(new Number(1) instanceof Number); //trueconsole.log(new String(\"1\") instanceof String); //trueconsole.log(new Boolean(true) instanceof Boolean); //true ä½†æ˜¯å¯¹ undefined å’Œ nullï¼Œå´æ¯”è¾ƒç‰¹æ®Š 12console.log(new null() instanceof Null); //Uncaught TypeError: null is not a constructorconsole.log(new undefined() instanceof Undefined); //Uncaught TypeError: undefined is not a constructor åŸå› æ˜¯å› ä¸º undefined å’Œ null å¹¶ä¸æ˜¯æ„é€ å‡½æ•° 3.3 constructorå…·ä½“ä½¿ç”¨ï¼š 123456console.log((1).constructor === Number); //trueconsole.log(\"1\".constructor === String); //trueconsole.log(true.constructor === Boolean); //trueconsole.log([].constructor === Array); //trueconsole.log(&#123;&#125;.constructor === Object); //trueconsole.log(function Foo() &#123;&#125;.constructor === Function); //true çœ‹ç€è²Œä¼¼å¾ˆå‡†ç¡®çš„æ ·å­ï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰ç¼ºé™·ï¼Œå½“åˆ›å»ºä¸€ä¸ªå¯¹è±¡æ”¹å˜ä»–çš„åŸå‹çš„æ—¶å€™ï¼Œå°±ä¸å†å‡†ç¡®äº†ï¼ 1234function Foo() &#123;&#125;Foo.prototype = new Array();let foo = new Foo();console.log(foo.constructor === Array); //true è¿™æ˜¯å› ä¸º js æ¯ä¸ªå‡½æ•°éƒ½æœ‰ä¸€ä¸ª prototype å±æ€§ï¼ŒæŒ‡å‘åŸå‹å¯¹è±¡ï¼Œå¯¹è±¡.prototype.constructor æŒ‡å‘çš„æ˜¯è¯¥å¯¹è±¡çš„æ„é€ å‡½æ•°ï¼Œå½“æŠŠè¯¥å¯¹è±¡çš„åŸå‹å¯¹è±¡æ›´æ”¹æ—¶ï¼Œè¯¥å‡½æ•°çš„æ„é€ å¯¹è±¡ä¹Ÿä¼šæ›´æ”¹ï¼Œæ‰€ä»¥å°±ä¼šå‡ºç°å¦‚ä¸Šçš„é—®é¢˜ 3.4 Object.prototype.toString.call()å…·ä½“ä½¿ç”¨ï¼š 123456789console.log(Object.prototype.toString.call(1)); //[object Number]console.log(Object.prototype.toString.call(\"1\")); //[object String]console.log(Object.prototype.toString.call(true)); //[object Boolean]console.log(Object.prototype.toString.call([])); //[object Array]console.log(Object.prototype.toString.call(&#123;&#125;)); //[object Object]console.log(Object.prototype.toString.call(function Foo() &#123;&#125;)); //[object Function]console.log(Object.prototype.toString.call(undefined)); //[object Undefined]console.log(Object.prototype.toString.call(null)); //[object Null]console.log(Object.prototype.toString.call(Symbol())); //[object Symbol] è¿™æ˜¯æœ€å‡†ç¡®çš„ç±»å‹åˆ¤å®šçš„æ–¹æ³•ï¼Œå°±ç®—æ”¹å˜åŸå‹ä¹Ÿä¸ä¼šæœ‰é—®é¢˜ã€‚å…·ä½“åˆ†æä¸€ä¸‹è¿™ä¸ªæ–¹æ³•èƒŒåçš„æ•…äº‹ï¼šæ¯ä¸ª Object åŸå‹ä¸Šéƒ½æœ‰ä¸€ä¸ª toString çš„æ–¹æ³•ï¼Œå½“è°ƒç”¨è¿™ä¸ªæ–¹æ³•çš„æ—¶å€™ä¼šæ‰§è¡Œä¸‰ä¸ªæ­¥éª¤ï¼š1ã€è·å–å¯¹è±¡çš„ç±»åï¼ˆå¯¹è±¡ç±»å‹ï¼‰2ã€å°†[objectã€è·å–çš„å¯¹è±¡ç±»å‹]ç»„åˆä¸ºå­—ç¬¦ä¸²3ã€è¿”å›å­—ç¬¦ä¸² ä¸ºä»€ä¹ˆè¦ç”¨ call æ–¹æ³•ï¼Ÿå› ä¸º Arrayã€String ç­‰ç±»å‹éƒ½å¯¹å…¶ç»§æ‰¿ä¸‹æ¥åŸå‹ä¸Šçš„ toSring æ–¹æ³•è¿›è¡Œäº†é‡å†™ï¼Œæ— æ³•è¿”å›æˆ‘ä»¬æƒ³è¦çš„ç»“æœï¼Œæ‰€ä»¥æˆ‘ä»¬é€šè¿‡ call æ–¹æ³•ï¼Œå°† Object.prototype.toString ä¸Šçš„ Object çš„æŒ‡å‘æ”¹å˜ï¼Œæ‰èƒ½å¯¹ç±»å‹è¿›è¡Œç²¾å‡†çš„åˆ¤æ–­ã€‚ Object.toString å’Œ Object.prototype.toString çš„åŒºåˆ«ï¼ŸObject.toString æ˜¯ Object æ„é€ å™¨çš„æ–¹æ³•ï¼Œè¿”å›çš„æ˜¯å‡½æ•° 1Object.toString(&#123;&#125;); //\"function Object() &#123; [native code] &#125;\" Object.prototype.toString æ˜¯ Object åŸå‹ä¸Šçš„æ–¹æ³•ï¼Œè¿”å›çš„æ˜¯ç±»å‹å­—ç¬¦ä¸²ï¼Œæ‰æ˜¯æˆ‘ä»¬æƒ³è¦çš„ç»“æœ 1Object.prototype.toString(&#123;&#125;); //\"[object Object]\"","categories":[{"name":"JSåŸºç¡€","slug":"JSåŸºç¡€","permalink":"https://tomatoesman.github.io/categories/JS%E5%9F%BA%E7%A1%80/"}],"tags":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://tomatoesman.github.io/tags/%E5%89%8D%E7%AB%AF/"},{"name":"javascript","slug":"javascript","permalink":"https://tomatoesman.github.io/tags/javascript/"}]}],"categories":[{"name":"ES6","slug":"ES6","permalink":"https://tomatoesman.github.io/categories/ES6/"},{"name":"JSåŸºç¡€","slug":"JSåŸºç¡€","permalink":"https://tomatoesman.github.io/categories/JS%E5%9F%BA%E7%A1%80/"}],"tags":[{"name":"ES6","slug":"ES6","permalink":"https://tomatoesman.github.io/tags/ES6/"},{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://tomatoesman.github.io/tags/%E5%89%8D%E7%AB%AF/"},{"name":"javascript","slug":"javascript","permalink":"https://tomatoesman.github.io/tags/javascript/"}]}